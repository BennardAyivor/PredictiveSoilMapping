<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>3 Soil observations and variables | Predictive Soil Mapping with R</title>
  <meta name="description" content="Predictive Soil Mapping aims to produce the most accurate, most objective, and most usable maps of soil variables by using state-of-the-art Statistical and Machine Learning methods. This books explains how to implement common soil mapping procedures within the R programming language.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="3 Soil observations and variables | Predictive Soil Mapping with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://soilmapper.org" />
  <meta property="og:image" content="http://soilmapper.orgfigures/f0_web.png" />
  <meta property="og:description" content="Predictive Soil Mapping aims to produce the most accurate, most objective, and most usable maps of soil variables by using state-of-the-art Statistical and Machine Learning methods. This books explains how to implement common soil mapping procedures within the R programming language." />
  <meta name="github-repo" content="envirometrix/PredictiveSoilMapping" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Soil observations and variables | Predictive Soil Mapping with R" />
  <meta name="twitter:site" content="@tom_hengl" />
  <meta name="twitter:description" content="Predictive Soil Mapping aims to produce the most accurate, most objective, and most usable maps of soil variables by using state-of-the-art Statistical and Machine Learning methods. This books explains how to implement common soil mapping procedures within the R programming language." />
  <meta name="twitter:image" content="http://soilmapper.orgfigures/f0_web.png" />

<meta name="author" content="Tomislav Hengl and Robert A. MacMillan">


<meta name="date" content="2018-12-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="software.html">
<link rel="next" href="soil-covs-chapter.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-120633517-1', 'auto');
  ga('send', 'pageview');

</script>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Predictive Soil Mapping with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Predictive Soil Mapping for advanced R users</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#editors"><i class="fa fa-check"></i>Editors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#connected-publications"><i class="fa fa-check"></i>Connected publications</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#contributions"><i class="fa fa-check"></i>Contributions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Soil resource inventories and soil maps</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#introduction-1"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#soils-and-soil-inventories"><i class="fa fa-check"></i><b>1.2</b> Soils and soil inventories</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#soil-a-definition"><i class="fa fa-check"></i><b>1.2.1</b> Soil: a definition</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#soil-variables"><i class="fa fa-check"></i><b>1.2.2</b> Soil variables</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#primary-and-secondary-soil-variables"><i class="fa fa-check"></i><b>1.2.3</b> Primary and secondary soil variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#soil-mapping"><i class="fa fa-check"></i><b>1.3</b> Soil mapping</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#what-are-soil-resource-inventories"><i class="fa fa-check"></i><b>1.3.1</b> What are soil resource inventories?</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#soil-mapping-approaches-and-concepts"><i class="fa fa-check"></i><b>1.3.2</b> Soil mapping approaches and concepts</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#soil-mapping-theory"><i class="fa fa-check"></i><b>1.3.3</b> Theoretical basis of soil mapping: in context of the universal model of spatial variation</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#conventional-mapping"><i class="fa fa-check"></i><b>1.3.4</b> Traditional (conventional) soil mapping</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#variants-of-soil-maps"><i class="fa fa-check"></i><b>1.3.5</b> Variants of soil maps</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#pedometric-mapping"><i class="fa fa-check"></i><b>1.3.6</b> Predictive and automated soil mapping</a></li>
<li class="chapter" data-level="1.3.7" data-path="introduction.html"><a href="introduction.html#comparison-conventional-pm"><i class="fa fa-check"></i><b>1.3.7</b> Comparison of conventional and pedometric or predictive soil mapping</a></li>
<li class="chapter" data-level="1.3.8" data-path="introduction.html"><a href="introduction.html#top-down"><i class="fa fa-check"></i><b>1.3.8</b> Top-down versus bottom-up approaches: subdivision versus agglomeration</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#sources-of-soil-data-for-soil-mapping"><i class="fa fa-check"></i><b>1.4</b> Sources of soil data for soil mapping</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#soil-data-sources-targeted-by-psm"><i class="fa fa-check"></i><b>1.4.1</b> Soil data sources targeted by PSM</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#field-observations"><i class="fa fa-check"></i><b>1.4.2</b> Field observations of soil properties</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#legacy-soil-profile-data"><i class="fa fa-check"></i><b>1.4.3</b> Legacy soil profile data</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction.html"><a href="introduction.html#soil-covariates"><i class="fa fa-check"></i><b>1.4.4</b> Soil covariates</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction.html"><a href="introduction.html#soil-delineations"><i class="fa fa-check"></i><b>1.4.5</b> Soil delineations</a></li>
<li class="chapter" data-level="1.4.6" data-path="introduction.html"><a href="introduction.html#advantages-and-disadvantages-of-using-soil-delineations"><i class="fa fa-check"></i><b>1.4.6</b> Advantages and disadvantages of using soil delineations</a></li>
<li class="chapter" data-level="1.4.7" data-path="introduction.html"><a href="introduction.html#accuracy-of-conventional-soil-polygon-maps"><i class="fa fa-check"></i><b>1.4.7</b> Accuracy of conventional soil polygon maps</a></li>
<li class="chapter" data-level="1.4.8" data-path="introduction.html"><a href="introduction.html#tacit-knowledge"><i class="fa fa-check"></i><b>1.4.8</b> Legacy soil expertise (tacit knowledge)</a></li>
<li class="chapter" data-level="1.4.9" data-path="introduction.html"><a href="introduction.html#pseudo-observations"><i class="fa fa-check"></i><b>1.4.9</b> Pseudo-observations</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#soil-databases"><i class="fa fa-check"></i><b>1.5</b> Soil databases and soil information systems</a><ul>
<li class="chapter" data-level="1.5.1" data-path="introduction.html"><a href="introduction.html#soil-databases-1"><i class="fa fa-check"></i><b>1.5.1</b> Soil databases</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction.html"><a href="introduction.html#a-soil-information-system"><i class="fa fa-check"></i><b>1.5.2</b> A Soil Information System</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction.html"><a href="introduction.html#soil-information-users"><i class="fa fa-check"></i><b>1.5.3</b> Soil information users</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction.html"><a href="introduction.html#usability-of-soil-geographical-database"><i class="fa fa-check"></i><b>1.5.4</b> Usability of soil geographical database</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#uncertainty-soil-variables"><i class="fa fa-check"></i><b>1.6</b> Uncertainty of soil variables</a><ul>
<li class="chapter" data-level="1.6.1" data-path="introduction.html"><a href="introduction.html#basic-concepts"><i class="fa fa-check"></i><b>1.6.1</b> Basic concepts</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction.html"><a href="introduction.html#sources-uncertainty"><i class="fa fa-check"></i><b>1.6.2</b> Sources of uncertainty</a></li>
<li class="chapter" data-level="1.6.3" data-path="introduction.html"><a href="introduction.html#quantifying-the-uncertainty-in-soil-data-products"><i class="fa fa-check"></i><b>1.6.3</b> Quantifying the uncertainty in soil data products</a></li>
<li class="chapter" data-level="1.6.4" data-path="introduction.html"><a href="introduction.html#common-uncertainty-levels-in-soil-maps"><i class="fa fa-check"></i><b>1.6.4</b> Common uncertainty levels in soil maps</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#summary-and-conclusions"><i class="fa fa-check"></i><b>1.7</b> Summary and conclusions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>2</b> Software installation and first steps</a><ul>
<li class="chapter" data-level="2.1" data-path="software.html"><a href="software.html#list-of-software-in-use"><i class="fa fa-check"></i><b>2.1</b> List of software in use</a></li>
<li class="chapter" data-level="2.2" data-path="software.html"><a href="software.html#installing-software-on-ubuntu-os"><i class="fa fa-check"></i><b>2.2</b> Installing software on Ubuntu OS</a></li>
<li class="chapter" data-level="2.3" data-path="software.html"><a href="software.html#installing-gis-software"><i class="fa fa-check"></i><b>2.3</b> Installing GIS software</a></li>
<li class="chapter" data-level="2.4" data-path="software.html"><a href="software.html#Whitebox"><i class="fa fa-check"></i><b>2.4</b> WhiteboxTools</a></li>
<li class="chapter" data-level="2.5" data-path="software.html"><a href="software.html#Rstudio"><i class="fa fa-check"></i><b>2.5</b> RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="software.html"><a href="software.html#plotkml-and-gsif-packages"><i class="fa fa-check"></i><b>2.6</b> plotKML and GSIF packages</a></li>
<li class="chapter" data-level="2.7" data-path="software.html"><a href="software.html#connecting-r-and-saga-gis"><i class="fa fa-check"></i><b>2.7</b> Connecting R and SAGA GIS</a></li>
<li class="chapter" data-level="2.8" data-path="software.html"><a href="software.html#connecting-r-and-gdal"><i class="fa fa-check"></i><b>2.8</b> Connecting R and GDAL</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html"><i class="fa fa-check"></i><b>3</b> Soil observations and variables</a><ul>
<li class="chapter" data-level="3.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#basic-concepts-1"><i class="fa fa-check"></i><b>3.1</b> Basic concepts</a><ul>
<li class="chapter" data-level="3.1.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#types-of-soil-observations"><i class="fa fa-check"></i><b>3.1.1</b> Types of soil observations</a></li>
<li class="chapter" data-level="3.1.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-properties-of-interest-for-global-soil-mapping"><i class="fa fa-check"></i><b>3.1.2</b> Soil properties of interest for global soil mapping</a></li>
<li class="chapter" data-level="3.1.3" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#reference-methods"><i class="fa fa-check"></i><b>3.1.3</b> Reference methods</a></li>
<li class="chapter" data-level="3.1.4" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#standard-soil-variables-of-interest-for-soil-mapping"><i class="fa fa-check"></i><b>3.1.4</b> Standard soil variables of interest for soil mapping</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#descriptive-soil-profile-observations"><i class="fa fa-check"></i><b>3.2</b> Descriptive soil profile observations</a><ul>
<li class="chapter" data-level="3.2.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#depth-to-bedrock"><i class="fa fa-check"></i><b>3.2.1</b> Depth to bedrock</a></li>
<li class="chapter" data-level="3.2.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#effective-soil-depth-and-rooting-depth"><i class="fa fa-check"></i><b>3.2.2</b> Effective soil depth and rooting depth</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#chemical-soil-properties"><i class="fa fa-check"></i><b>3.3</b> Chemical soil properties</a><ul>
<li class="chapter" data-level="3.3.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-organic-carbon"><i class="fa fa-check"></i><b>3.3.1</b> Soil organic carbon</a></li>
<li class="chapter" data-level="3.3.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-ph"><i class="fa fa-check"></i><b>3.3.2</b> Soil pH</a></li>
<li class="chapter" data-level="3.3.3" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-nutrients"><i class="fa fa-check"></i><b>3.3.3</b> Soil nutrients</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#physical-and-hydrological-soil-properties"><i class="fa fa-check"></i><b>3.4</b> Physical and hydrological soil properties</a><ul>
<li class="chapter" data-level="3.4.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#coarse-fragments"><i class="fa fa-check"></i><b>3.4.1</b> Coarse fragments</a></li>
<li class="chapter" data-level="3.4.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#particle-size-class-distribution-sand-silt-and-clay"><i class="fa fa-check"></i><b>3.4.2</b> Particle size class distribution: sand, silt and clay</a></li>
<li class="chapter" data-level="3.4.3" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#bulk-density"><i class="fa fa-check"></i><b>3.4.3</b> Bulk density</a></li>
<li class="chapter" data-level="3.4.4" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-organic-carbon-stock"><i class="fa fa-check"></i><b>3.4.4</b> Soil organic carbon stock</a></li>
<li class="chapter" data-level="3.4.5" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#available-water-capacity"><i class="fa fa-check"></i><b>3.4.5</b> Available Water Capacity</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#harmonisation-of-soil-data-and-pedo-transfer-functions"><i class="fa fa-check"></i><b>3.5</b> Harmonisation of soil data and pedo-transfer functions</a><ul>
<li class="chapter" data-level="3.5.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#basic-concepts-of-harmonisation-of-soil-property-values"><i class="fa fa-check"></i><b>3.5.1</b> Basic concepts of harmonisation of soil property values</a></li>
<li class="chapter" data-level="3.5.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#example-of-harmonization-using-texture-by-hand-classes"><i class="fa fa-check"></i><b>3.5.2</b> Example of harmonization using texture-by-hand classes</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-class-data"><i class="fa fa-check"></i><b>3.6</b> Soil class data</a><ul>
<li class="chapter" data-level="3.6.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#soil-types"><i class="fa fa-check"></i><b>3.6.1</b> Soil types</a></li>
<li class="chapter" data-level="3.6.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#other-factor-type-variables"><i class="fa fa-check"></i><b>3.6.2</b> Other factor-type variables</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#importing-and-formatting-soil-data-in-r"><i class="fa fa-check"></i><b>3.7</b> Importing and formatting soil data in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#converting-texture-by-hand-classes-to-fractions"><i class="fa fa-check"></i><b>3.7.1</b> Converting texture-by-hand classes to fractions</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#converting-munsell-color-codes-to-other-color-systems"><i class="fa fa-check"></i><b>3.8</b> Converting Munsell color codes to other color systems</a></li>
<li class="chapter" data-level="3.9" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#mla-ptfs"><i class="fa fa-check"></i><b>3.9</b> Using Machine Learning to build Pedo-Transfer-Functions</a><ul>
<li class="chapter" data-level="3.9.1" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#ptf-for-bulk-density"><i class="fa fa-check"></i><b>3.9.1</b> PTF for Bulk Density</a></li>
<li class="chapter" data-level="3.9.2" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#ptf-for-correlating-classification-systems"><i class="fa fa-check"></i><b>3.9.2</b> PTF for correlating classification systems</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="soil-variables-chapter.html"><a href="soil-variables-chapter.html#summary-points"><i class="fa fa-check"></i><b>3.10</b> Summary points</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html"><i class="fa fa-check"></i><b>4</b> Preparation of soil covariates for soil mapping</a><ul>
<li class="chapter" data-level="4.1" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#soil-covariate-data-sources"><i class="fa fa-check"></i><b>4.1</b> Soil covariate data sources</a><ul>
<li class="chapter" data-level="4.1.1" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#types-of-soil-covariates"><i class="fa fa-check"></i><b>4.1.1</b> Types of soil covariates</a></li>
<li class="chapter" data-level="4.1.2" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#soil-covs-30m"><i class="fa fa-check"></i><b>4.1.2</b> Soil covariate data sources (30–100 m resolution)</a></li>
<li class="chapter" data-level="4.1.3" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#soil-covs-250m"><i class="fa fa-check"></i><b>4.1.3</b> Soil covariate data sources (250 m resolution or coarser)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#preparing-soil-covariate-layers"><i class="fa fa-check"></i><b>4.2</b> Preparing soil covariate layers</a><ul>
<li class="chapter" data-level="4.2.1" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#converting-polygon-maps-to-rasters"><i class="fa fa-check"></i><b>4.2.1</b> Converting polygon maps to rasters</a></li>
<li class="chapter" data-level="4.2.2" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#downscaling-upscaling"><i class="fa fa-check"></i><b>4.2.2</b> Downscaling or upscaling (aggregating) rasters</a></li>
<li class="chapter" data-level="4.2.3" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#deriving-dem-parameters-using-saga-gis"><i class="fa fa-check"></i><b>4.2.3</b> Deriving DEM parameters using SAGA GIS</a></li>
<li class="chapter" data-level="4.2.4" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#filtering-out-missing-pixels-and-artifacts"><i class="fa fa-check"></i><b>4.2.4</b> Filtering out missing pixels and artifacts</a></li>
<li class="chapter" data-level="4.2.5" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#overlaying-and-subsetting-raster-stacks-and-points"><i class="fa fa-check"></i><b>4.2.5</b> Overlaying and subsetting raster stacks and points</a></li>
<li class="chapter" data-level="4.2.6" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#working-with-larger-rasters"><i class="fa fa-check"></i><b>4.2.6</b> Working with large(r) rasters</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="soil-covs-chapter.html"><a href="soil-covs-chapter.html#summary-points-1"><i class="fa fa-check"></i><b>4.3</b> Summary points</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-theory.html"><a href="statistical-theory.html"><i class="fa fa-check"></i><b>5</b> Statistical theory for predictive soil mapping</a><ul>
<li class="chapter" data-level="5.1" data-path="statistical-theory.html"><a href="statistical-theory.html#aspects-variability"><i class="fa fa-check"></i><b>5.1</b> Aspects of spatial variability of soil variables</a><ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-theory.html"><a href="statistical-theory.html#modelling-soil-variability"><i class="fa fa-check"></i><b>5.1.1</b> Modelling soil variability</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-theory.html"><a href="statistical-theory.html#umsv"><i class="fa fa-check"></i><b>5.1.2</b> Universal model of soil variation</a></li>
<li class="chapter" data-level="5.1.3" data-path="statistical-theory.html"><a href="statistical-theory.html#soil-depth-models"><i class="fa fa-check"></i><b>5.1.3</b> Modelling the variation of soil with depth</a></li>
<li class="chapter" data-level="5.1.4" data-path="statistical-theory.html"><a href="statistical-theory.html#vertical-aggregation"><i class="fa fa-check"></i><b>5.1.4</b> Vertical aggregation of soil properties</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-theory.html"><a href="statistical-theory.html#spatial-prediction-of-soil-variables"><i class="fa fa-check"></i><b>5.2</b> Spatial prediction of soil variables</a><ul>
<li class="chapter" data-level="5.2.1" data-path="statistical-theory.html"><a href="statistical-theory.html#main-principles"><i class="fa fa-check"></i><b>5.2.1</b> Main principles</a></li>
<li class="chapter" data-level="5.2.2" data-path="statistical-theory.html"><a href="statistical-theory.html#soil-sampling"><i class="fa fa-check"></i><b>5.2.2</b> Soil sampling</a></li>
<li class="chapter" data-level="5.2.3" data-path="statistical-theory.html"><a href="statistical-theory.html#sec:expertsystems"><i class="fa fa-check"></i><b>5.2.3</b> Knowledge-driven soil mapping</a></li>
<li class="chapter" data-level="5.2.4" data-path="statistical-theory.html"><a href="statistical-theory.html#regression-kriging"><i class="fa fa-check"></i><b>5.2.4</b> Geostatistics-driven soil mapping (pedometric mapping)</a></li>
<li class="chapter" data-level="5.2.5" data-path="statistical-theory.html"><a href="statistical-theory.html#RK-generic"><i class="fa fa-check"></i><b>5.2.5</b> Regression-kriging (generic model)</a></li>
<li class="chapter" data-level="5.2.6" data-path="statistical-theory.html"><a href="statistical-theory.html#spatial-prediction-using-multiple-linear-regression"><i class="fa fa-check"></i><b>5.2.6</b> Spatial Prediction using multiple linear regression</a></li>
<li class="chapter" data-level="5.2.7" data-path="statistical-theory.html"><a href="statistical-theory.html#universal-kriging-prediction-error"><i class="fa fa-check"></i><b>5.2.7</b> Universal kriging prediction error</a></li>
<li class="chapter" data-level="5.2.8" data-path="statistical-theory.html"><a href="statistical-theory.html#regression-kriging-examples"><i class="fa fa-check"></i><b>5.2.8</b> Regression-kriging examples</a></li>
<li class="chapter" data-level="5.2.9" data-path="statistical-theory.html"><a href="statistical-theory.html#regression-kriging-examples-using-the-gsif-package"><i class="fa fa-check"></i><b>5.2.9</b> Regression-kriging examples using the GSIF package</a></li>
<li class="chapter" data-level="5.2.10" data-path="statistical-theory.html"><a href="statistical-theory.html#regression-kriging-and-polygon-averaging"><i class="fa fa-check"></i><b>5.2.10</b> Regression-kriging and polygon averaging</a></li>
<li class="chapter" data-level="5.2.11" data-path="statistical-theory.html"><a href="statistical-theory.html#block-support"><i class="fa fa-check"></i><b>5.2.11</b> Predictions at point vs block support</a></li>
<li class="chapter" data-level="5.2.12" data-path="statistical-theory.html"><a href="statistical-theory.html#gstat-sims"><i class="fa fa-check"></i><b>5.2.12</b> Geostatistical simulations</a></li>
<li class="chapter" data-level="5.2.13" data-path="statistical-theory.html"><a href="statistical-theory.html#automated-mapping"><i class="fa fa-check"></i><b>5.2.13</b> Automated mapping</a></li>
<li class="chapter" data-level="5.2.14" data-path="statistical-theory.html"><a href="statistical-theory.html#selecting-spatial-prediction-models"><i class="fa fa-check"></i><b>5.2.14</b> Selecting spatial prediction models</a></li>
<li class="chapter" data-level="5.2.15" data-path="statistical-theory.html"><a href="statistical-theory.html#regression-kriging-3D"><i class="fa fa-check"></i><b>5.2.15</b> 3D regression-kriging</a></li>
<li class="chapter" data-level="5.2.16" data-path="statistical-theory.html"><a href="statistical-theory.html#multiscale"><i class="fa fa-check"></i><b>5.2.16</b> Predicting with multiscale and multisource data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="statistical-theory.html"><a href="statistical-theory.html#accuracy-assessment"><i class="fa fa-check"></i><b>5.3</b> Accuracy assessment and the mapping efficiency</a><ul>
<li class="chapter" data-level="5.3.1" data-path="statistical-theory.html"><a href="statistical-theory.html#mapping-accuracy"><i class="fa fa-check"></i><b>5.3.1</b> Mapping accuracy and numeric resolution</a></li>
<li class="chapter" data-level="5.3.2" data-path="statistical-theory.html"><a href="statistical-theory.html#accuracy-assessment-methods"><i class="fa fa-check"></i><b>5.3.2</b> Accuracy assessment methods</a></li>
<li class="chapter" data-level="5.3.3" data-path="statistical-theory.html"><a href="statistical-theory.html#cross-validation-and-its-limitations"><i class="fa fa-check"></i><b>5.3.3</b> Cross-validation and its limitations</a></li>
<li class="chapter" data-level="5.3.4" data-path="statistical-theory.html"><a href="statistical-theory.html#accuracy-of-the-predicted-model-uncertainty"><i class="fa fa-check"></i><b>5.3.4</b> Accuracy of the predicted model uncertainty</a></li>
<li class="chapter" data-level="5.3.5" data-path="statistical-theory.html"><a href="statistical-theory.html#derivation-and-interpretation-of-prediction-interval"><i class="fa fa-check"></i><b>5.3.5</b> Derivation and interpretation of prediction interval</a></li>
<li class="chapter" data-level="5.3.6" data-path="statistical-theory.html"><a href="statistical-theory.html#universal-measures-of-mapping-accuracy"><i class="fa fa-check"></i><b>5.3.6</b> Universal measures of mapping accuracy</a></li>
<li class="chapter" data-level="5.3.7" data-path="statistical-theory.html"><a href="statistical-theory.html#mapping-accuracy-and-soil-survey-costs"><i class="fa fa-check"></i><b>5.3.7</b> Mapping accuracy and soil survey costs</a></li>
<li class="chapter" data-level="5.3.8" data-path="statistical-theory.html"><a href="statistical-theory.html#summary-points-2"><i class="fa fa-check"></i><b>5.3.8</b> Summary points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html"><i class="fa fa-check"></i><b>6</b> Machine Learning Algorithms for soil mapping</a><ul>
<li class="chapter" data-level="6.1" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#spatial-prediction-of-soil-properties-and-classes-using-mlas"><i class="fa fa-check"></i><b>6.1</b> Spatial prediction of soil properties and classes using MLA’s</a><ul>
<li class="chapter" data-level="6.1.1" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#loading-the-packages-and-data"><i class="fa fa-check"></i><b>6.1.1</b> Loading the packages and data</a></li>
<li class="chapter" data-level="6.1.2" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#spatial-prediction-of-soil-classes-using-mlas"><i class="fa fa-check"></i><b>6.1.2</b> Spatial prediction of soil classes using MLA’s</a></li>
<li class="chapter" data-level="6.1.3" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#modelling-numeric-soil-properties-using-h2o"><i class="fa fa-check"></i><b>6.1.3</b> Modelling numeric soil properties using h2o</a></li>
<li class="chapter" data-level="6.1.4" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#prediction-3D"><i class="fa fa-check"></i><b>6.1.4</b> Spatial prediction of 3D (numeric) variables</a></li>
<li class="chapter" data-level="6.1.5" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#ensemble-predictions-using-h2oensemble"><i class="fa fa-check"></i><b>6.1.5</b> Ensemble predictions using h2oEnsemble</a></li>
<li class="chapter" data-level="6.1.6" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#ensemble-predictions-using-superlearner-package"><i class="fa fa-check"></i><b>6.1.6</b> Ensemble predictions using SuperLearner package</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#a-generic-framework-for-spatial-prediction-using-random-forest"><i class="fa fa-check"></i><b>6.2</b> A generic framework for spatial prediction using Random Forest</a><ul>
<li class="chapter" data-level="6.2.1" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#general-principle-of-rfsp"><i class="fa fa-check"></i><b>6.2.1</b> General principle of RFsp</a></li>
<li class="chapter" data-level="6.2.2" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#geographical-covariates"><i class="fa fa-check"></i><b>6.2.2</b> Geographical covariates</a></li>
<li class="chapter" data-level="6.2.3" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#spatial-prediction-2d-continuous-variable-using-rfsp"><i class="fa fa-check"></i><b>6.2.3</b> Spatial prediction 2D continuous variable using RFsp</a></li>
<li class="chapter" data-level="6.2.4" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#spatial-prediction-2d-variable-with-covariates-using-rfsp"><i class="fa fa-check"></i><b>6.2.4</b> Spatial prediction 2D variable with covariates using RFsp</a></li>
<li class="chapter" data-level="6.2.5" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#spatial-prediction-of-binomial-variables"><i class="fa fa-check"></i><b>6.2.5</b> Spatial prediction of binomial variables</a></li>
<li class="chapter" data-level="6.2.6" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#spatial-prediction-of-soil-types"><i class="fa fa-check"></i><b>6.2.6</b> Spatial prediction of soil types</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="soilmapping-using-mla.html"><a href="soilmapping-using-mla.html#summary-points-3"><i class="fa fa-check"></i><b>6.3</b> Summary points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="SOC-chapter.html"><a href="SOC-chapter.html"><i class="fa fa-check"></i><b>7</b> Spatial prediction and assessment of Soil Organic Carbon</a><ul>
<li class="chapter" data-level="7.1" data-path="SOC-chapter.html"><a href="SOC-chapter.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="SOC-chapter.html"><a href="SOC-chapter.html#measurement-and-derivation-of-soil-organic-carbon"><i class="fa fa-check"></i><b>7.2</b> Measurement and derivation of soil organic carbon</a></li>
<li class="chapter" data-level="7.3" data-path="SOC-chapter.html"><a href="SOC-chapter.html#derivation-of-ocs-and-ocd-using-soil-profile-data"><i class="fa fa-check"></i><b>7.3</b> Derivation of OCS and OCD using soil profile data</a></li>
<li class="chapter" data-level="7.4" data-path="SOC-chapter.html"><a href="SOC-chapter.html#estimation-of-bulk-density-using-a-globally-calibrated-ptf"><i class="fa fa-check"></i><b>7.4</b> Estimation of Bulk Density using a globally-calibrated PTF</a></li>
<li class="chapter" data-level="7.5" data-path="SOC-chapter.html"><a href="SOC-chapter.html#generating-maps-of-ocs"><i class="fa fa-check"></i><b>7.5</b> Generating maps of OCS</a></li>
<li class="chapter" data-level="7.6" data-path="SOC-chapter.html"><a href="SOC-chapter.html#predicting-ocs-from-point-data-the-2d-approach"><i class="fa fa-check"></i><b>7.6</b> Predicting OCS from point data (the 2D approach)</a></li>
<li class="chapter" data-level="7.7" data-path="SOC-chapter.html"><a href="SOC-chapter.html#ocs-3d-approach"><i class="fa fa-check"></i><b>7.7</b> Deriving OCS from soil profile data (the 3D approach)</a></li>
<li class="chapter" data-level="7.8" data-path="SOC-chapter.html"><a href="SOC-chapter.html#deriving-ocs-using-spatiotemporal-models"><i class="fa fa-check"></i><b>7.8</b> Deriving OCS using spatiotemporal models</a></li>
<li class="chapter" data-level="7.9" data-path="SOC-chapter.html"><a href="SOC-chapter.html#summary-points-4"><i class="fa fa-check"></i><b>7.9</b> Summary points</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="practical-tips.html"><a href="practical-tips.html"><i class="fa fa-check"></i><b>8</b> Practical tips for organizing Predictive Soil Mapping</a><ul>
<li class="chapter" data-level="8.1" data-path="practical-tips.html"><a href="practical-tips.html#critical-aspects-of-predictive-soil-mapping"><i class="fa fa-check"></i><b>8.1</b> Critical aspects of Predictive Soil Mapping</a><ul>
<li class="chapter" data-level="8.1.1" data-path="practical-tips.html"><a href="practical-tips.html#psm-main-steps"><i class="fa fa-check"></i><b>8.1.1</b> PSM main steps</a></li>
<li class="chapter" data-level="8.1.2" data-path="practical-tips.html"><a href="practical-tips.html#psm-input-and-output-spatial-data-layers"><i class="fa fa-check"></i><b>8.1.2</b> PSM input and output spatial data layers</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="practical-tips.html"><a href="practical-tips.html#technical-specifications-affecting-the-majority-of-production-costs"><i class="fa fa-check"></i><b>8.2</b> Technical specifications affecting the majority of production costs</a><ul>
<li class="chapter" data-level="8.2.1" data-path="practical-tips.html"><a href="practical-tips.html#field-observations-and-measurements"><i class="fa fa-check"></i><b>8.2.1</b> Field observations and measurements</a></li>
<li class="chapter" data-level="8.2.2" data-path="practical-tips.html"><a href="practical-tips.html#preparation-of-point-data"><i class="fa fa-check"></i><b>8.2.2</b> Preparation of point data</a></li>
<li class="chapter" data-level="8.2.3" data-path="practical-tips.html"><a href="practical-tips.html#preparation-of-covariates"><i class="fa fa-check"></i><b>8.2.3</b> Preparation of covariates</a></li>
<li class="chapter" data-level="8.2.4" data-path="practical-tips.html"><a href="practical-tips.html#soil-mask-and-the-grid-system"><i class="fa fa-check"></i><b>8.2.4</b> Soil mask and the grid system</a></li>
<li class="chapter" data-level="8.2.5" data-path="practical-tips.html"><a href="practical-tips.html#uncertainty-of-psm-maps"><i class="fa fa-check"></i><b>8.2.5</b> Uncertainty of PSM maps</a></li>
<li class="chapter" data-level="8.2.6" data-path="practical-tips.html"><a href="practical-tips.html#computing-costs"><i class="fa fa-check"></i><b>8.2.6</b> Computing costs</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="practical-tips.html"><a href="practical-tips.html#final-delivery-of-maps"><i class="fa fa-check"></i><b>8.3</b> Final delivery of maps</a><ul>
<li class="chapter" data-level="8.3.1" data-path="practical-tips.html"><a href="practical-tips.html#delivery-data-formats"><i class="fa fa-check"></i><b>8.3.1</b> Delivery data formats</a></li>
<li class="chapter" data-level="8.3.2" data-path="practical-tips.html"><a href="practical-tips.html#general-recommendations"><i class="fa fa-check"></i><b>8.3.2</b> General recommendations</a></li>
<li class="chapter" data-level="8.3.3" data-path="practical-tips.html"><a href="practical-tips.html#technical-specifications-psm-project"><i class="fa fa-check"></i><b>8.3.3</b> Technical specifications PSM project</a></li>
<li class="chapter" data-level="8.3.4" data-path="practical-tips.html"><a href="practical-tips.html#standard-soil-data-production-costs"><i class="fa fa-check"></i><b>8.3.4</b> Standard soil data production costs</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="practical-tips.html"><a href="practical-tips.html#summary-notes"><i class="fa fa-check"></i><b>8.4</b> Summary notes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html"><i class="fa fa-check"></i><b>9</b> The future of predictive soil mapping</a><ul>
<li class="chapter" data-level="9.1" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#introduction-3"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#past-conventional-terrestrial-resource-inventories"><i class="fa fa-check"></i><b>9.2</b> Past conventional terrestrial resource inventories</a><ul>
<li class="chapter" data-level="9.2.1" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#why-have-most-national-resource-inventories-been-discontinued"><i class="fa fa-check"></i><b>9.2.1</b> Why have most national resource inventories been discontinued?</a></li>
<li class="chapter" data-level="9.2.2" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#is-there-a-future-for-conventional-terrestrial-inventory-programs"><i class="fa fa-check"></i><b>9.2.2</b> Is there a future for conventional terrestrial inventory programs ?</a></li>
<li class="chapter" data-level="9.2.3" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#can-terrestrial-inventory-programs-be-renewed-and-revived"><i class="fa fa-check"></i><b>9.2.3</b> Can terrestrial inventory programs be renewed and revived?</a></li>
<li class="chapter" data-level="9.2.4" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#how-can-terrestrial-inventory-programs-be-renewed-and-revived-and-by-whom"><i class="fa fa-check"></i><b>9.2.4</b> How can terrestrial inventory programs be renewed and revived and by whom?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#the-future-of-psm-embracing-scientific-and-technical-advances"><i class="fa fa-check"></i><b>9.3</b> The future of PSM: Embracing scientific and technical advances</a><ul>
<li class="chapter" data-level="9.3.1" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#overview"><i class="fa fa-check"></i><b>9.3.1</b> Overview</a></li>
<li class="chapter" data-level="9.3.2" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#collection-of-field-observations-and-samples"><i class="fa fa-check"></i><b>9.3.2</b> Collection of field observations and samples</a></li>
<li class="chapter" data-level="9.3.3" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#collecting-new-field-om-data"><i class="fa fa-check"></i><b>9.3.3</b> Collecting New Field O&amp;M Data</a></li>
<li class="chapter" data-level="9.3.4" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#characterization-of-soils-in-the-field-and-the-laboratory"><i class="fa fa-check"></i><b>9.3.4</b> Characterization of soils in the field and the laboratory</a></li>
<li class="chapter" data-level="9.3.5" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#creation-collation-and-distribution-of-effective-environmental-covariates"><i class="fa fa-check"></i><b>9.3.5</b> Creation, collation and distribution of effective environmental covariates,</a></li>
<li class="chapter" data-level="9.3.6" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#automated-spatial-prediction-models-psm"><i class="fa fa-check"></i><b>9.3.6</b> Automated spatial prediction models (PSM)</a></li>
<li class="chapter" data-level="9.3.7" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#hosting-publishing-sharing-and-using-spatial-data"><i class="fa fa-check"></i><b>9.3.7</b> Hosting, publishing, sharing and using spatial data</a></li>
<li class="chapter" data-level="9.3.8" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#new-visualization-and-data-analysis-tools"><i class="fa fa-check"></i><b>9.3.8</b> New visualization and data analysis tools</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#the-future-of-psm-embracing-new-organizational-and-governance-models"><i class="fa fa-check"></i><b>9.4</b> The future of PSM: Embracing new organizational and governance models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#overview-1"><i class="fa fa-check"></i><b>9.4.1</b> Overview</a></li>
<li class="chapter" data-level="9.4.2" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#open-data-and-platforms-and-procedures-for-acquiring-and-sharing-it"><i class="fa fa-check"></i><b>9.4.2</b> Open data and platforms and procedures for acquiring and sharing it</a></li>
<li class="chapter" data-level="9.4.3" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#open-cloud-based-processing-capabilities"><i class="fa fa-check"></i><b>9.4.3</b> Open cloud-based processing capabilities</a></li>
<li class="chapter" data-level="9.4.4" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#collaborative-production-of-inputs-and-new-outputs"><i class="fa fa-check"></i><b>9.4.4</b> Collaborative production of inputs and new outputs</a></li>
<li class="chapter" data-level="9.4.5" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#crowdsourcing-and-voluntary-collaboration"><i class="fa fa-check"></i><b>9.4.5</b> Crowdsourcing and voluntary collaboration,</a></li>
<li class="chapter" data-level="9.4.6" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#sponsorship-subscription-crowdfunding-and-blockchain-funding-systems"><i class="fa fa-check"></i><b>9.4.6</b> Sponsorship, subscription, crowdfunding and blockchain funding systems,</a></li>
<li class="chapter" data-level="9.4.7" data-path="the-future-of-predictive-soil-mapping.html"><a href="the-future-of-predictive-soil-mapping.html#a-proposal-for-organizing-and-managing-a-new-open-collective"><i class="fa fa-check"></i><b>9.4.7</b> A proposal for organizing and managing a new open collective</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://opengeohub.org/about">T. (Tom) Hengl and R.A. (Bob) MacMillan</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Predictive Soil Mapping with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="soil-variables-chapter" class="section level1">
<h1><span class="header-section-number">3</span> Soil observations and variables</h1>
<p><em>Edited by: Hengl T., MacMillan R.A. and Leenaars J.G.B.</em></p>
<p>This chapter identifies, and provides comprehensive definitions and
descriptions for, a standardized set of soil properties (and classes) that are
commonly predicted using PSM. We first discuss the complexity of measuring and standardizing (or harmonizing) soil attributes, then focus on the key soil properties and classes of interest for global soil
mapping. The purpose of this chapter is to serve as a reference, and background, for other
chapters where the focus is on generating soil maps, interpreting
accuracy results and similar.</p>
<p>The R tutorial at the end of the chaper reviews soil data classes and
functions for R. It illustrates how to organize and reformat soil data in R for spatial analysis,
how to import soil data to R and how to export data and plot it in Google Earth.
To learn more about the Global Soil Information Facilities (GSIF) package,
visit the main <a href="http://gsif.r-forge.r-project.org/00Index.html">documentation page</a>.</p>
<div id="basic-concepts-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Basic concepts</h2>
<div id="types-of-soil-observations" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Types of soil observations</h3>
<p>As mentioned in the previous chapter, values for soil properties or
attributes are obtained through observation and/or measurement of a soil
feature, using a specified method. We refer to observations and
measurements of the characteristics of soil properties and/or feature
attributes as <em>soil observations</em> (see also the <a href="http://www.opengeospatial.org/standards/om">Observation and Measurements
OGC standard</a>; ISO/DIS 19156). From the perspective of the technology
used, soil observations can be grouped as follows (see also
Fig. <a href="soil-variables-chapter.html#fig:soil-vars">3.1</a>):</p>
<ol style="list-style-type: decimal">
<li><p><em>Direct measurements obtained using analytical instruments and
procedures in a laboratory or in the field</em> — the results of
measurements are analytical values considered representative for a
given soil property.</p></li>
<li><p><em>Indirect soil measurements obtained using mechanical devices,
analytical instruments and procedures</em> — measurement of soil
properties that can be used to infer information about a different
target soil property. These can be based on soil spectroscopy and
similar close-range or remote sensing systems
<span class="citation">(Shepherd and Walsh <a href="#ref-ShepherdWalsh2007JNIS">2007</a>; Viscarra Rossel, McBratney, and Minasny <a href="#ref-ViscarraRossel2010DSS">2010</a>)</span>.</p></li>
<li><p><em>Direct observations of soil properties and interpretations</em> —
subjectively assessed values based on protocols for soil description as presented in manuals
i.e. abundance of mottles, soil drainage class, soil colour.</p></li>
<li><p><em>Indirect or derived interpretations</em> — subjectively assessed values
or conditions based mainly on an expert’s knowledge and
interpretation of observations e.g. soil classification, soil
fertility class.</p></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:soil-vars"></span>
<img src="figures/Fig_types_observations.png" alt="Types of soil observations in relation to data usage and production costs. Descriptive soil observations (e.g. manual texture or diagnostic soil horizons) are often not directly useable by end users, who are often more interested in specific secondary soil properties (e.g. water holding capacity, erosion index, soil fertility) as inputs to their modeling. However, descriptive field observations are often some orders of magnitude more affordable to obtain than laboratory analysis." width="65%" angle=0 />
<p class="caption">
Figure 3.1: Types of soil observations in relation to data usage and production costs. Descriptive soil observations (e.g. manual texture or diagnostic soil horizons) are often not directly useable by end users, who are often more interested in specific secondary soil properties (e.g. water holding capacity, erosion index, soil fertility) as inputs to their modeling. However, descriptive field observations are often some orders of magnitude more affordable to obtain than laboratory analysis.
</p>
</div>

<div class="rmdnote">
Soil can be assessed quantitatively based on direct or indirect
measurements using analytical techniques (in a laboratory or in the
field) and qualitatively or descriptively based on observations in the
field that adhere to some soil description guidelines. Examples of
subjective observations are: diagnostic soil materials and horizons,
soil classes, Munsell color classes, manual texture assessment
(texture-by-hand), structure, compaction, root abundance and similar.
</div>

<p>Field campaigns are usuallly the most costly part of soil surveys. Large numbers
of soil observations are made in the field to assess the spatial
distribution of readily observable soil properties to provide empirical
evidence for soil mapping. Because a soil analytical measurement in the
laboratory is generally much more costly than a soil observation in the field,
only a smaller subset of soil samples is taken from the larger number of
field soil observations and brought to the laboratory for subsequent analysis.
Ideally, every soil observation would be accompanied by corresponding soil analytical
measurements to produce the most accurate and comprehensive soil information possible.</p>
<p>It is important to emphasize that soil properties, and the methods used to assess
soil properties, are two distinctly different concepts. The two can
be defined together (functional definition) or can be defined
separately, as given by numerous national and international manuals and
guidelines for analytical procedures and soil description: e.g. in
<span class="citation">Natural Resources Conservation Service (<a href="#ref-Burt2004SSIR">2004</a>; Carter and Gregorich <a href="#ref-carter2007soil">2007</a>; Food and United Nations <a href="#ref-food2006guidelines">2006</a>)</span>, and/or
<span class="citation">Van Reeuwijk (<a href="#ref-VanReeuwijk2002">2002</a>)</span>. Also in this chapter we make a distinction between the
<em>‘target variable’</em> (i.e. target soil properties) and <em>‘paths’</em> (
i.e. determination methods).</p>
<p>Soil analytical data obtained in a laboratory are typically an order of
magnitude more expensive to produce than descriptive field observations
<span class="citation">(Burrough, Beckett, and Jarvis <a href="#ref-Burrough1971">1971</a>; Gehl and Rice <a href="#ref-GehlRice2005">2007</a>; B. Kempen <a href="#ref-Kempen2011PhDthesis">2011</a>)</span>. To reduce these
high costs, surveyors collect descriptive soil observations (Fig. <a href="soil-variables-chapter.html#fig:soil-vars">3.1</a>),
which can subsequently be interpreted and linked to soil types and soil classes,
which are then assumed to be characterised by a limited and definable range
of soil properties <span class="citation">(Bouma, Batjes, and Groot <a href="#ref-bouma1998exploring">1998</a>)</span>. It is also possible to convert
observed values for certain soil properties to values comparable to
those measured by analytical methods (albeit with unknown precision) by
using various calibration models or <em>conversion functions</em>. For example,
<em>manual texturing</em> analysis <span class="citation">(FAO <a href="#ref-FAO1990">1990</a>; Soil survey Division staff <a href="#ref-SSDS1993">1993</a>)</span> can be used as a basis for estimating
soil texture fractions with a precision of ±5 % at fraction of
the cost of laboratory analysis.</p>
<p>Soils are usually sampled per depth interval or layer, generally using a
genetic A-B-C-R system i.e. corresponding to a <em>soil horizon</em> — a
relatively homogeneous layer of soil (with upper and lower depth) that
is <em>“distinctly different from other layers and informative for the
soil’s nature”</em> <span class="citation">(Harpstead, Sauer, and Bennett <a href="#ref-harpstead2001soil">2001</a>)</span>. Actual soil samples are either
taken from the centre of a soil horizon or are mixed samples of the
material from the whole horizon (Fig. <a href="soil-variables-chapter.html#fig:soi-var-depth">3.2</a>). Decades
of soil survey have shown that soil horizons can be fuzzy objects.
They may be difficult for different surveyors to distinguish and delineate consistently
<span class="citation">(Burrough <a href="#ref-Burrough1989JSS">1989</a>; de Gruijter, Walvoort, and Gaans <a href="#ref-DeGruijter1997Geoderma">1997</a>)</span>. Soil
correlation exercises try (not always successfully) to help different
surveyors consistently recognize similar soil horizons and assign similar codes with
comparable upper and lower boundaries so as to produce similar
descriptions and classifications for any observed soil.</p>
<div class="figure" style="text-align: center"><span id="fig:soi-var-depth"></span>
<img src="figures/Fig_soi_var_depth.png" alt="Soil observations can refer to genetic horizons (left), fixed depths i.e. point support (center) and/or can be aggregate values for the complete profile (right)." width="70%" />
<p class="caption">
Figure 3.2: Soil observations can refer to genetic horizons (left), fixed depths i.e. point support (center) and/or can be aggregate values for the complete profile (right).
</p>
</div>
<p>An emerging approach to soil characterization is to scan the complete soil
profile in different parts of the spectra, and then decide on vertical
stratification <em>a posteriori</em> <span class="citation">(Viscarra Rossel, McBratney, and Minasny <a href="#ref-ViscarraRossel2010DSS">2010</a>)</span>. Nevertheless,
much of the analytical data available in existing legacy soil profile
databases is sampled per soil layer and described by soil horizon.</p>
<p>Soil observations are taken at a geographic position and at a specific
depth (or depth interval), which is either 3D or refers to the whole solum. The 3D
(longitude, latitude, depth) position implies that the property varies
not only in geographic space, but also with depth. Soil properties that
describe an entire site are by implication 2D, as are soil properties
that summarise or refer to the soil profile as a whole (2D). For
example, soil type does not change with depth. Also rock outcrops, depth
to bedrock and depth to ground water table are single attributes that apply to an entire profile.</p>
</div>
<div id="soil-properties-of-interest-for-global-soil-mapping" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Soil properties of interest for global soil mapping</h3>
<p>There are many soil properties, possibly hundreds, used in the
international domain of soil science including pedology, soil survey,
soil fertility, soil hydrology, soil biology, etc. Not all of these can
be mapped globally, nor are all of explicit interest for global
applications or use.</p>
<p>Soil data have been, and are, collected and
compiled into maps at various scales for various purposes and soil
inventory projects typically begin by first carefully identifying the
specific list of soil properties that are of interest for the
anticipated uses of the planned survey. Different soil data are required
for different purposes, such as applying different models with different
data requirements.</p>
<p>In the past, soil surveys typically elected to focus on observing
and measuring soil attributes and properties that were considered
to be relatively stable, or static, in time. For example the particle
size distribution of a soil, or its depth to bedrock, were considered
to be relatively stable and not subject to large changes over relatively
short time periods (e.g. decades). Even attributes that were known to
change with management and time, such as topsoil thickness, organic carbon
or pH, were treated as relatively stable properties for the purposes of
mapping.</p>
<p>This choice to emphasize relatively stable soil properties and
attributes was a logical consequence of the fact that it could take years
to produce a single soil map and decades to complete mapping for an entire
area of interest. Consequently, for maps to be relevant, and to remain
relevant and useful for their anticipated lifetime of use, they had to
restrict themselves to trying to describe the variation in space only (not time)
of properties that could be considered stable and static.</p>
<p>The idea that soil properties could be assumed to remain relatively stable
through time was partially based on an assumption that most soils had
achieved a relatively stable condition that was in equilibruim with their
current environment. If a soil is in equilibruim with its enviromment, it
can be assumed that it will retain its present attributes, since there are
no strong drivers for change. This may well apply to undisturbed soils in
their natural environment, but it is not valid for disturbed or managed soils.
It is well established that human management practices can, and do, significantly
alter some key soil properties, such as pH, organic matter and topsoil thickness.
Most conventional soil maps recognized, and reported on, differences in
soil properties, such as pH or organic matter, between natural soils and
managed soils. However, it was never a common practice to name, map and
characterize managed soils seperately from natural soils.</p>
<p>Local or national soil survey projects are of direct
relevance to global soil mapping initiatives if the range of data
collected encompasses the minimum data set as specified for global
initiatives. For example, completion of an update to the SOTER database for the World
requires an extensive range of soil property data as specified in the
procedures manual <span class="citation">(Van Engelen and Dijkshoorn <a href="#ref-VanEngelen2012">2012</a>)</span>. An update of the Harmonised World
Soil Database <span class="citation">(FAO/IIASA/ISRIC/ISS-CAS/JRC <a href="#ref-FAO2012HWSD">2012</a>)</span> requires a smaller range of attributes. The
<em>GlobalSoilMap</em> project <span class="citation">(Arrouays et al. <a href="#ref-Arrouays201493">2014</a>)</span> selected a list of only
<em>twelve soil properties</em> considered relevant for global analyses and
feasible to map globally. This list includes seven basic attributes,
assessed through primary observation or measurement, and three derived
attributes which are calculated from the primary soil properties
(Tbl. <a href="soil-variables-chapter.html#tab:globalsoilmap">3.1</a>). These attributes are being mapped (as and
where possible) at a fine resolution of six depth intervals in the
vertical and, 3–arcseconds in the horizontal dimension (ca. 100 m)
(Fig. <a href="soil-variables-chapter.html#fig:scheme-solum">3.3</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:scheme-solum"></span>
<img src="figures/Fig_scheme_solum.png" alt="Standard soil horizons, solum thickness and depth to bedrock (left), six standard depths used in the GlobalSoilMap project (right)." width="75%" />
<p class="caption">
Figure 3.3: Standard soil horizons, solum thickness and depth to bedrock (left), six standard depths used in the GlobalSoilMap project (right).
</p>
</div>
<table>
<caption><span id="tab:globalsoilmap">Table 3.1: </span>The GlobalSoilMap project has selected seven primary (depth to bedrock, organic carbon content, pH, soil texture fractions, coarse fragments), three derived (effective soil depth, bulk density and available water capacity) and two optional (effective cation exchange capacity and electrical conductivity) target soil properties of interest for global soil mapping and modelling <span class="citation">(Soil survey Division staff <a href="#ref-SSDS1993">1993</a>; Natural Resources Conservation Service <a href="#ref-Burt2004SSIR">2004</a>)</span>.</caption>
<thead>
<tr class="header">
<th align="left">Variable.name</th>
<th align="left">Units</th>
<th align="left">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Total profile depth (depth to bedrock)</td>
<td align="left">cm</td>
<td align="left">(SSDS, 1993; p.5)</td>
</tr>
<tr class="even">
<td align="left">Plant exploitable (effective depth)</td>
<td align="left">cm</td>
<td align="left">(SSDS, 1993; p.60)</td>
</tr>
<tr class="odd">
<td align="left">Soil organic carbon (dry combustion)</td>
<td align="left">permille</td>
<td align="left">ISO 10694</td>
</tr>
<tr class="even">
<td align="left">pH index (the 1:5 H2O solution)</td>
<td align="left">–</td>
<td align="left">ISO 10390</td>
</tr>
<tr class="odd">
<td align="left">Sand content (gravimetric)</td>
<td align="left">%</td>
<td align="left">(NRCS, 2004; p.347)</td>
</tr>
<tr class="even">
<td align="left">Silt content (gravimetric)</td>
<td align="left">%</td>
<td align="left">(NRCS, 2004; p.347)</td>
</tr>
<tr class="odd">
<td align="left">Clay content (gravimetric)</td>
<td align="left">%</td>
<td align="left">(NRCS, 2004; p.347)</td>
</tr>
<tr class="even">
<td align="left">Coarse fragments (volumetric)</td>
<td align="left">%</td>
<td align="left">(NRCS, 2004; p.36)</td>
</tr>
<tr class="odd">
<td align="left">Effective Cation Exchange Capacity</td>
<td align="left">cmol</td>
<td align="left">ISO 11260</td>
</tr>
<tr class="even">
<td align="left">Bulk density of the whole soil</td>
<td align="left">kg/cubic-m</td>
<td align="left">ISO 11272</td>
</tr>
</tbody>
</table>
</div>
<div id="reference-methods" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Reference methods</h3>
<p>A pragmatic solution to ensuring efficient exchange, sharing and interpretation of global soil data
is to establish reference methods for soil measurement and description. The
<em>GlobalSoilMap</em> project agreed that their target soil properties would be
assessed and reported relative to specific, designated <em>reference
methods</em>. For example, soil organic carbon content of the fine earth
fraction is to be assessed and reported according to ISO10694 dry
combustion method <span class="citation">(Sleutel et al. <a href="#ref-Sleutel2007CSSPA">2007</a>)</span>. Values for pH are to be be
reported for a 1:5 suspension of soil in water or using the CaCl<span class="math inline">\(_2\)</span>
solution, with a precision of 1 decimal place. It has also been
recommended that ISO TC 190 — soil quality standards — should be used to
assess and report all data measured from air-dried soil samples.</p>
<p>Soil properties designated as optional for the <em>GlobalSoilMap</em>
consortium include Effective Cation Exchange Capacity assessed and
reported according to ISO11260 Barium Chloride (cmol+/kg = centi-mole+ per kilogram)
and Electrical conductivity in 1:1 soil–water solution (dS/m = deci-siemens per metre).
The list of soil properties identified for global soil mapping and
modelling is likely to grow in the years to come. Initially,
GSIF has elected to simply accept and adopt the list of soil properties
specified for the <em>GlobalSoilMap</em>
project and to extend this list through time in consultation with this
and other global soil entities.</p>
<p>The International Organisation for Standardisation (ISO) provides
international standard definitions of soil properties, and of associated
methods to assess those soil properties, through <code>ISO TC-190</code> and
<code>ISO TC-345</code>. Such unambiguously defined international standards are
required for purposes as such as multi-partner global soil mapping.</p>
<p>In the following sections we focus our discussion on the soil properties
that have been mapped for the <a href="www.soilgrids.org" class="uri">www.soilgrids.org</a> project:
depth to bedrock, occurrence of the <code>R</code> horizon, organic carbon content of the fine earth
fraction, pH of the fine earth fraction, particle size class contents
(sand, silt, clay) of the fine earth fraction, gravel content of the
whole soil, bulk density of the whole soil (and subsequently of the fine
earth fraction) and Cation Exchange Capacity of the fine earth fraction.
We define those attributes as completely and unambiguously as possible,
including the associated reference method. For each soil property the
following will be discussed:</p>
<ul>
<li><p><em>Brief introduction to the soil property (what is it, what does it
reflect, why is it of interest, considerations; in general terms)</em>;</p></li>
<li><p><em>Definition of the soil feature related to the soil property and
it’s spatial domain (2D, 3D)</em>;</p></li>
<li><p><em>Definition of the reference method to assess the soil property
value</em>;</p></li>
<li><p><em>Definition of the convention used to express the soil property value
(units, precision, range)</em>;</p></li>
<li><p><em>Review of the variation in soil property definitions and in methods
to assess the attribute, including listings of several of the most
widely used conversion functions cited from literature and with
emphasis on harmonisation or conversion to the reference method</em>.</p></li>
</ul>
<p>We also identify, and review, a number of other widely used measurement
methods, in addition to our selected standard methods. We describe if and
how these other methods relate to the selected reference methods and
discuss issues related to harmonization and standardization for
attributes of current interest for global mapping.</p>
</div>
<div id="standard-soil-variables-of-interest-for-soil-mapping" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Standard soil variables of interest for soil mapping</h3>
<p>Some standard soil legends for listed soil properties are embedded
within the GSIF package and can be loaded by:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GSIF)
<span class="co">#&gt; GSIF version 0.5-4 (2017-04-25)</span>
<span class="co">#&gt; URL: http://gsif.r-forge.r-project.org/</span>
<span class="kw">data</span>(soil.legends)
<span class="kw">str</span>(soil.legends)
<span class="co">#&gt; List of 12</span>
<span class="co">#&gt;  $ ORCDRC  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 0 0.2 0.4 0.6 0.8 1.1 1.5 1.9 2.4 3 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 0.2 0.4 0.6 0.8 1.1 1.5 1.9 2.4 3 3.6 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0161 0.0301 0.0518 0.0717 0.113 0.159 0.203 0.264 0.328 0.373 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#000180&quot; &quot;#000393&quot; &quot;#0006A6&quot; &quot;#000FB7&quot; ...</span>
<span class="co">#&gt;  $ PHIHOX  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 20 42 45 46 48 49 50 51 52 53 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 42 45 46 48 49 50 51 52 53 54 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0125 0.0375 0.0625 0.0875 0.1125 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#FF0000&quot; &quot;#FF1C00&quot; &quot;#FF3900&quot; &quot;#FF5500&quot; ...</span>
<span class="co">#&gt;  $ PHIKCL  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 20 33 35 36 37 38 38.5 39 40 40.5 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 33 35 36 37 38 38.5 39 40 40.5 41 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0125 0.0375 0.0625 0.0875 0.1125 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#FF0000&quot; &quot;#FF1C00&quot; &quot;#FF3900&quot; &quot;#FF5500&quot; ...</span>
<span class="co">#&gt;  $ BLDFIE  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 200 850 1000 1100 1150 1200 1220 1260 1300 1310 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 850 1000 1100 1150 1200 1220 1260 1300 1310 1340 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0125 0.0375 0.0625 0.0875 0.1125 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#3D3FFF&quot; &quot;#3A42FF&quot; &quot;#3745FF&quot; &quot;#304CFF&quot; ...</span>
<span class="co">#&gt;  $ CECSOL  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 0 5 5.2 5.3 5.5 5.8 6 6.3 6.7 7.1 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 5 5.2 5.3 5.5 5.8 6 6.3 6.7 7.1 7.5 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.23 0.241 0.247 0.259 0.277 0.292 0.308 0.328 0.351 0.37 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#001998&quot; &quot;#0025A4&quot; &quot;#0031B1&quot; &quot;#003EBD&quot; ...</span>
<span class="co">#&gt;  $ SNDPPT  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 0 1 3 4 6 8 10 12 14 16 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 1 3 4 6 8 10 12 14 16 19 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0125 0.0375 0.0625 0.0875 0.1125 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#FFFF00&quot; &quot;#F8F806&quot; &quot;#F1F10C&quot; &quot;#EBEB13&quot; ...</span>
<span class="co">#&gt;  $ SLTPPT  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 0 2 3 4 5 6.7 8 9 10 12 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 2 3 4 5 6.7 8 9 10 12 13 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0125 0.0375 0.0625 0.0875 0.1125 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#FFFF00&quot; &quot;#F8F806&quot; &quot;#F1F10C&quot; &quot;#EBEB13&quot; ...</span>
<span class="co">#&gt;  $ CLYPPT  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 0 2 3 4 5 6 7 8 9.3 10 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 2 3 4 5 6 7 8 9.3 10 12 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.0125 0.0375 0.0625 0.0875 0.1125 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#FFFF00&quot; &quot;#F8F806&quot; &quot;#F1F10C&quot; &quot;#EBEB13&quot; ...</span>
<span class="co">#&gt;  $ CRFVOL  :&#39;data.frame&#39;:    40 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ MIN  : num [1:40] 0 0.1 0.3 0.4 0.6 0.8 1 1.2 1.5 1.8 ...</span>
<span class="co">#&gt;   ..$ MAX  : num [1:40] 0.1 0.3 0.4 0.6 0.8 1 1.2 1.5 1.8 2.2 ...</span>
<span class="co">#&gt;   ..$ CPROB: num [1:40] 0.408 0.41 0.411 0.416 0.418 0.504 0.506 0.513 0.514 0.558 ...</span>
<span class="co">#&gt;   ..$ COLOR: chr [1:40] &quot;#FFFF00&quot; &quot;#FDF800&quot; &quot;#FBF100&quot; &quot;#F9EB00&quot; ...</span>
<span class="co">#&gt;  $ TAXOUSDA:&#39;data.frame&#39;:    74 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ Number : int [1:74] 0 1 2 3 5 6 7 10 11 12 ...</span>
<span class="co">#&gt;   ..$ Group  : Factor w/ 75 levels &quot;&quot;,&quot;Albolls&quot;,&quot;Anthrepts&quot;,..: 39 50 47 38 35 54 41 28 26 34 ...</span>
<span class="co">#&gt;   ..$ Generic: Factor w/ 17 levels &quot;&quot;,&quot;Alfisols&quot;,..: 11 14 13 8 6 6 6 7 7 7 ...</span>
<span class="co">#&gt;   ..$ COLOR  : chr [1:74] &quot;#1414FF&quot; &quot;#D2D2D2&quot; &quot;#FFB9B9&quot; &quot;#F5F5F5&quot; ...</span>
<span class="co">#&gt;  $ TAXGWRB :&#39;data.frame&#39;:    32 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ Number: int [1:32] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ Code  : Factor w/ 32 levels &quot;AB&quot;,&quot;AC&quot;,&quot;AL&quot;,..: 2 1 3 4 6 5 8 9 7 10 ...</span>
<span class="co">#&gt;   ..$ Group : Factor w/ 32 levels &quot;Acrisols&quot;,&quot;Albeluvisols&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ COLOR : chr [1:32] &quot;#FDA463&quot; &quot;#FFEBBE&quot; &quot;#FFFFCC&quot; &quot;#FC6B5D&quot; ...</span>
<span class="co">#&gt;  $ TAXNWRB :&#39;data.frame&#39;:    118 obs. of  5 variables:</span>
<span class="co">#&gt;   ..$ Number        : int [1:118] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;   ..$ Group         : Factor w/ 118 levels &quot;Acric Ferralsols&quot;,..: 28 29 30 31 104 116 32 84 111 18 ...</span>
<span class="co">#&gt;   ..$ Shortened_name: Factor w/ 118 levels &quot;Acric.Ferralsols&quot;,..: 28 29 30 31 104 116 32 84 111 18 ...</span>
<span class="co">#&gt;   ..$ Generic       : Factor w/ 30 levels &quot;Acrisols&quot;,&quot;Albeluvisols&quot;,..: 1 1 1 1 1 1 2 2 2 3 ...</span>
<span class="co">#&gt;   ..$ COLOR         : chr [1:118] &quot;#FE813E&quot; &quot;#FD9F39&quot; &quot;#FDAE6B&quot; &quot;#FD8D3C&quot; ...</span></code></pre>
<p>which illustrates the referent cumulative probabilities (<code>CPROB</code>) and
appropriate color legend (<code>COLOR</code>; coded as a six-digit, three-byte
hexadecimal number) for the values of the target soil variables. The cumulative
probabilities were derived using the collection of records in the World
Soil Profiles repository and can be considered as an estimate of global prior
probabilities for soil pH (see further for example
Fig. ).</p>
<p>A general intention is to maintain a <em>Global Soil Data
Registry</em> so that a short variable name (in further text <em>“GSIF code”</em>)
can be linked to a unique set of metadata which should include:</p>
<ul>
<li><p>Full description;</p></li>
<li><p>Variable type (numeric, quantity, binary, factor etc)</p></li>
<li><p>Measurement unit;</p></li>
<li><p>Biblio reference (URL or DOI);</p></li>
<li><p>ISO code (if available);</p></li>
<li><p>Physical limits (lower / upper);</p></li>
<li><p>Detection limit i.e. numeric resolution;</p></li>
<li><p>Priority level (required, suggested or optional);</p></li>
</ul>
<p>Note that MySQL has some restrictions considering column names: special
characters, those outside the set of alphanumeric characters from the
current character set, can not be used in the column names. Proposed
abbreviations for standard method names are <span class="math inline">\(\mathtt{VOL}\)</span> — volume
fraction, <span class="math inline">\(\mathtt{ABU}\)</span> — abundance or relative area cover,
<span class="math inline">\(\mathtt{PCT}\)</span> — mass percentage, <span class="math inline">\(\mathtt{ICM}\)</span> — thickness in cm,
<span class="math inline">\(\mathtt{MHT}\)</span> — texture by-hand or manual hand texture and
<span class="math inline">\(\mathtt{MNS}\)</span> — Munsell color codes, horizon sequence is coded with the
capital ASCII letters — <span class="math inline">\(\mathtt{A}\)</span>, <span class="math inline">\(\mathtt{B}\)</span>,
<span class="math inline">\(\mathtt{C}\)</span>,<span class="math inline">\(\ldots\)</span> <span class="math inline">\(\mathtt{Z}\)</span>. Another option is to simply use
the US Goverment National Cooperative Soil Characterization Database column names (<a href="http://ncsslabdatamart.sc.egov.usda.gov/" class="uri">http://ncsslabdatamart.sc.egov.usda.gov/</a>).</p>
<p>Also note that the metadata can be easily separated from the code so
that the short GSIF code (variable name) could be used as a shorthand (replacement)
for the long description of the complete metadata. Using short GSIF
codes is also important for programming because unique code names are
used consistently in all scripts / functions.</p>
</div>
</div>
<div id="descriptive-soil-profile-observations" class="section level2">
<h2><span class="header-section-number">3.2</span> Descriptive soil profile observations</h2>
<div id="depth-to-bedrock" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Depth to bedrock</h3>
<p>Soil depth (specifically depth to bedrock) is predicted because it is an
important consideration for a wide variety of engineering, hydrological
and agronomic interpretations. Shallow and lithic soils are of
particular interest as they impose restrictions for foundations and
structures in engineering, limit infiltration and storage of moisture
and produce more rapid runoff and erosion and limit growth of many crops
by restricting rooting depth and limiting available moisture storage.
Most soil legacy profile data do not provide any information about the
soil below depths of 1 m <span class="citation">(Richter and Markewitz <a href="#ref-Richter1995">1995</a>)</span>. This characteristic of legacy
soil data limits its usefulness for predicting soil depths greater than
2 m.</p>
<p>Soil depth is measured from the soil surface downwards and expressed in
positive values increasing with depth. Google Earth and the KML data
standard (via the <code>altitudeMode</code> tag) allow one to specify if the
vertical dimension refers to actual altitude (vertical distance from the
land surface) or to distance from the sea level (<code>absolute</code>). In this
case soil depths can be represented using <code>clampToGround</code> and negative
values. For example, depth of 30 cm can be expressed as <span class="citation">(Wilson <a href="#ref-OGCKML2008">2008</a>)</span>:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="op">&lt;</span><span class="ex">Placemark</span><span class="op">&gt;</span> <span class="op">&lt;</span>Point<span class="op">&gt;</span>
<span class="op">&lt;</span><span class="ex">altitudeMode</span><span class="op">&gt;</span>clampToGround<span class="op">&lt;</span>/altitudeMode<span class="op">&gt;</span>
<span class="op">&lt;</span><span class="ex">coordinates</span><span class="op">&gt;</span>17.2057,45.8851,-0.<span class="op">3&lt;</span>/coordinates<span class="op">&gt;</span>
<span class="op">&lt;</span>/<span class="ex">Point</span><span class="op">&gt;</span> <span class="op">&lt;</span>/Placemark<span class="op">&gt;</span></code></pre>
<p>Soil surface (depth = 0 cm) is the top of the mineral soil; or, for soils
with a litter layer (<code>O</code> horizon), the soil surface is the top of the
part of the <code>O</code> horizon that is at least slightly decomposed <span class="citation">(FAO <a href="#ref-FAO2006">2006</a>)</span>.
Fresh leaf or needle fall that has not undergone observable
decomposition is not considered to be part of the soil and may be
described separately. For organic soils, the top of any surface horizon
identified as an <code>O</code> horizon is considered the soil surface.</p>
<div class="figure" style="text-align: center"><span id="fig:scheme-depth-to-bedrock"></span>
<img src="figures/Fig_depth_2_bedrock.png" alt="Depth to bedrock for censured and uncensured observations. Image source: Shangguan et al. (2017) doi: 10.1002/2016MS000686." width="100%" />
<p class="caption">
Figure 3.4: Depth to bedrock for censured and uncensured observations. Image source: Shangguan et al. (2017) doi: 10.1002/2016MS000686.
</p>
</div>
<p>The <em>depth to bedrock</em> i.e. depth to the <code>R</code> horizon is measured from
the soil surface downwards and is expressed in cm with a precision of ±1 cm.
Depth to bedrock deeper than e.g. 2–3 m is most often not recorded. Bedrock
is consolidated hard rock, with only a few cracks, underlying the soil. It
is not necessarily parent material. We imagine it often as something
distinct and easy to recognize in the field. In practice, depth to
bedrock can be difficult to determine, and is often confused with
stoniness or depth to parent material (which can be unconsolidated
material). Another issue is that, for most of the soils in the world,
hard bedrock is &gt;2 m deep so that we actually don’t know the correct
depth to enter, other than &gt;2 m. Rootability is physically restricted by
the bedrock, whether hard or soft (see Fig. <a href="soil-variables-chapter.html#fig:scheme-depth-to-bedrock">3.4</a>).</p>

<div class="rmdnote">
Depth to bedrock is the mean distance to <code>R</code> horizon which is the layer
impenetrable by roots or agricultural machinery. Depth to bedrock deeper
than 2 m is most often not recorded in field survey descriptions.
</div>

<p>In traditional soil characterisation, the total depth of the <code>O</code>,
<code>A</code>,<code>E</code>, and <code>B</code> horizons is referred to as the <em>solum</em>
<span class="citation">(Harpstead, Sauer, and Bennett <a href="#ref-harpstead2001soil">2001</a>)</span>, while the underlaying layer is referred to as
parent material or substratum <span class="citation">(Soil survey Division staff <a href="#ref-SSDS1993">1993</a>)</span>. Parent material can be coarse
or fine unconsolidated deposits of e.g. alluvial, colluvial or windblown
origin (<code>C</code> horizon) or consolidated residual hard bedrock (<code>R</code>
horizon).</p>
</div>
<div id="effective-soil-depth-and-rooting-depth" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Effective soil depth and rooting depth</h3>
<p><em>Effective soil depth</em> is of interest for soil mapping because it is a
key indicator of the capability of the soil to store moisture, support
crop growth and sustain beneficial land uses. It is often an essential
indicator of soil health. The effective soil depth is the depth to which
micro-organisms are active in the soil, where roots can develop and
where soil moisture can be stored <span class="citation">(FAO <a href="#ref-FAO2006">2006</a>)</span>.</p>
<table>
<caption><span id="tab:rootingdepths">Table 3.2: </span>Summary of maximum rooting depth by biome (after Canadell et al. (1996)). MMRD = Mean maximum rooting depth in m; HVRD = Highest value for rooting depth in m.</caption>
<thead>
<tr class="header">
<th align="left">Biome</th>
<th align="right">N</th>
<th align="left">MMRD</th>
<th align="right">HVRD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Boreal Forest</td>
<td align="right">6</td>
<td align="left">2.0 ± 0.3</td>
<td align="right">3.3</td>
</tr>
<tr class="even">
<td align="left">Cropland</td>
<td align="right">17</td>
<td align="left">2.1 ± 0.2</td>
<td align="right">3.7</td>
</tr>
<tr class="odd">
<td align="left">Desert</td>
<td align="right">22</td>
<td align="left">9.5 ± 2.4</td>
<td align="right">53.0</td>
</tr>
<tr class="even">
<td align="left">Sclerophyllous shrubland and forest</td>
<td align="right">57</td>
<td align="left">5.2 ± 0.8</td>
<td align="right">40.0</td>
</tr>
<tr class="odd">
<td align="left">Temperate coniferous forest</td>
<td align="right">17</td>
<td align="left">3.9 ± 0.4</td>
<td align="right">7.5</td>
</tr>
<tr class="even">
<td align="left">Temperate deciduous forest</td>
<td align="right">19</td>
<td align="left">2.9 ± 0.2</td>
<td align="right">4.4</td>
</tr>
<tr class="odd">
<td align="left">Temperate grassland</td>
<td align="right">82</td>
<td align="left">2.6 ± 0.2</td>
<td align="right">6.3</td>
</tr>
<tr class="even">
<td align="left">Tropical deciduous forest</td>
<td align="right">5</td>
<td align="left">3.7 ± 0.5</td>
<td align="right">4.7</td>
</tr>
<tr class="odd">
<td align="left">Tropical evergreen forest</td>
<td align="right">5</td>
<td align="left">7.3 ± 2.8</td>
<td align="right">18.0</td>
</tr>
<tr class="even">
<td align="left">Tropical savanna</td>
<td align="right">15</td>
<td align="left">15.0 ± 5.4</td>
<td align="right">68.0</td>
</tr>
</tbody>
</table>
<p>There are many thoughts on how to define effective soil depth. Effective
soil depth is closely related to, but not necessarily equivalent to, the
<em>rooting depth</em>. Rooting depth is measured and reported relative to a
specific prevailing land cover and land use category, while effective
soil depth is supposedly the maximum possible depth of soil that can be
used by any growing plant (see Tbl. <a href="soil-variables-chapter.html#tab:rootingdepths">3.2</a>).</p>
<p>In some cases soil ends with an abrupt change of material which is
either solid, compacted or distinctly impenetrable for plants and
organisms living in soil. The root restricting i.e. plant accessible
depth, is the depth at which root penetration is strongly inhibited
because of physical (including soil temperature), chemical or
hydrological characteristics <span class="citation">(Soil survey Division staff <a href="#ref-SSDS1993">1993</a>, Handbook 18:60)</span>. Restriction means the
inability to support more than a very few fine or few very fine roots if
depth from the soil surface and water state, other than the occurrence
of frozen water, are not limiting. For some crops like cotton plants or
soybeans, and possibly other crops with less abundant roots than the
grasses, the very few class is used instead of the few class. The
restriction may be below where plant roots normally occur because of
limitations in water state, temperatures, or depth from the surface.
This evaluation can be based on the specific plants that are important
to the use of the soil, as indicated in Tbl. <a href="soil-variables-chapter.html#tab:rootingdepths">3.2</a>; see
also <span class="citation">Soil survey Division staff (<a href="#ref-SSDS1993">1993</a>, Handbook 18:60)</span>.</p>
<p>Root restriction can be also influenced by certain pedogenic horizons,
such as <em>fragipans</em>. A change in particle size distribution alone, as
for example loamy sand over gravel, is not always a basis for physical
root restriction. A common indication of physical root restriction is a
combination of structure and consistence which together suggest that the
resistance of the soil fabric to root entry is high and that vertical
cracks and planes of weakness for root entry are absent or widely
spaced. Root restriction is inferred for a continuously cemented zone of
any thickness; or a zone &gt;10 cm thick that when very moist or wet is
massive, platy, or has weak structure of any type for a vertical repeat
distance of &gt;10 cm and while very moist or wet is very firm (firm, if
sandy), extremely firm, or has a large penetration resistance. Chemical
restrictions, such as high extractable aluminum, manganese and/or low
extractable calcium, can also be considered but are plant-specific.
Root-depth observations preferably should be used to make the
generalization. If these are not available then inferences may be made
from morphology.</p>
<p>As a general recommendation, it is advisable to focus first on mapping soil properties that
limit rooting, including content of coarse fragments and the depth to
bedrock, and then define effective soil depth <em>a posteriori</em> using
distinct analytical rules. A similar approach has also been promoted by
<span class="citation">Rijsberman and Wolman (<a href="#ref-rijsberman1985effect">1985</a>)</span> and <span class="citation">Driessen and Konijn (<a href="#ref-driessen1992land">1992</a>)</span> who refer to it as the
<em>Soil-productivity Index</em> — a product of soil-water sufficiency, soil pH
sufficiency and soil bulk density sufficiency. Here we consider somewhat
wider range of soil properties that can affect rooting depth, such as:</p>
<ul>
<li><p>coarse fragments,</p></li>
<li><p>compaction / porosity (possibly derived from structure and
consistence),</p></li>
<li><p>drainage i.e. soil oxygen availability,</p></li>
<li><p>toxicity e.g. Al content,</p></li>
<li><p>acidity, salinity and similar.</p></li>
</ul>
<p>In-field expert interpretation explicitly summarising observations into
a single expression for rooting depth is likely the most effective and
reliable source of information. The genetically determined maximum
rooting depth of vegetation isn’t always a reliable indicator of actual
observed effective rooting depth of a given soil at a given site (Fig. <a href="soil-variables-chapter.html#fig:lri-scheme">3.5</a>).
Possibly a more robust way to determine the effective rooting depth is
to map all limiting soil properties with high accuracy, and then derive
rooting index per layer.</p>
<div class="figure" style="text-align: center"><span id="fig:lri-scheme"></span>
<img src="figures/Fig_LRI_scheme.png" alt="Derivation of the Limiting Rooting Index: (left) soil pH values and corresponding LRI, (right) coarse fragments and corresponding LRI. Based on Leenaars et al. (2018) doi: 10.1016/j.geoderma.2018.02.046." width="90%" />
<p class="caption">
Figure 3.5: Derivation of the Limiting Rooting Index: (left) soil pH values and corresponding LRI, (right) coarse fragments and corresponding LRI. Based on Leenaars et al. (2018) doi: 10.1016/j.geoderma.2018.02.046.
</p>
</div>
<p>By using the GSIF package, one can determine Limiting Rooting Index, which
can be a good indicator of the effective rooting depth. Consider the
following soil profile from Nigeria <span class="citation">(Leenaars <a href="#ref-Leenaars2012">2014</a>)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">## sample profile from Nigeria (ISRIC:NG0017):
UHDICM =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">36</span>, <span class="dv">65</span>, <span class="dv">87</span>, <span class="dv">127</span>)
LHDICM =<span class="st"> </span><span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">36</span>, <span class="dv">65</span>, <span class="dv">87</span>, <span class="dv">127</span>, <span class="dv">181</span>)
SNDPPT =<span class="st"> </span><span class="kw">c</span>(<span class="dv">66</span>, <span class="dv">70</span>, <span class="dv">54</span>, <span class="dv">43</span>, <span class="dv">35</span>, <span class="dv">47</span>)
SLTPPT =<span class="st"> </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">23</span>)
CLYPPT =<span class="st"> </span><span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">32</span>, <span class="dv">43</span>, <span class="dv">47</span>, <span class="dv">30</span>)
CRFVOL =<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">54</span>, <span class="dv">19</span>, <span class="dv">17</span>)
BLD =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.57</span>, <span class="fl">1.60</span>, <span class="fl">1.52</span>, <span class="fl">1.50</span>, <span class="fl">1.40</span>, <span class="fl">1.42</span>)<span class="op">*</span><span class="dv">1000</span>
PHIHOX =<span class="st"> </span><span class="kw">c</span>(<span class="fl">6.5</span>, <span class="fl">6.9</span>, <span class="fl">6.5</span>, <span class="fl">6.2</span>, <span class="fl">6.2</span>, <span class="fl">6.0</span>)
CEC =<span class="st"> </span><span class="kw">c</span>(<span class="fl">9.3</span>, <span class="fl">4.5</span>, <span class="fl">6.0</span>, <span class="fl">8.0</span>, <span class="fl">9.4</span>, <span class="fl">10.9</span>)
ENA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>)
EACKCL =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="fl">0.5</span>)
EXB =<span class="st"> </span><span class="kw">c</span>(<span class="fl">8.9</span>, <span class="fl">4.0</span>, <span class="fl">5.7</span>, <span class="fl">7.4</span>, <span class="fl">8.9</span>, <span class="fl">10.4</span>)
ORCDRC =<span class="st"> </span><span class="kw">c</span>(<span class="fl">18.4</span>, <span class="fl">4.4</span>, <span class="fl">3.6</span>, <span class="fl">3.6</span>, <span class="fl">3.2</span>, <span class="fl">1.2</span>)
x &lt;-<span class="st"> </span><span class="kw">LRI</span>(<span class="dt">UHDICM=</span>UHDICM, <span class="dt">LHDICM=</span>LHDICM, <span class="dt">SNDPPT=</span>SNDPPT, 
   <span class="dt">SLTPPT=</span>SLTPPT, <span class="dt">CLYPPT=</span>CLYPPT, <span class="dt">CRFVOL=</span>CRFVOL, 
   <span class="dt">BLD=</span>BLD, <span class="dt">ORCDRC=</span>ORCDRC, <span class="dt">CEC=</span>CEC, <span class="dt">ENA=</span>ENA, <span class="dt">EACKCL=</span>EACKCL, 
   <span class="dt">EXB=</span>EXB, <span class="dt">PHIHOX=</span>PHIHOX, <span class="dt">print.thresholds=</span><span class="ot">TRUE</span>)
x
<span class="co">#&gt; [1] TRUE TRUE TRUE TRUE TRUE TRUE</span>
<span class="co">#&gt; attr(,&quot;minimum.LRI&quot;)</span>
<span class="co">#&gt; [1] 35.0 29.5 47.0 54.5 73.0 61.5</span>
<span class="co">#&gt; attr(,&quot;most.limiting.factor&quot;)</span>
<span class="co">#&gt; [1] &quot;tetaS&quot; &quot;tetaS&quot; &quot;tetaS&quot; &quot;tetaS&quot; &quot;tetaS&quot; &quot;tetaS&quot;</span>
<span class="co">#&gt; attr(,&quot;thresholds&quot;)</span>
<span class="co">#&gt; attr(,&quot;thresholds&quot;)$ERscore1</span>
<span class="co">#&gt;  [1] 100.0  80.0  50.0   0.0  95.0  40.0  40.0   5.5   7.8   1.5  10.0</span>
<span class="co">#&gt; [12]   1.0  35.0   2.5 150.0 150.0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;thresholds&quot;)$ERscore2</span>
<span class="co">#&gt;  [1]   0.00  90.00  30.00   0.35 100.00  60.00  60.00   3.62   9.05   6.75</span>
<span class="co">#&gt; [11]  25.00   5.00  85.00   6.50 750.00 750.00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;thresholds&quot;)$Trend</span>
<span class="co">#&gt;  [1]  0 -1  1 -1 -1 -1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;thresholds&quot;)$Score</span>
<span class="co">#&gt;  [1] 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;thresholds.names&quot;)</span>
<span class="co">#&gt; attr(,&quot;thresholds.names&quot;)$variable</span>
<span class="co">#&gt;  [1] &quot;range&quot;    &quot;CRFVOL&quot;   &quot;tetaS&quot;    &quot;BLD.f&quot;    &quot;SNDPPT&quot;   &quot;CLY.d&quot;   </span>
<span class="co">#&gt;  [7] &quot;SND.d&quot;    &quot;PHIHOX.L&quot; &quot;PHIHOX.H&quot; &quot;ECN&quot;      &quot;ENA.f&quot;    &quot;ENA&quot;     </span>
<span class="co">#&gt; [13] &quot;EACKCL.f&quot; &quot;EACKCL&quot;   &quot;CRB&quot;      &quot;GYP&quot;</span>
## Most limiting: BLD.f and CRFVOL, but nothing &lt; 20</code></pre>
<p>where <code>UHDICM</code> and <code>LHDICM</code> are the upper and lower horizon depth in cm,
<code>SNDPPT</code>, <code>SLTPPT</code> and <code>CLYPPT</code> are the sand, silt and clay content in
percent, <code>CRFVOL</code> is the volume percentage of coarse fragments (&gt;2 mm),
<code>BLD</code> is the bulk density in t/m<span class="math inline">\(^3\)</span>, <code>ORCDRC</code> is the soil organic carbon
concentration in permille or g/kg, <code>ECN</code> is the electrical conductivity in dS/m,
<code>CEC</code> is the Cation Exchange Capacity in cmol/kg (centi-mol per kilogram), <code>ENA</code> is the exchangable Na
in cmol/kg, <code>EACKCL</code> is the exchangeable acidity in cmol/kg, <code>EXB</code> is the exchangeable
bases in cmol/kg, <code>PHIHOX</code> is the soil pH in water suspension, <code>CRB</code> is the
CaCO<span class="math inline">\(_3\)</span> (carbonates) in g/kg, <code>GYP</code> is the CaSO<span class="math inline">\(_4\)</span> (gypsum) in and <code>tetaS</code>
is the volumetric percentage of water.</p>
<p>For this specific profile, the most limiting soil property is <code>tetaS</code>, but
because none of the soil properties got &lt;20 points, we can conclude
that the maximum rooting depth is &gt;180 cm. Note that the threshold values in
the <code>LRI</code> function used to derive Limiting Rootability scores are set
based on common soil agricultural productivity tresholds (e.g. for
maize; see also Fig. <a href="soil-variables-chapter.html#fig:lri-scheme">3.5</a>), and can be adjusted via the
<code>thresholds</code> argument. The computation is done per list of soil layers
(minimum three) to account for textural changes i.e. sudden changes in
sand and clay content and for the limiting layers such as layer
saturated with water. To determine futher the effective rooting depth we can run:</p>
<pre class="sourceCode r"><code class="sourceCode r">sel &lt;-<span class="st"> </span>x<span class="op">==</span><span class="ot">FALSE</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">all</span>(sel<span class="op">==</span><span class="ot">FALSE</span>)){ 
  UHDICM[<span class="kw">which</span>(sel<span class="op">==</span><span class="ot">TRUE</span>)[<span class="dv">1</span>]] 
} <span class="cf">else</span> {
  <span class="kw">max</span>(LHDICM)
}
<span class="co">#&gt; [1] 181</span>

xI &lt;-<span class="st"> </span><span class="kw">attr</span>(x, <span class="st">&quot;minimum.LRI&quot;</span>)
## derive Effective rooting depth:
<span class="kw">ERDICM</span>(<span class="dt">UHDICM=</span>UHDICM, <span class="dt">LHDICM=</span>LHDICM, <span class="dt">minimum.LRI=</span>xI, <span class="dt">DRAINFAO=</span><span class="st">&quot;M&quot;</span>)
<span class="co">#&gt; [1] 100</span></code></pre>
</div>
</div>
<div id="chemical-soil-properties" class="section level2">
<h2><span class="header-section-number">3.3</span> Chemical soil properties</h2>
<div id="soil-organic-carbon" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Soil organic carbon</h3>
<p>Organic carbon is a soil property of great current global interest
<span class="citation">(Smith, Falloon, and Kutsch <a href="#ref-Smith2004SUM">2004</a>; Pete Smith and Kutsch <a href="#ref-Smith2010CUP">2010</a>; Panagos et al. <a href="#ref-Panagos2013439">2013</a>)</span>. It is commonly
recognized and used as a key indicator of soil health. The amount of
carbon present in the soil, and particularly in topsoil horizons, is
grossly indicative of potential productivity for crops. Amounts of
organic carbon throughout the profile influence soil structure,
permeability, porosity, bulk density, water holding capacity, nutrient
retention and availability and, consequently, overall soil health. The
ability of soils to sequester significant quantities of atmospheric
carbon is of considerable interest as a potential mechanism for
mitigating the adverse effects of increases in green house gasses in the
atmosphere <span class="citation">(Smith, Falloon, and Kutsch <a href="#ref-Smith2004SUM">2004</a>; Conant et al. <a href="#ref-Conant2010">2010</a>; Scharlemann et al. <a href="#ref-Scharlemann2014CM">2014</a>)</span>.
Consequently, soil organic carbon is probably the soil property of
greatest current interest and utility from the point of view of global
mapping, and interpretation, of soil properties.</p>

<div class="rmdnote">
Soil Organic Carbon is one the key measures of soil health.
The standard reference method for assessing and reporting soil organic
carbon content of the fine earth fraction is by dry combustion to at
least (ISO 10694). Values of organic carbon content are typically reported in
(permilles) with integer precision over a range of 0–1000.
</div>

<p>The <em>dry combustion method</em> (Leco at 1000°C) is based on thermal oxidation of
both mineral carbon (IC) and organic carbon by means of a furnace.
It is a reliable method for the determination of the soil organic carbon when IC is
removed through combustion at low temperature prior to combustion at
high temperature. Dry combustion is considered to ensure oxidation of
all ORC and is considered an accurate method which has been used in many
studies as a reference method against which to calibrate other methods
<span class="citation">(Grewal, Buchan, and Sherlock <a href="#ref-Grewal1991JSS">1991</a>; Meersmans, Van Wesemael, and Van Molle <a href="#ref-Meersmans2009SUM">2009</a>; Bisutti, Hilke, and Raessler <a href="#ref-Bisutti2004TAC">2004</a>)</span>. A global estimate
of the distribution of soil organic carbon is shown in
Fig. <a href="soil-variables-chapter.html#fig:sprofs-soil-carbon">3.6</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:sprofs-soil-carbon"></span>
<img src="figures/Fig_sprofs_ORCDRC.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of soil organic carbon content in permilles. Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/). The log-transformation is used to ensure close-to-normal distribution in the histogram." width="100%" />
<p class="caption">
Figure 3.6: Histogram and soil-depth density distribution for a global compilation of measurements of soil organic carbon content in permilles. Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>). The log-transformation is used to ensure close-to-normal distribution in the histogram.
</p>
</div>

<div class="rmdnote">
Soil organic carbon content is most commonly expressed in weight
percentage and for GSIF in grams per kilogram fine earth fraction or
permilles. The standard method of determining the soil organic carbon
content is by dry combustion method (Leco at 1000°C).
</div>

<p>Total organic carbon can be determined directly or indirectly. Direct determination
consists of previous removal of any carbonates present by treating the
soil with hydrochloric acid. Indirect determination consists of applying
an empirical correction to the total carbon content to account for for
the inorganic carbonates present.</p>
<p>Examples of studies that have used dry combustion for calibrating other
methods of analyzing organic carbon include <span class="citation">Kalembasa and Jenkinson (<a href="#ref-Kalembasa1973JSFA">1973</a>; Grewal, Buchan, and Sherlock <a href="#ref-Grewal1991JSS">1991</a>; Soon and Abboud <a href="#ref-Soon1991CSSPA">1991</a>; Wang, Smethurst, and Herbed <a href="#ref-Wang1996AJSR">1996</a>; Konen et al. <a href="#ref-Konen2002SSSAJ">2002</a>; Brye and Slaton <a href="#ref-Brye2003CSSPA">2003</a>; Mikhailova, Noble, and Post <a href="#ref-Mikhailova2003CSSPA">2003</a>; Bisutti, Hilke, and Raessler <a href="#ref-Bisutti2004TAC">2004</a>; Jankauskas et al. <a href="#ref-Jankauskas2006CSSPA">2006</a>; De Vos et al. <a href="#ref-DeVos2007SUM">2007</a>)</span>
and <span class="citation">Meersmans, Van Wesemael, and Van Molle (<a href="#ref-Meersmans2009SUM">2009</a>)</span>. It is possible to produce
regression equations to permit conversion of results for organic carbon
produced by one method into equivalent values in a specified reference
method (generally dry combustion). However, local calibration
equations that reflect differences in
soils on a regional basis are usually needed. It is not possible to
provide a single universal equation suitable for use everywhere to
convert organic carbon values produced using other methods of analysis
to equivalent values in the reference method of dry combustion.</p>
</div>
<div id="soil-ph" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Soil pH</h3>
<p>PH is of interest for global soil mapping because it is one of the more
widely available and easily interpreted chemical measures of the health
and productivity of the soil. pH provides an indication of base status
of the soil which influences nutrient availability, mobility of both
beneficial and detrimental ions and the ecology of micro-organisms
within the soil. For most crops and agricultural uses, a pH in the range
of 5.5 to 7.5 is optimum (considering the agricultural productivity of
soil). Low pH is associated with acidic conditions and with increased
mobility of toxic ions such as aluminum iron and even acid sulphates.
High pH is associated with reduced availability of phosphorus and at
higher levels with alkaline conditions that impede water uptake by
plants. A global estimate of the distribution of the soil pH is shown in
Figs. <a href="soil-variables-chapter.html#fig:sprops-phiho5">3.7</a> and <a href="soil-variables-chapter.html#fig:sprops-phikcl">3.8</a>.</p>
<p>PH index approximates concentration of dissolved hydrogen ions
(H<span class="math inline">\(_3\)</span>O<span class="math inline">\(^+\)</span>) in a soil suspension. It is estimated as the negative
decimal logarithm of the hydrogen ion activity in a soil suspension. As
a single measurement, pH describes more than relative acidity or
alkalinity. It also provides information on nutrient availability, metal
dissolution chemistry, and the activity of microorganisms
<span class="citation">(Miller and Kissel <a href="#ref-Miller2010SSSAJ">2010</a>)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:sprops-phiho5"></span>
<img src="figures/Fig_sprofs_PHIHO5.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of soil pH (suspension of soil in H2O). Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/)." width="100%" />
<p class="caption">
Figure 3.7: Histogram and soil-depth density distribution for a global compilation of measurements of soil pH (suspension of soil in H2O). Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>).
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:sprops-phikcl"></span>
<img src="figures/Fig_sprofs_PHIKCL.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of soil pH (suspension of soil in KCl). Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/)." width="100%" />
<p class="caption">
Figure 3.8: Histogram and soil-depth density distribution for a global compilation of measurements of soil pH (suspension of soil in KCl). Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>).
</p>
</div>
<p>The standard reference method for reporting pH is ISO
10390:2005. This standard specifies an instrumental method for the
routine determination of pH using a glass electrode in a 1:5 (volume
fraction) suspension of soil in water (pH in H<span class="math inline">\(_2\)</span>O), in potassium
chloride solution (pH in KCl) or in calcium chloride solution (pH in
CaCl<span class="math inline">\(_2\)</span>).</p>
<p>The most common method for analyzing pH in North America is a 1:1
soil/water suspension <span class="citation">(Miller and Kissel <a href="#ref-Miller2010SSSAJ">2010</a>)</span>. Adopting ISO 10390:2005 as a
standard with its specification of pH measured in a 1:5 suspension of
soil in water requires US values to be converted from 1:1 soil/water
to 1:5 soil/water equivalent values.</p>
<div class="figure" style="text-align: center"><span id="fig:color-legend-phi"></span>
<img src="figures/Fig_color_legend_PHI.png" alt="Histogram for soil pH and connected color legend available via the GSIF package. Color breaks in the legend have been selected using histogram equalization (i.e. by using constant quantiles) to ensure maximum contrast in the output maps." width="85%" />
<p class="caption">
Figure 3.9: Histogram for soil pH and connected color legend available via the GSIF package. Color breaks in the legend have been selected using histogram equalization (i.e. by using constant quantiles) to ensure maximum contrast in the output maps.
</p>
</div>
<p>The ratio of soil to water in a suspension has a net effect of
increasing the pH with a decrease in the soil/water ratio. <span class="citation">Davis (<a href="#ref-Davis1943SS">1943</a>)</span>
has shown that decreasing the soil/water ratio from 10:1 to 1:10
resulted in an increase of 0.40 pH units. Values for pH computed using
methods with a lower ratio of soil to water (e.g. 1:1 or 1:2.5) will
generally be lower than equivalent values for pH in 1:5 water and will
need to be adjusted higher. Several authors have demonstrated that
fitting quadratic or curvilinear functions to soil pH data produces
regression equations with higher coefficients of determination that
those obtained from a linear fit <span class="citation">(Aitken and Moody <a href="#ref-Aitken1991AJSR">1991</a>; Miller and Kissel <a href="#ref-Miller2010SSSAJ">2010</a>)</span>.
For example, <span class="citation">Brennan and Bolland (<a href="#ref-Brennan1998">1998</a>)</span> have estimated that (at least in Southwestern Australia)
pH in CaCl<span class="math inline">\(_2\)</span> can be estimated from the pH 1:5 water by using a simple conversion:</p>
<pre class="sourceCode r"><code class="sourceCode r">ph_h2o =<span class="st"> </span><span class="fl">7.2</span>
<span class="fl">0.918</span><span class="op">*</span>ph_h2o<span class="fl">-0.3556</span>
<span class="co">#&gt; [1] 6.25</span></code></pre>
<p>This model fitted explains 94% of variation in the values of pH CaCl<span class="math inline">\(_2\)</span> (R-square=0.9401).</p>

<div class="rmdnote">
Soil pH is negative decimal logarithm of the hydrogen ion activity in a
soil suspension. Soil pH values are usually in the range 3–11 and are
recorded with a precision of ±0.1 pH in the range of 5.5 to 7.5 is
optimal for growing crops.
</div>

<p>Soil pH varies with season and soil moisture content, with higher pH
values associated with wetter soils and winter conditions and lower pH
values with drier soils and summer conditions <span class="citation">(Miller and Kissel <a href="#ref-Miller2010SSSAJ">2010</a>)</span>. The
effects of both temporal variation in pH and variation due to different
analytical methods means that differences in pH of less than some
specified range (e.g. ±0.3 units) may not be meaningful in the
context of predictions made using noisy legacy soils data analyzed using
a variety of different analytical methods. Consequently, it is not
necessary or beneficial to report pH with a precision greater than
±0.1 unit. Natural variation of pH in soils is over a range of 2 to
11 with a standard deviation of 1.4. Note also that pH follows
a close-to-normal distribution, although it is often argued that, locally,
it can show bimodal or even trimodal peaks
(Fig. <a href="soil-variables-chapter.html#fig:color-legend-phi">3.9</a>).</p>
</div>
<div id="soil-nutrients" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Soil nutrients</h3>
<p>Nutrients are chemical elements or substances essential for the growth
of plants. The most essential elements important for the growth of
plants are, in fact, carbon, hydrogen and oxygen. Other essential elements
can be separated into macro-nutrients (&gt;100 <span class="math inline">\(\mu\)</span>g or &gt;100 ppm) and micro-nutrients
(&lt;100 ppm), although there is no strict border between the two
<span class="citation">(Harpstead, Sauer, and Bennett <a href="#ref-harpstead2001soil">2001</a>; Hengl, Leenaars, et al. <a href="#ref-hengl2017soil">2017</a>)</span>. Some macro-nutrients of global importance for soil
management and protection are (<a href="http://en.wikipedia.org/wiki/Plant_nutrition" class="uri">http://en.wikipedia.org/wiki/Plant_nutrition</a>):</p>
<ul>
<li><p><em>Nitrogen</em> (N) — It is often considered synonymous with
soil fertility. Controls leafy growth. Occurs in soil as
nitrates (e.g. NO<span class="math inline">\(_3\)</span>, NO<span class="math inline">\(_2\)</span>).</p></li>
<li><p><em>Phosphorus</em> (P) — High phosphorus deficiency may result in the
leaves becoming denatured and showing signs of necrosis. Occurs in
the form of phosphates.</p></li>
<li><p><em>Potassium</em> (K) — Potassium deficiency may result in higher risk of
pathogens, wilting, chlorosis, brown spotting, and higher chances of
damage from frost and heat.</p></li>
<li><p><em>Sulfur</em> (S) — Symptoms of deficiency include yellowing of leaves
and stunted growth. Occurs in soil in the form of sulfate salts
(SO<span class="math inline">\(_4\)</span>).</p></li>
<li><p><em>Calcium</em> (Ca) — Calcium is involved in photosynthesis and
plant structure. Calcium deficiency results in stunting. Occurs in
the form of calcium carbonates (CaCO<span class="math inline">\(_3\)</span>).</p></li>
<li><p><em>Magnesium</em> (Mg) — Magnesium is also an important part
of chlorophyll. Magnesium deficiency can result in
interveinal chlorosis.</p></li>
</ul>

<div class="rmdnote">
Nitrogen, Phosphorus and Potassium are the three relatively mobile and
dynamic nutrients in soil that are most often lacking and hence have
been identified of primary interest for the fertilizer industry. Other
micro-nutrients of interest for global soil mapping would be: Iron (Fe),
Zinc (Zn), Manganese (Mn), Copper (Cu), Boron (B), Chlorine (Cl),
Molybdenum (Mo), Nickel (Ni) and Sodium (Na).
</div>

<p>Apart from macro- and micro-nutrients important for plant growth, there
is an increasing interest in the distribution of heavy metals in soils,
especially ones that are considered toxic or dangerous for human health.
Some common heavy metals of interest for soil management and soil
protection in developed industrial and / or developing countries are
Lead (Pb), Arsenic (As), Zinc (Zn), Cadmium (Cd), Nickel (Ni), Copper
(Cu), and Aluminium (Al)
<span class="citation">(Markus and McBratney <a href="#ref-Markus2001399">2001</a>; Reimann et al. <a href="#ref-reimann2011statistical">2011</a>; Morel et al. <a href="#ref-Morel2005202">2005</a>; Rodríguez-Lado et al. <a href="#ref-Rodriguez-Lado23082013">2013</a>; Hengl, Leenaars, et al. <a href="#ref-hengl2017soil">2017</a>)</span>.</p>
<p>Macro- and micro-nutrients and heavy metals are measured and mapped in
parts per million or <span class="math inline">\(\mu\)</span>g per kg of soil. The AfSIS project, provides a good
example of mapping macro- and micro-nutrients over a large area <span class="citation">(Hengl, Leenaars, et al. <a href="#ref-hengl2017soil">2017</a>)</span>. The
problem with mapping such chemical soil properties, however, is that they
are highly dynamic. For example, nitrogen, phosphorus, and potassium are
highly mobile nutrients. Their concentration changes from month to
month, even from day to day so that space-time models (2D-T or 3D-T)
need to be developed and the amount of analysis / storage needed can
easily escalate.</p>
</div>
</div>
<div id="physical-and-hydrological-soil-properties" class="section level2">
<h2><span class="header-section-number">3.4</span> Physical and hydrological soil properties</h2>
<div id="coarse-fragments" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Coarse fragments</h3>
<p>Soil texture is connected with soil granulometry or the composition of
the particle sizes, typically measured as volume percentages. The most
common subdivision of soil granulometry is <span class="citation">(Shirazi, Boersma, and Johnson <a href="#ref-Shirazi2001SSSAJ">2001</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Fine earth (&lt;2 m)</p>
<ol style="list-style-type: decimal">
<li><p>sand (coarser particles in the fine earth),</p></li>
<li><p>silt (medium size particles),</p></li>
<li><p>clay (fine particles &lt;2 <span class="math inline">\(\mu\)</span>m),</p></li>
</ol></li>
<li><p>Coarse fragments (&gt;2 mm)</p>
<ol style="list-style-type: decimal">
<li><p>gravel (2 mm to 8 cm)</p></li>
<li><p>stones or boulders (&gt;8 cm)</p></li>
</ol></li>
</ol>
<p>Coarse fragments occupy volume in the soil matrix, reducing water and
nutrient availability as well as influencing rooting depth and
workability. We elect to produce maps of coarse fragment content because many assessments, such as total stocks of carbon or
available water, are volumetric based and require knowledge of the
volume of non-soil materials throughout the profile. This information is required to support
calculations of the total volume of the fine earth fraction that is
available to hold water or retain organic carbon. Without some estimate
of the volume of the soil occupied by solid particles larger than 2 mm, it
would not be possible to compute volumetric estimates of stocks of soil
carbon or available moisture for fine earth soil.</p>
<p>Coarse fragments include stones as well as gravel (hard and soft
nodules) and the attribute is defined as consisting of all mineral
particles with a size exceeding 2 mm. Coarse fragment content is most
commonly expressed in volume fraction (volume percentage) of the
horizon, layer or sample considered. Laboratory analyses tend to be
applied to the fine earth fraction of the soil only and commonly omit
consideration of the coarse fragment content. Data for coarse fragment
content are generally derived from descriptive field observations on
soil layer morphology. Those descriptions generally express the content
of coarse fragments by class values or categories as for example
<em>‘frequent stones’</em> indicating an estimated volumetric content of 15–40% according to
the FAO guidelines of 1977 (similar to <em>‘many stones’</em> according to
SOTER conventions and the FAO guidelines of 2006). Because coarse
fragment content is most frequently based on generalized visual field
estimates, and is often lacking in legacy soil descriptions, it is not
reasonable to predict or present estimates of coarse fragment content
with a precision greater than 1–5%.</p>
<p>Note that the uncertainty associated with coarse fragment content,
propagated from the field observed class values, has significant impact
on estimations of the volumetric totals of attributes assessed and
mapped for the fine earth fraction (see also
section <a href="SOC-chapter.html#SOC-chapter">7</a>). Whilst a 1 meter deep
soil, with a bulk density of 1.5 tonne per cubic-metre and an organic
carbon content of 10 g per kg, contains 150 tonnes organic carbon.
A similar soil with bulk density adjusted for the
presence of <em>‘frequent stones’</em> contains 90–127.5 tonnes organic carbon. Despite the
inaccuracy of the data for field observed coarse fragments content, it is
strongly recommended to collect and compile these data as completely as
possible because of their relevance for estimating whole soil bulk
density, total volume and volume of the fine earth fraction alone.</p>
<p>The possible nature (and size) of coarse fragments is highly variable
(quartz, carbonate, iron, basalt) with consequent variable manageability and
variable characteristics such as breakability, solubility, bulk density, etc.
Where the coarse fragment content is dominant (&gt;80%), approaching 100%,
rootability is near nil which is a determinant for the rooting or
effective soil depth and generally also for depth to bedrock. An
estimated global distribution of coarse fragments and soil textures is
given in Fig. <a href="soil-variables-chapter.html#fig:sprofs-crfvol">3.10</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:sprofs-crfvol"></span>
<img src="figures/Fig_sprofs_CRFVOL.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of coarse fragments in percent. Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/). This variable in principle follows a zero inflated distribution." width="100%" />
<p class="caption">
Figure 3.10: Histogram and soil-depth density distribution for a global compilation of measurements of coarse fragments in percent. Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>). This variable in principle follows a zero inflated distribution.
</p>
</div>
</div>
<div id="particle-size-class-distribution-sand-silt-and-clay" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Particle size class distribution: sand, silt and clay</h3>
<p>The majority of global soil mapping initiatives elect to predict the
spatial distribution of particle size classes (soil texture) because
texture controls or influences many mechanical, hydrological and
engineering aspects of use of the soil. Soil texture affects how a soil
responds to engineering uses such as construction of roads, buildings,
dams and other structures, how water infiltrates into the soil and is
stored or transmitted through it, how nutrients, chemicals and dissolved
substances adhere to surfaces and are retained or transformed and how
energy and matter enter into the soil and are stored or transmitted
through it. Texture is the fundamental physical and mechanical property
of soils and, as such, it is one of the most widely analysed and
widely reported soil properties.</p>
<p>The size of particles in the soil varies greatly from less than a 2 <span class="math inline">\(\mu\)</span>m to
several cm’s and occasionally even meters (boulders). This represents a
range from to 1 <span class="math inline">\(\mu\)</span>m to 1 million <span class="math inline">\(\mu\)</span>m. Generally, particle size distribution has been
simplified through aggregation or classification. The fine earth
fraction (&lt;2 mm) is the soil considered for laboratory analyses. This fine
earth is further subdivided into particle size classes including,
depending on the guidelines or laboratory concerned, fine and coarse
clay, fine and coarse silt and very fine, fine, medium, coarse and very
coarse sand. The three major particle size classes of the fine earth
fraction though are sand, silt and clay. They are generally reported in
units of percent by weight with a precision of ±1%.</p>
<p>Soil texture represents the relative composition of sand, silt, and clay
in soil. The <em>particle-size class distribution</em> is usually represented
in a texture diagram, relating the percentages of sand, silt, and clay
(mass percentage of fine earth) to a <em>texture class</em> <span class="citation">(Minasny and McBratney <a href="#ref-Minasny2001AJSR">2001</a>)</span>.
Particle size distribution has been defined using a number of systems.
One of the most widely used systems is the USDA Soil Survey Laboratory
Methods Manual <span class="citation">(Natural Resources Conservation Service <a href="#ref-Burt2004SSIR">2004</a>)</span>. The USDA definition of particle size
classes has also been recommended by FAO for use in the Soil Map of the
World (Fig. <a href="soil-variables-chapter.html#fig:texture-limits">3.11</a>). The standard reference method adopted by
GSIF for reporting particle size classes of sand, silt and clay, is as
per the USDA Soil Survey Laboratory Methods Manual <span class="citation">(Natural Resources Conservation Service <a href="#ref-Burt2004SSIR">2004</a>, 347)</span>. An estimated global distribution of sand, silt, and clay is
given in Figs. <a href="soil-variables-chapter.html#fig:sprofs-snd">3.12</a>, <a href="soil-variables-chapter.html#fig:sprofs-slt">3.13</a> and
<a href="soil-variables-chapter.html#fig:sprofs-cly">3.14</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:texture-limits"></span>
<img src="figures/Fig_texture_limits_Minasny2001.jpg" alt="Particle size limits used in European countries, Australia and America. Image source: Minasny and McBratney (2001) doi: 10.1071/SR00065." width="100%" />
<p class="caption">
Figure 3.11: Particle size limits used in European countries, Australia and America. Image source: Minasny and McBratney (2001) doi: 10.1071/SR00065.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:sprofs-snd"></span>
<img src="figures/Fig_sprofs_SNDPPT.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of sand content in percent. Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/)." width="100%" />
<p class="caption">
Figure 3.12: Histogram and soil-depth density distribution for a global compilation of measurements of sand content in percent. Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>).
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:sprofs-slt"></span>
<img src="figures/Fig_sprofs_SLTPPT.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of silt content in percent. Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/)." width="100%" />
<p class="caption">
Figure 3.13: Histogram and soil-depth density distribution for a global compilation of measurements of silt content in percent. Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>).
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:sprofs-cly"></span>
<img src="figures/Fig_sprofs_CLYPPT.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of clay content in percent. Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/)." width="100%" />
<p class="caption">
Figure 3.14: Histogram and soil-depth density distribution for a global compilation of measurements of clay content in percent. Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>).
</p>
</div>
<p>The current standard for particle size classes adopted by FAO for use in
the Harmonized World Soil Database is ISO 10390:2005. This standard
differs from the USDA definition in defining the size range for silt as
2–63 <span class="math inline">\(\mu\)</span>m instead of 2–50 <span class="math inline">\(\mu\)</span>m and sand as 63–2000 <span class="math inline">\(\mu\)</span>m instead of
50–2000 <span class="math inline">\(\mu\)</span>m. This is a relatively
new standard for FAO which previously adopted the USDA definitions for
the digital soil map of the world <span class="citation">(Nachtergaele, Van Engelen, and Batjes <a href="#ref-Nachtergaele2010press">2010</a>)</span>. These
differences in attribute definition cause differences in values reported
for soil particle size classes. Differences in values can also arise
because of differences in method of analysis (e.g. hygrometer, pipette,
laser diffraction, dispersion etc). Most literature on harmonization of soil
texture data deals with harmonizing differences in attribute definitions
or the reported particle size classes
(Fig. <a href="soil-variables-chapter.html#fig:texture-limits">3.11</a>).</p>

<div class="rmdnote">
The most commonly used standard for designation of fine earth texture
fractions, used by the <em>GlobalSoilMap</em> project, is the USDA
system (sand: 50–2000 <span class="math inline">\(\mu\)</span>m, silt: 2–50 <span class="math inline">\(\mu\)</span>m, clay: &lt;2 <span class="math inline">\(\mu\)</span>m).
</div>

<p><span class="citation">Minasny and McBratney (<a href="#ref-Minasny2001AJSR">2001</a>)</span> identified two major textural classifications in the
world as the International and USDA/FAO systems (Tbl. <a href="soil-variables-chapter.html#tab:usdafaotexture">3.3</a>).
The significant difference between these two was the choice of a
threshold value for differentiating silt from sand of 20 <span class="math inline">\(\mu\)</span>m for the
International and 50 <span class="math inline">\(\mu\)</span>m for the USDA/FAO systems. The new ISO/FAO standard
adds an additional difference by changing the threshold value between
silt and sand from 50 <span class="math inline">\(\mu\)</span>m to 63 <span class="math inline">\(\mu\)</span>m. Another very important difference in attribute
definition concerns the Russian system which defines the clay fraction
as &lt;1 <span class="math inline">\(\mu\)</span>m and the fine earth fraction, or the upper limit of the sand
fraction, at 1 cm instead of 2 cm.</p>
<table>
<caption><span id="tab:usdafaotexture">Table 3.3: </span>Differences between the International, USDA and ISO/FAO particle size classifications.</caption>
<thead>
<tr class="header">
<th align="left">Fraction</th>
<th align="left">International</th>
<th align="left">USDA</th>
<th align="left">ISO.FAO</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">clay</td>
<td align="left">&lt;2 μm</td>
<td align="left">&lt;2 μm</td>
<td align="left">&lt;2 μm</td>
</tr>
<tr class="even">
<td align="left">silt</td>
<td align="left">2–20 μm</td>
<td align="left">2–50 μm</td>
<td align="left">2–63 μm</td>
</tr>
<tr class="odd">
<td align="left">sand</td>
<td align="left">20–2000 μm</td>
<td align="left">50–2000 μm</td>
<td align="left">63–2000 μm</td>
</tr>
</tbody>
</table>
<p>Both <span class="citation">Nemes et al. (<a href="#ref-Nemes1999G">1999</a>)</span> and <span class="citation">Minasny and McBratney (<a href="#ref-Minasny2001AJSR">2001</a>)</span> investigated options for
harmonizing values for sand, silt and clay reported using different
systems for classifying particle size fractions. Using a compilation of
four large databases consisting of a total of 1620 samples,
<span class="citation">Minasny and McBratney (<a href="#ref-Minasny2001AJSR">2001</a>)</span> developed a single multiple linear regression model for
converting between silt fraction based on the international standard of
2–20 <span class="math inline">\(\mu\)</span>m (<span class="math inline">\(P_{\mathtt{2-20}}\)</span>) to the 2–50 <span class="math inline">\(\mu\)</span>m range of the USDA standard
(<span class="math inline">\(P_{\mathtt{2-50}}\)</span>) and vice versa:</p>
<span class="math display">\[\begin{equation}
\begin{cases}
\begin{matrix} \hat P_{\mathtt{2-50}} = &amp; -18.3914 + 2.0971 \cdot P_{\mathtt{2-20}} + 0.6726 \cdot P_{\mathtt{20-2000}}   \\
   &amp; - 0.0142 \cdot P_{\mathtt{2-20}}^2  - 0.0049 \cdot P_{\mathtt{20-2000}}^2
\end{matrix}   &amp; \text{ if } \hat P_{\mathtt{2-50}} &gt; 0 \\ \begin{matrix} \hat P_{\mathtt{2-50}} = &amp; 0.8289 \cdot P_{\mathtt{2-20}} + 0.0198 \cdot P_{\mathtt{20-2000}} \end{matrix} &amp; \text{ if } \hat P_{\mathtt{2-50}} &lt; 0
\end{cases}
  (\#eq:P2_50)
\end{equation}\]</span>
<p>where <span class="math inline">\(P_{\mathtt{20-2000}}\)</span> is the international sand fraction. This
conversion is fairly accurate since the model explains most of the observed variability
in the original values (<span class="math inline">\(R^2\)</span>=0.823). Together with the conversion of
the silt fraction is the conversion of the sand fraction.</p>
<p><span class="citation">Minasny and McBratney (<a href="#ref-Minasny2001AJSR">2001</a>)</span> argued that most countries should consider adopting the
particle size limits and texture classes of the USDA system. They noted
that the 2–50 <span class="math inline">\(\mu\)</span>m particle size range is usually more useful than the 2–20 <span class="math inline">\(\mu\)</span>m range
for estimating water retention in pedo-transfer functions and observed
that translations from one system into another were relatively easy,
given improved computing power and algorithms.</p>
<p><span class="citation">Nemes, Schaap, and Leij (<a href="#ref-Nemes1999">1999</a>; Nemes et al. <a href="#ref-Nemes1999G">1999</a>)</span> evaluated four different interpolation methods
(log-linear interpolation, fitting a Gompertz curve, spline
interpolation, and similarity method) in order to achieve compatibility
of particle-size distributions within the <em>European soil hydraulic
database HYPRES</em> (<a href="http://www.macaulay.ac.uk/hypres/" class="uri">http://www.macaulay.ac.uk/hypres/</a>). They introduced a new similarity procedure, which
uses an external reference data set that contains a wide variety of
reference soil materials, each with 7 or 8 measured particle-size
fractions. The procedure involves searching for soil samples in the
external reference data set that match the particle-size distribution of
the soil to be interpolated. From each search. 10 similar soils are
selected that have fractions at the particle size limits similar to the
soil under investigation. The arithmetic mean of the fractions of these
10 soils at the specified particle size limit is calculated and assigned
as the estimate of the fraction for the soil under investigation.</p>
<p>The HYPRES reference database and the similarity procedures applied to
it are appropriate for harmonizing a wide range of soils from a variety
of countries and could be used as one of the main methods in a global
Soil Reference Library. The generic nature of this conversion approach,
and the fact that it does not rely on multiple, locally developed,
regression equations, makes it an attractive option for use in harmonization of global
particle size data.</p>
</div>
<div id="bulk-density" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Bulk density</h3>
<p>Measurement of soil Bulk Density (BLD) is often time consuming and
relatively costly. For this reason, it is not analysed and reported for
legacy soil profiles as frequently or consistently as many other, more
common, soil properties. Consequently, predicting bulk density globally
using digital soil mapping methods is fraught with difficulties and
uncertainties. However, it is critical to at least attempt to make some
kind of estimate of how bulk density varies spatially because we need to
know the bulk density of the soil in order to make any estimates of
volumetric concentrations of materials such as organic carbon, water or
nutrients.</p>
<p>In practice, we need to be able to make estimates of two different types
of bulk density, namely the bulk density of the whole soil and the <em>bulk
density of the fine earth fraction</em> (particles &lt;2 mm) only. Calculations
such as those for total stocks of carbon are first applied using the
bulk density of the fine earth fraction only but this value is then
reduced in accordance with the volume proportion of the soil that is
occupied by coarse fragments greater than 2 mm in size. Bulk density is also
of interest for global soil mapping applications because it influences
infiltration and movement of water in the soil, penetration of the soil
by plant roots and mechanical workability of the soil using farm
implements.</p>
<p>Bulk density is the over-dry mass of soil material divided by the total
volume. The standard reference method for reporting bulk density for
GSIF is the core method (ISO 11272). The dry bulk density (BD) is the
ratio between the mass of oven dry soil material and the volume of the
undisturbed fresh sample. The ISO standard defines dry bulk density as
the ratio of the oven-dry mass of the solids to the volume (the bulk
volume includes the volume of the solids and of the pore space) of the
soil. The recommended ISO method (core method) uses steel cylinders of
known volume (100 cubic cm, 400 cubic cm) that are driven into the soil vertically or
horizontally by percussion. Sampling large volumes results in smaller
relative errors but requires heavy equipment. The method cannot be used
if stones or large roots are present or when the soil is too dry or too
hard.</p>
<p>For soils with a high stone or root content or when the soil is too dry
or too hard, methods based on the excavation technique are used as an
alternative to the core method. In the excavation method a hole on a
horizontal surface is dug and then filled with a material with a known
density (e.g. sand which packs to a calibrated volume or water separated
from the soil material by an elastic membrane) to assess the volume of
the hole or the sample taken. The soil obtained from the hole, is
oven-dried to remove the water and the oven-dry mass of the total sample
is weighed. The volumetric percentage of the coarse fragments needs to
be determined and the weight of the coarse fragments assessed, in order
to be able to calculate the oven-dry bulk density of the fine earth
separately.</p>
<p>The USDA handbook for analytical procedures describes various methods
for assessing various types of bulk density. USDA soil
data report values for bulk density of the fine earth as well as of the
whole earth (including gravel), with the weight assessed oven-dry as
well as at field capacity e.g. including water. The latter method
relates the weight of moist soil to the volume of moist or oven-dry
soil. Experience has shown that organic carbon and texture or clay
content predominately influence soil bulk density, even though the
nature of the clay (mineralogy) is as important as the percentage
content of the clay. Organic carbon and texture information is often
available in soil survey reports, while bulk density is often not as
frequently reported.</p>
<p>Many attempts have therefore been made to estimate soil bulk densities
through pedo-transfer functions (PTFs) based on soil organic carbon and
texture data
<span class="citation">(Curtis and Post <a href="#ref-Curtis1964SSSAP">1964</a>; Adams <a href="#ref-Adams1973JSS">1973</a>; Alexander <a href="#ref-Alexander1980SSSAJ">1980</a>; Federer, Turcotte, and Smith <a href="#ref-Federer1993CJFR">1993</a>; Rawls <a href="#ref-Rawls1983SS">1983</a>; Manrique and Jones <a href="#ref-Manrique1991SSSAJ">1991</a>; Bernoux et al. <a href="#ref-Bernoux1998SSSAJ">1998</a>)</span>.
<span class="citation">Heuscher, Brandt, and Jardine (<a href="#ref-Heuscher2005SSSAJ">2005</a>)</span> applied a stepwise multiple regression procedure to
predict oven-dried bulk density from soil properties using the NRCS
National Soil Survey Characterization Data. The database included both
subsoil and topsoil samples. An overall regression equation for
predicting oven-dried bulk density from soil properties (<span class="math inline">\(R^2=0.45\)</span>,
<span class="math inline">\(P&lt;0.001\)</span>) was developed using almost 47,000 soil samples. Partitioning
the database by soil suborders improved regression relationships
(<span class="math inline">\(R^2=0.62\)</span>, <span class="math inline">\(P&lt;0.001\)</span>). Of the soil properties considered, the stepwise
multiple regression indicated that organic C content was the strongest
contributor to bulk density prediction. Other significant variables
included clay content, water content and to a lesser extent, silt
content, and depth.</p>

<div class="rmdnote">
Bulk density is the oven-dry mass of soil material divided by the total
volume and typically ranges from 0.7 to 1.8 t/kg<span class="math inline">\(^3\)</span>. The average bulk density of
fine earth fraction of soil is about 1.3 t/kg<span class="math inline">\(^3\)</span>; soils with a bulk density higher
than tend to restrict root growth. Different values for bulk density
typically apply for different soils with different soil genesis as
reflected by different materials and mineralogy, e.g. Histosols
(organic), Arenosols (sandy), Andosols (allophanic clay), Acrisols (low
activity clays) and Vertisols (high activity clays).
</div>

<p>Bulk density tends to be measured and reported less frequently in legacy
data bases and reports than most other commonly measured soil analytical
properties. Such values as are reported are most often based on field
measurements of in-situ bulk density using the core method. Bulk density
of the fine earth fraction alone is measured and reported even less
frequently than bulk density for the whole soil
(Fig. <a href="soil-variables-chapter.html#fig:sprofs-bld">3.15</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:sprofs-bld"></span>
<img src="figures/Fig_sprofs_BLD.png" alt="Histogram and soil-depth density distribution for a global compilation of measurements of bulk density (tonnes per cubic metre). Based on the records from WOSIS (http://www.earth-syst-sci-data.net/9/1/2017/)." width="100%" />
<p class="caption">
Figure 3.15: Histogram and soil-depth density distribution for a global compilation of measurements of bulk density (tonnes per cubic metre). Based on the records from WOSIS (<a href="http://www.earth-syst-sci-data.net/9/1/2017/" class="uri">http://www.earth-syst-sci-data.net/9/1/2017/</a>).
</p>
</div>
<p>Given that there are more values reported for the bulk density of the
whole soil than for the fine earth fraction, we propose to first
estimate the bulk density of the whole soil (using appropriate
pedo-transfer functions) and then apply corrections to estimate the bulk
density of the fine earth fraction, correcting for the effect of course
fragments. Correction involves subtracting the volume of coarse
fragments from the total volume of soil sampled for assessing bulk
density in-situ in the field and then also subtracting the (estimated)
weight of coarse fragments from the measured oven-dry weight of the
sampled soil.</p>
<p>The revised weight of the fine-earth fraction alone (minus
the weight of the coarse fragments) is divided by the adjusted volume of
the sample (reduced by the volume of coarse fragments) to obtain an
estimate of bulk density for the fine earth fraction alone. This value
of density of the fine-earth fraction alone is the one needed to compute
estimates of volumetric soil properties, such as total carbon stocks. It
is therefore the critical measure of bulk density for reporting
concentrations of soil chemical properties. Conversely, bulk density of
the whole soil, in situ, is generally of greater use and interest for
assessing hydrological behaviours and properties, such as hydraulic
conductivity and moisture holding capacity.</p>
<p><span class="citation">Tranter et al. (<a href="#ref-Tranter2007SUM">2007</a>)</span> proposed a conceptual model that incorporated a priori
knowledge for predicting soil bulk density from other, more regularly
measured, properties. The model considers soil bulk density to be a
function of soil mineral packing structures (<span class="math inline">\(\rho_m\)</span>) and soil
structure (<span class="math inline">\(\Delta \rho\)</span>). Bulk densities were also observed to increase with
depth, suggesting the influence of over-burden pressure. Residuals from
the <span class="math inline">\(\rho_m\)</span> model, referred to as <span class="math inline">\(\Delta \rho\)</span>, correlated with
organic carbon.</p>
<p><span class="citation">Torri et al. (<a href="#ref-Torri1994C">1994</a>)</span> developed a nomogram for transforming rock fragment content
from a by-mass to a by-volume basis and vice versa based on bulk density
data. This nomogram facilitates conversion of data on rock fragment
content expressed in different units. Most PTFs for predicting bulk
density, except those developed by <span class="citation">Rawls (<a href="#ref-Rawls1983SS">1983</a>)</span> and <span class="citation">Bernoux et al. (<a href="#ref-Bernoux1998SSSAJ">1998</a>)</span>,
are a function only of organic matter i.e. organic carbon content.
Although studies conducted by <span class="citation">Saini (<a href="#ref-Saini1966N">1966</a>)</span> and <span class="citation">Jeffrey (<a href="#ref-Jeffrey1970JE">1970</a>)</span> have shown
that organic matter has a dominating effect on soil bulk density and
that it can be used alone as a good predictor of soil bulk density, it
has been observed (e.g. <span class="citation">Alexander (<a href="#ref-Alexander1980SSSAJ">1980</a>)</span> and <span class="citation">Manrique and Jones (<a href="#ref-Manrique1991SSSAJ">1991</a>)</span>) that,
where organic matter is a minor component, soil texture plays a major
role in controlling bulk density .</p>
</div>
<div id="soil-organic-carbon-stock" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Soil organic carbon stock</h3>
<p>Primary soil properties such as organic carbon content, bulk density and
coarse fragments can be further used as inputs for estimation of secondary soil
properties which are typically not measured directly in the field and
need to be derived from primary soil properties. For instance, consider
estimation of the global carbon stock (in permille). This secondary soil
property can be derived from a number of primary soil properties
<span class="citation">(Nelson and Sommers <a href="#ref-Nelson1982">1982</a>; Sanderman, Hengl, and Fiske <a href="#ref-sanderman2018soil">2018</a>)</span> (see Fig. <a href="soil-variables-chapter.html#fig:ocs-calculus-scheme">3.16</a>):</p>
<span class="math display" id="eq:ocs-calc">\[\begin{equation}
    \mathtt{OCS} \; [\mathrm{kg \; m^{-2}}] = \frac{{\mathtt{ORC}}}{{1000}} \; [\mathrm{kg \; kg^{-1}}] \cdot \frac{{\mathtt{HOT}}}{{100}} \; [\mathrm{m}] \cdot \mathtt{BLD} \; [\mathrm{kg \; m^{-3}}] \cdot \frac{{100-\mathtt{CRF} \; [\mathrm{\%}]}}{{100}}
\tag{3.1}
\end{equation}\]</span>
<p>where <code>OCS</code> is soil organic carbon stock, <code>ORC</code> is soil organic carbon
mass fraction in permilles, <code>HOT</code> is horizon thickness in , <code>BLD</code> is
soil bulk density in and <code>CRF</code> is volumetric fraction of coarse
fragments (<span class="math inline">\(&gt;\)</span> 2 mm) in percent.</p>
<div class="figure" style="text-align: center"><span id="fig:ocs-calculus-scheme"></span>
<img src="figures/Fig_OCS_calculus_scheme.png" alt="Soil organic carbon stock calculus scheme. Example of how total soil organic carbon stock (OCS), and its propagated error, can be estimated for a given volume of soil using organic carbon content (ORC), bulk density (BLD), thickness of horizon (HOT), and percentage of coarse fragments (CRF). Image source: Hengl et al. (2014) doi: 10.1371/journal.pone.0169748. OCSKGM function also available via the GSIF package." width="100%" />
<p class="caption">
Figure 3.16: Soil organic carbon stock calculus scheme. Example of how total soil organic carbon stock (OCS), and its propagated error, can be estimated for a given volume of soil using organic carbon content (ORC), bulk density (BLD), thickness of horizon (HOT), and percentage of coarse fragments (CRF). Image source: Hengl et al. (2014) doi: 10.1371/journal.pone.0169748. OCSKGM function also available via the GSIF package.
</p>
</div>
<p>The propagated error of the soil organic carbon stock (Eq.<a href="soil-variables-chapter.html#eq:ocs-calc">(3.1)</a>) can
be estimated using the Taylor series method <span class="citation">(Heuvelink <a href="#ref-Heuvelink1998a">1998</a>)</span> i.e. by
using the standard deviations of the predicted soil organic carbon
content, bulk density and coarse fragments, respectively
(Fig. <a href="soil-variables-chapter.html#fig:ocs-calculus-scheme">3.16</a>). <code>OCS</code> values can be derived for
all depths / horizons, then aggregated to estimate the total stock for
the whole profile (e.g. 0–2 m).</p>
<p>The formulas to derive soil organic carbon stock and the propagated
uncertainty are implemented in the GSIF package e.g.:</p>
<pre class="sourceCode r"><code class="sourceCode r">Area &lt;-<span class="st"> </span><span class="fl">1E4</span>  ## 1 ha
HSIZE &lt;-<span class="st"> </span><span class="dv">30</span> ## 0--30 cm
ORCDRC &lt;-<span class="st"> </span><span class="dv">50</span>  ## 5%
ORCDRC.sd &lt;-<span class="st"> </span><span class="dv">10</span>  ## +/-1%
BLD &lt;-<span class="st"> </span><span class="dv">1500</span>  ## 1.5 tonnes per cubic meter
BLD.sd &lt;-<span class="st"> </span><span class="dv">100</span>  ## +/-0.1 tonnes per cubic meter
CRFVOL &lt;-<span class="st"> </span><span class="dv">10</span>  ## 10%
CRFVOL.sd &lt;-<span class="st"> </span><span class="dv">5</span>  ## +/-5%         
x &lt;-<span class="st"> </span><span class="kw">OCSKGM</span>(ORCDRC, BLD, CRFVOL, HSIZE, ORCDRC.sd, BLD.sd, CRFVOL.sd)
x  ## 20.25 +/-4.41 kg/m^2
<span class="co">#&gt; [1] 20.2</span>
<span class="co">#&gt; attr(,&quot;measurementError&quot;)</span>
<span class="co">#&gt; [1] 4.41</span>
<span class="co">#&gt; attr(,&quot;units&quot;)</span>
<span class="co">#&gt; [1] &quot;kilograms per square-meter&quot;</span>
x[[<span class="dv">1</span>]] <span class="op">*</span><span class="st"> </span>Area <span class="op">/</span><span class="st"> </span><span class="dv">1000</span> ## in tonnes per ha:
<span class="co">#&gt; [1] 202</span></code></pre>
<p>A more robust way to estimate the propagated uncertainty of deriving
<code>OCS</code> would be to use geostatistical simulations e.g. derive standard
error from a large number of realizations (e.g. &gt;100) that incorporate
spatial and vertical correlations. Because, in the case of soil mapping,
we are often dealing with massive data sets, running geostatistical
simulations for millions of pixels is current not yet a feasible option.</p>
</div>
<div id="available-water-capacity" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Available Water Capacity</h3>
<p>The available water holding capacity (AWC) is a complex soil property.
It is basically a soil or land quality <span class="citation">(Food, Agriculture Organization of the United Nations. Soil Resources, and Service <a href="#ref-food1977framework">1977</a>)</span>, that
provides valuable information about the capacity of the soil to hold
water, particularly water that is potentially available for root uptake
by plants and vegetative transpiration. In practice, AWC is land cover specific.
The water available for root uptake depends on the soil properties that
determine rootability or rooting depth as genetically required by the
vegetative land cover.</p>
<p>The water available for root uptake also depends on the pressure head
that the vegetative land cover can generate or bridge between the
pressure in the atmosphere and the pressure in the soil matrix. E.g.
cotton can still extract water at -2500 kPa (pF 4.4) while pepper wilts at -350 kPa (pF
3.5). The ability of a soil to accept and store water has implications
beyond simply the capacity to support plant growth. It also affects how
a soil responds to hydrological events such as rainfall, snowmelt and
runoff. Soils that can rapidly absorb and retain significant amounts of
rainfall act as a buffer reducing rapid runoff and flooding. Soils that
have a limited ability to accept and store rainfall contribute to rapid
runoff with increased chances of erosion and flooding. Models of crop
growth, runoff, erosion and flooding all have requirements for
location-specific information about available water capacity.</p>
<p>The AWC is expressed in mm (which equals mm water/cm soil depth, or
water/ soil). This volume of water depends on the volume of soil
(influenced by depth interval and by volumetric gravel content) and the
volumetric fraction of water that is contained by the soil between field
capacity and wilting point. GSIF reports AWC with a precision of 1 mm
and a maximum range of 0–2000 mm.</p>
<p>Values for AWC are preferably assessed for the fine earth fraction per
depth interval and expressed as volumetric fraction. This value can be
corrected for the gravel content of the depth interval and summed up
over the interval. Preferably, the values for volumetric AWC of the fine
earth fraction per depth interval are derived from values for water
content at specific water tensions (e.g. at pF 0.1, 2, 2.5, 3, 4.2,
4.5). For pragmatic reasons though the permanent wilting point is set at
-1500 kPa (or 15,000cm, 15 bar, 15 atmosphere or pF 4.2).</p>
<p>The standard reference method adopted by GSIF for reporting available
water capacity is as per the USDA Soil Survey Laboratory Methods Manual
<span class="citation">(Natural Resources Conservation Service <a href="#ref-Burt2004SSIR">2004</a>, 137)</span>. Calculation of the <em>Water Retention Difference</em>
(WRD) is considered the initial step in the approximation of the
available water capacity (AWC). WRD is a calculated value that denotes
the volume fraction for water in the whole soil that is retained between -1500 kPa suction and an upper limit of usually -33 or -10 kPa suction (pF 2.5 or pF 2)
<span class="citation">(Natural Resources Conservation Service <a href="#ref-Burt2004SSIR">2004</a>, 137)</span>. The upper limit (lower suction) is selected so
that the volume of water retained approximates the volume of water held
at field capacity. The -33 and -1500 kPa gravimetric water contents are then
converted to a whole soil volume basis by multiplying by the oven dry
bulk density of the fine earth fraction (<code>Db33</code>) and adjusting downward
for the volume fraction of rock fragments, if present, in the soil.</p>

<div class="rmdnote">
Available water capacity (expressed in mm of water for the effective
soil depth) can be estimated based on the Water Retention Difference
(WRD) which denotes the volume fraction for water in the whole soil,
including gravel, that is retained between -1500 kPa suction and an upper limit of 33 kPa suction.
</div>

<p><em>“The development of hydraulic PTFs has become a boom industry, mostly
in the US and Europe”</em> <span class="citation">(Minasny <a href="#ref-Minasny2007JITL">2007</a>)</span>. Results of such research have
been reported widely, including in the USA <span class="citation">(Rawls, Gish, and Brakensiek <a href="#ref-Rawls1991AA">1991</a>)</span>, UK, the
Netherlands <span class="citation">(Wösten, Fi, and Jansen <a href="#ref-Wosten1995G">1995</a>)</span>, and Germany. Research has attempted to
correlate particle size distribution, bulk density and organic matter
content with water content at field capacity (FC, <span class="math inline">\(\theta\)</span> at -33 kPa),
permanent wilting point (PWP, <span class="math inline">\(\theta\)</span> at -1500 kPa), and available water content
(AWC = FC - PWP) <span class="citation">(Minasny <a href="#ref-Minasny2007JITL">2007</a>)</span>. <span class="citation">Gijsman, Thornton, and Hoogenboom (<a href="#ref-Gijsman2007CEA">2007</a>)</span> reported that
<em>“many PTFs for estimating soil hydraulic properties have been published
already”</em> (see overviews by <span class="citation">Rawls, Gish, and Brakensiek (<a href="#ref-Rawls1991AA">1991</a>)</span>, <span class="citation">Timlin et al. (<a href="#ref-Timlin1996AS">1996</a>)</span> and
<span class="citation">Wösten, Pachepsky, and Rawls (<a href="#ref-Wosten2001JH">2001</a>)</span>). <span class="citation">Timlin et al. (<a href="#ref-Timlin1996AS">1996</a>)</span> reported 49 methods and estimated that
this covers only about 30% of the total. <span class="citation">Gijsman, Thornton, and Hoogenboom (<a href="#ref-Gijsman2007CEA">2007</a>)</span> compared eight
methods for all the soil classes that make up the texture triangle. They
went through the triangle in steps of sand, silt and clay and determined
the estimated values of wilting point or lower limit of <em>plant
extractable water</em> (LL), <em>field capacity</em> or the drained upper limit
(DUL), and soil saturation (SAT). They finally concluded that none of
the methods were universally good. The best method in the comparison of
<span class="citation">Gijsman, Thornton, and Hoogenboom (<a href="#ref-Gijsman2007CEA">2007</a>)</span> was <span class="citation">Saxton et al. (<a href="#ref-Saxton1986SSSAJ">1986</a>)</span>, closely followed by
<span class="citation">Rawls and Brakensiek (<a href="#ref-Rawls1982JIDDASCE">1982</a>)</span>.</p>
<p>Alterra institute in collaboration with ISRIC validated the PTF
developed by <span class="citation">Hodnett and Tomasella (<a href="#ref-hodnett2002marked">2002</a>)</span> on the basis of the data present in
the Africa Soil Profiles database <span class="citation">(Leenaars <a href="#ref-Leenaars2012">2014</a>)</span> to predict tension
specific volumetric water content <span class="citation">(Wösten et al. <a href="#ref-wosten2013soil">2013</a>)</span> to assess WRD.
<span class="citation">Jagtap et al. (<a href="#ref-Jagtap2004TASAE">2004</a>)</span> developed an approach that does not fit a mathematical
equation through the data, but rather compares the soil layer for which
the key soil water contents of lower limit (LL), drained upper limit
(DUL), and soil saturation (SAT), have to be estimated with all layers
in a database of field-measured soil-water-retention data. The layer
that is most similar in texture and organic carbon concentration is
considered to be the <em>‘nearest neighbor’</em> among all the layers in the
database and its soil-water-retention values are assumed to be similar
to those that need to be estimated. To avoid making estimated
soil-water-retention values dependent on only one soil in the database,
the six <em>‘nearest neighbors’</em> are used and weighted according to their
degree of similarity <span class="citation">(Jagtap et al. <a href="#ref-Jagtap2004TASAE">2004</a>)</span>. This is a non-parametric
procedure, in the sense that it does not assume a fixed mathematical
relationship between the physical properties and the water holding
properties of soils. The similarity method to convert soil particle size
fraction data proposed by <span class="citation">Nemes et al. (<a href="#ref-Nemes1999G">1999</a>; Nemes, Schaap, and Leij <a href="#ref-Nemes1999">1999</a>)</span> is a direct analogue
of this similarity method of <span class="citation">Jagtap et al. (<a href="#ref-Jagtap2004TASAE">2004</a>)</span> for soil hydraulic
properties.</p>
<p><span class="citation">Zacharias and Wessolek (<a href="#ref-Zacharias2007SSSAJ">2007</a>)</span> identified three different approaches for deriving
the WRD from more easily available parameters as:</p>
<ol style="list-style-type: decimal">
<li><p><em>Point-based estimation methods</em>: estimating the water content of
selected matric potentials from predictors such as the percentage of
sand, silt, or clay, the amount of organic matter, or the bulk
density (e.g. <span class="citation">Rawls and Brakensiek (<a href="#ref-Rawls1982JIDDASCE">1982</a>)</span>).</p></li>
<li><p><em>Semi-physical approach</em>: deriving the WRD from information on the
cumulative particle size distribution <span class="citation">(Arya and Paris <a href="#ref-Arya1981SSSAJ">1981</a>)</span>;
theoretically, this approach is based on the similarity between
cumulative particle size distribution and water retention curves.
The water contents are derived from the soil’s predicted pore volume
and the hydraulic potentials are derived from
capillarity relationships.</p></li>
<li><p><em>Parameter estimation methods</em>: using multiple regression to derive
the parameters of an analytical closed-form equation for describing
the WRD, using predictors such as the percentage of sand, silt, and
clay, the amount of organic matter, or the bulk density (e.g.
<span class="citation">Van Genuchten (<a href="#ref-van1980closed">1980</a>; Wösten et al. <a href="#ref-Wosten1999G">1999</a>, <a href="#ref-wosten2013soil">2013</a>)</span>).</p></li>
</ol>
<p><span class="citation">Zacharias and Wessolek (<a href="#ref-Zacharias2007SSSAJ">2007</a>)</span> concluded that approach (1) has the disadvantage
that it uses a large number of regression parameters depending on the
number of WRD sampling points, which makes its use in the mathematical
modeling more difficult; while for approach 2 very detailed information
about the particle size distribution is required. They therefore
preferred use of (3) the parameter estimation methods.</p>
<p><span class="citation">Zacharias and Wessolek (<a href="#ref-Zacharias2007SSSAJ">2007</a>)</span> also observed that pedo-transfer functions that do
not consider soil organic matter are rare and gave the following
examples. <span class="citation">Hall et al. (<a href="#ref-Hall1977">1977</a>)</span> developed point-based regression equations using
soil texture and bulk density (only for subsoils) for British soils.
<span class="citation">Oosterveld and Chang (<a href="#ref-Oosterveld1980CAE">1980</a>)</span> developed an exponential regression equation for
Canadian soils for fitting the relationship between clay and sand
content, depth of soil, and moisture content. Equations to estimate the
WRC from mean particle diameter and bulk density have been proposed by
<span class="citation">Campbell and Shiozawa (<a href="#ref-Campbell1989">1989</a>)</span>. <span class="citation">Williams, Ross, and Bristow (<a href="#ref-Williams1992">1992</a>)</span> analyzed Australian data sets and developed
regression equations for the relationship between soil moisture and soil
texture, structure information, and bulk density including variants for
both the case where there is available information on soil organic
matter and where the soil organic matter is unknown. <span class="citation">Rawls and Brakensiek (<a href="#ref-Rawls1989">1989</a>)</span> reported
regression equations to estimate soil water retention as a function of
soil texture and bulk density. <span class="citation">Canarache (<a href="#ref-Canarache1993ST">1993</a>)</span> developed point based
regression equations using clay content and bulk density for Romanian
soils. More recently, <span class="citation">Nemes, Schaap, and Wösten (<a href="#ref-Nemes2003SSSAJ">2003</a>)</span> developed different PTFs derived
from different scales of soil data (Hungary, Europe, and international
data) using artificial neural network modeling including a PTF that uses
soil texture and bulk density only.</p>
<p><span class="citation">Zacharias and Wessolek (<a href="#ref-Zacharias2007SSSAJ">2007</a>)</span> developed two different regression equations
depending upon the percentage of sand in a soil as follows:</p>
<span class="math display" id="eq:thetas">\[\begin{equation}
\begin{cases}
 \begin{matrix}
 \theta_r  = 0 \\
 \theta_s  = 0.788 + 0.001 \cdot {\mathtt{clay}} -0.263 \cdot D_b \\
 \ln(\alpha) = -0.648 + 0.023 \cdot {\mathtt{sand}} + 0.044 \cdot {\mathtt{clay}} -3.168 \cdot D_b \\
 n = 1.392- 0.418\cdot {\mathtt{sand}}^{-0.024} + 1.212\cdot {\mathtt{clay}}^{-0.704}
\end{matrix} &amp; \text{ if } {\mathtt{sand}} &lt; 66.5\% \\ \hline \begin{matrix}
 \theta_r  = 0 \\
 \theta_s  = 0.890 + 0.001 \cdot {\mathtt{clay}} -0.332 \cdot D_b \\
 \ln(\alpha) = -4.197 + 0.013 \cdot {\mathtt{sand}} + 0.076 \cdot {\mathtt{clay}} -0.276 \cdot D_b \\
 n = 2.562 - 7 \cdot 10^{-9} \cdot {\mathtt{sand}} + 3.750\cdot {\mathtt{clay}}^{-0.016}
\end{matrix} &amp; \text{ if } {\mathtt{sand}} &gt; 66.5\%
\end{cases}
\tag{3.2}
\end{equation}\]</span>
<p>The regression coefficients from these models were almost identical to
those reported by <span class="citation">Vereecken, Maes, and Feyen (<a href="#ref-Vereecken1989SS">1989</a>)</span> (i.e.
<span class="math inline">\(\theta_s = 0.81 + 0.001 \cdot {\mathtt{clay}} - 0.283 \cdot D_b\)</span>) for
a different data set, adding further credibility to their general
applicability. <span class="citation">Zacharias and Wessolek (<a href="#ref-Zacharias2007SSSAJ">2007</a>)</span> recommended using the PTFs of
<span class="citation">Vereecken, Maes, and Feyen (<a href="#ref-Vereecken1989SS">1989</a>)</span> if data on soil organic matter were available but felt
that their proposed equations were suitable for use where soil organic
matter data were not available.</p>
<p>Empirical equations developed by <span class="citation">Williams, Ross, and Bristow (<a href="#ref-Williams1992">1992</a>)</span> for the prediction of the
constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> in the Campbell function have been widely used in
Australia and elsewhere. These regression equations require particle
size distribution, field texture and bulk density inputs as follows:</p>
<span class="math display">\[\begin{equation}
\begin{split}   
A =&amp; 1.996 + 0.136 \cdot \ln({\mathtt{clay}}) - 0.00007 \cdot {\mathtt{fsand}} + \\
  &amp; + 0.145\cdot \ln({\mathtt{silt}}) + 0.382 \cdot \ln({\mathtt{TEXMHT}})
\end{split}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
B = -0.192 + 0.0946\cdot \ln({\mathtt{TEXMHT}}) - 0.00151\cdot \mathtt{fsand}
\end{equation}\]</span>
<p>where <span class="math inline">\(\mathtt{clay}\)</span> (&lt;0.002 mm), <span class="math inline">\(\mathtt{fsilt}\)</span> (0.02–0.20 mm), and
<span class="math inline">\(\mathtt{sand}\)</span> (0.002–0.02 mm) are expressed in %; <span class="math inline">\(\mathtt{TEXMHT}\)</span> is
texture group from 1–6 as defined by Northcote in <span class="citation">Peverill, Sparrow, and Reuter (<a href="#ref-peverill1999soil">1999</a>)</span>.</p>
<p><span class="citation">Cresswell et al. (<a href="#ref-Cresswell2006SUM">2006</a>)</span> demonstrated applicability of the <span class="citation">Williams, Ross, and Bristow (<a href="#ref-Williams1992">1992</a>)</span> method
for French soils and confirmed that the approach of assuming a Campbell
SWC model and empirically predicting the slope and air entry potential
has merit. They concluded that the empirical regression equations of
Campbell appeared transferable to different data sets from very
different geographical locations. They provided regression equations for
all samples and stratified by horizon type that had R-square values ranging
from 0.81 to 0.91.</p>
<p><span class="citation">Cresswell et al. (<a href="#ref-Cresswell2006SUM">2006</a>)</span> further suggested a strategy for achieving adequate
coverage of soil hydraulic property data for France that included an
efficient sampling strategy based on the use of functional horizons
<span class="citation">(Bouma <a href="#ref-Bouma1989S">1989</a>)</span>, and a series of reference sites where soil hydraulic
properties could be measured comprehensively. They argued that the
functional horizon method recognizes the soil texture class of the
horizon rather than the profile as the individual or building block for
prediction <span class="citation">(Wösten, Bouma, and Stoffelsen <a href="#ref-Wosten1985SSSAJ">1985</a>; Wösten and Bouma <a href="#ref-Wosten1992">1992</a>)</span>. A significant feature of
this approach is the capacity to create a complex range of different
hydrologic soil classes from simple combinations of horizon type,
sequence, and thickness.</p>
<p>Pedo-transfer functions for available water capacity typically have a
general form of:</p>
<span class="math display">\[\begin{equation}
{\mathtt{AWAIMM}} = f ({\rm organic} \; {\rm carbon}, {\rm sand}, {\rm silt}, {\rm clay},  {\rm bulk} \; {\rm density})
\end{equation}\]</span>
<p>where the total profile available water (<span class="math inline">\(\mathtt{AWAIMM}\)</span>) can be
summed over the effective depth.</p>
<p>By using the GSIF package, one can estimate <span class="math inline">\(\mathtt{AWAIMM}\)</span> using the
pedo-transfer function described by <span class="citation">Hodnett and Tomasella (<a href="#ref-hodnett2002marked">2002</a>)</span> and
<span class="citation">Wösten et al. (<a href="#ref-wosten2013soil">2013</a>)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">SNDPPT =<span class="st"> </span><span class="dv">30</span> 
SLTPPT =<span class="st"> </span><span class="dv">25</span> 
CLYPPT =<span class="st"> </span><span class="dv">48</span> 
ORCDRC =<span class="st"> </span><span class="dv">23</span> 
BLD =<span class="st"> </span><span class="dv">1200</span> 
CEC =<span class="st"> </span><span class="dv">12</span> 
PHIHOX =<span class="st"> </span><span class="fl">6.4</span>
x &lt;-<span class="st"> </span><span class="kw">AWCPTF</span>(SNDPPT, SLTPPT, CLYPPT, ORCDRC, BLD, CEC, PHIHOX)
<span class="kw">str</span>(x)
<span class="co">#&gt; &#39;data.frame&#39;:    1 obs. of  5 variables:</span>
<span class="co">#&gt;  $ AWCh1: num 0.16</span>
<span class="co">#&gt;  $ AWCh2: num 0.122</span>
<span class="co">#&gt;  $ AWCh3: num 0.0999</span>
<span class="co">#&gt;  $ WWP  : num 0.259</span>
<span class="co">#&gt;  $ tetaS: num 0.511</span>
<span class="co">#&gt;  - attr(*, &quot;coef&quot;)=List of 4</span>
<span class="co">#&gt;   ..$ lnAlfa: num  -2.29 0 -3.53 0 2.44 ...</span>
<span class="co">#&gt;   ..$ lnN   : num  62.986 0 0 -0.833 -0.529 ...</span>
<span class="co">#&gt;   ..$ tetaS : num  81.799 0 0 0.099 0 ...</span>
<span class="co">#&gt;   ..$ tetaR : num  22.733 -0.164 0 0 0 ...</span>
<span class="co">#&gt;  - attr(*, &quot;PTF.names&quot;)=List of 1</span>
<span class="co">#&gt;   ..$ variable: chr  &quot;ai1&quot; &quot;sand&quot; &quot;silt&quot; &quot;clay&quot; ...</span>
<span class="kw">attr</span>(x, <span class="st">&quot;coef&quot;</span>)
<span class="co">#&gt; $lnAlfa</span>
<span class="co">#&gt;  [1]  -2.294   0.000  -3.526   0.000   2.440   0.000  -0.076 -11.331</span>
<span class="co">#&gt;  [9]   0.019   0.000   0.000   0.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lnN</span>
<span class="co">#&gt;  [1] 62.986  0.000  0.000 -0.833 -0.529  0.000  0.000  0.593  0.000  0.007</span>
<span class="co">#&gt; [11] -0.014  0.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tetaS</span>
<span class="co">#&gt;  [1]  81.7990   0.0000   0.0000   0.0990   0.0000 -31.4200   0.0180</span>
<span class="co">#&gt;  [8]   0.4510   0.0000   0.0000   0.0000  -0.0005</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tetaR</span>
<span class="co">#&gt;  [1] 22.7330 -0.1640  0.0000  0.0000  0.0000  0.0000  0.2350 -0.8310</span>
<span class="co">#&gt;  [9]  0.0000  0.0018  0.0000  0.0026</span></code></pre>
<p>where <code>SNDPPT</code>, <code>SLTPPT</code> and <code>CLYPPT</code> are the measured sand, silt and
clay content in percent, <code>ORCDRC</code> is the soil organic carbon
concentration in permille or , <code>BLD</code> is the bulk density in , <code>CEC</code> is
the Cation Exchange Capacity in , and <code>PHIHOX</code> is the soil pH in water
suspension. The output <code>AWCh1</code>, <code>AWCh2</code>, <code>AWCh3</code> are the available soil
water capacity (volumetric fraction) for pF 2.0, 2.3 and 2.5, <code>WWP</code> is
the soil water capacity (volumetric fraction) until wilting point, and
<code>tetaS</code> is the saturated water content, respectively.</p>
</div>
</div>
<div id="harmonisation-of-soil-data-and-pedo-transfer-functions" class="section level2">
<h2><span class="header-section-number">3.5</span> Harmonisation of soil data and pedo-transfer functions</h2>
<div id="basic-concepts-of-harmonisation-of-soil-property-values" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Basic concepts of harmonisation of soil property values</h3>
<p>A well known issue with legacy soils data is the use of different
methods for analyzing soils in the laboratory or describing them in the
field. These different methods yield different values that are not
exactly equivalent or comparable. This creates a need to assess the
significance of the differences in values arising from different methods
or method-groups, and possibly the need to harmonize values produced
using different methods in order to make them roughly equivalent and
comparable. The process of conversion of values measured according to an
original method to values roughly equivalent to those measured according
to an agreed-upon standard reference method is referred to as <em>data
harmonization</em>.</p>
<p>Note that differences in methods are not necessarily reflected in
different values for a given attribute. The value reported is
fundamentally related to the particular method used for analysis, which
we correctly or incorrectly label similarly regardless of the analytical
method used.</p>
<p>When using legacy soils data for global soil mapping and analysis
projects, it is important to first decide whether it is necessary and
important to convert measurements made using various different
laboratory methods into equivalent values in the specified standard
reference method. This assessment can be
made for each soil property individually. Decisions as to whether
harmonization is necessary may be influenced by the resolution of the
mapping and the desired precision and accuracy of the output
predictions.</p>
<p>The process of conversion of values measured by an original method to
values roughly equivalent to those measured by an agreed-upon standard
reference method is referred to as data harmonization. Examples of
harmonisation would be converting values assessed by e.g. pH in 1:2
water to values as if assessed by pH in 1:5 water, or organic carbon by
<em>Walkley-Black</em> into organic carbon by <em>dry combustion</em>.</p>
</div>
<div id="example-of-harmonization-using-texture-by-hand-classes" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Example of harmonization using texture-by-hand classes</h3>
<p>Harmonization of values reported for sand, silt and clay computed using
methods of textural analysis that use definitions for particle size
fractions different from the reference method will also have to be
converted to the standard particle size definitions adopted for some
international specifications. For example, classes in the texture
triangle represent fractions for sand, silt and clay which can be
assessed using the gravity point for the class (Tbl. <a href="soil-variables-chapter.html#tab:usdatexturec">3.4</a>; see also further Fig. <a href="soil-variables-chapter.html#fig:plot-tt-triangle">3.20</a>).</p>
<table>
<caption><span id="tab:usdatexturec">Table 3.4: </span>Simple conversion of the USDA texture-by-hand classes to texture fractions (sd indicates estimated standard deviation).</caption>
<thead>
<tr class="header">
<th align="right">Number</th>
<th align="left">Texture.class</th>
<th align="right">Sand</th>
<th align="right">Silt</th>
<th align="right">Clay</th>
<th align="right">Sand_sd</th>
<th align="right">Silt_sd</th>
<th align="right">Clay_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">clay (C)</td>
<td align="right">22</td>
<td align="right">22</td>
<td align="right">56</td>
<td align="right">11.8</td>
<td align="right">9.8</td>
<td align="right">11.1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">clay loam (CL)</td>
<td align="right">32</td>
<td align="right">34</td>
<td align="right">33</td>
<td align="right">7.0</td>
<td align="right">7.7</td>
<td align="right">3.5</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">loam (L)</td>
<td align="right">41</td>
<td align="right">39</td>
<td align="right">20</td>
<td align="right">6.8</td>
<td align="right">6.0</td>
<td align="right">5.1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">loamy sand (LS)</td>
<td align="right">83</td>
<td align="right">11</td>
<td align="right">7</td>
<td align="right">3.8</td>
<td align="right">5.8</td>
<td align="right">3.2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">sand (S)</td>
<td align="right">92</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">3.0</td>
<td align="right">3.0</td>
<td align="right">2.2</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">sandy clay (SC)</td>
<td align="right">51</td>
<td align="right">9</td>
<td align="right">40</td>
<td align="right">4.3</td>
<td align="right">4.4</td>
<td align="right">3.9</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">sandy clay loam (SCL)</td>
<td align="right">60</td>
<td align="right">14</td>
<td align="right">26</td>
<td align="right">7.9</td>
<td align="right">7.3</td>
<td align="right">4.2</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">silt (Si)</td>
<td align="right">7</td>
<td align="right">85</td>
<td align="right">9</td>
<td align="right">3.9</td>
<td align="right">3.2</td>
<td align="right">3.1</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">silty clay (SiC)</td>
<td align="right">7</td>
<td align="right">47</td>
<td align="right">46</td>
<td align="right">4.5</td>
<td align="right">4.7</td>
<td align="right">4.4</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">silty clay loam (SiCL)</td>
<td align="right">9</td>
<td align="right">58</td>
<td align="right">33</td>
<td align="right">5.7</td>
<td align="right">6.8</td>
<td align="right">3.5</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">silty loam (SiL)</td>
<td align="right">18</td>
<td align="right">64</td>
<td align="right">18</td>
<td align="right">10.9</td>
<td align="right">8.8</td>
<td align="right">6.5</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">sandy loam (SL)</td>
<td align="right">67</td>
<td align="right">22</td>
<td align="right">12</td>
<td align="right">8.5</td>
<td align="right">10.2</td>
<td align="right">4.7</td>
</tr>
</tbody>
</table>
<p>Neither the <em>GlobalSoilMap</em> project nor GSIF has yet identified and
selected specific functions to use to harmonize data produced using
different analytical methods for any of the soil properties that are to
be predicted and mapped. It is possible that a single
globally-applicable default harmonisation function could potentially be
identified for each of the methods of analysis for each of the soil
properties selected for global analysis. However, this would require the
current multitude of method definitions to be unambiguously defined and
uniquely identified (IDx), and possibly grouped into aggregate classes,
for subsequent conversion from IDx to IDy.</p>

<div class="rmdnote">
Soil observations, such as observation of texture by hand class, are
often inexpensive, but rely on good expert knowledge skills. Statistical frameworks are needed that can use both highly precise and quick-and-inaccurate observations to generate better soil maps.
</div>

<p>We have previously noted that locally-specific harmonisation functions
have consistently proven to be more effective than global ones and there
is widespread agreement that there is generally no universal equation
for converting from one method to another in all instances
<span class="citation">(Konen et al. <a href="#ref-Konen2002SSSAJ">2002</a>; Meersmans, Van Wesemael, and Van Molle <a href="#ref-Meersmans2009SUM">2009</a>; Jankauskas et al. <a href="#ref-Jankauskas2006CSSPA">2006</a>; Jolivet, Arrouays, and Bernoux <a href="#ref-Jolivet1998CSSPA">1998</a>; De Vos et al. <a href="#ref-DeVos2007SUM">2007</a>)</span>.
Consequently, there will likely be a need to develop locally relevant
harmonisation functions at the continental or regional level that apply
to restricted soil-landscape domains.</p>
<p><span class="citation">McBratney et al. (<a href="#ref-McBratney2002Geoderma">2002</a>)</span> proposed the concept of a <em>soil inference system</em>
(SINFERS) that incorporated both expert soil knowledge and statistical
prediction equations. The proposed system was intended to implement two
major functions, namely:</p>
<ol style="list-style-type: decimal">
<li><p>Predict all soil properties using all possible (known) combinations
of inputs and harmonisation functions.</p></li>
<li><p>Select the combination that leads to a prediction with the
minimum variance.</p></li>
</ol>
</div>
</div>
<div id="soil-class-data" class="section level2">
<h2><span class="header-section-number">3.6</span> Soil class data</h2>
<div id="soil-types" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Soil types</h3>
<p>Soil types or soil classes are categories of soil bodies with similar
soil properties and/or genesis and functions. There are three main
approaches to soil classification <span class="citation">(Eswaran et al. <a href="#ref-eswaran2010soil">2010</a>; Buol et al. <a href="#ref-buol2011soil">2011</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li><p><em>Classification of soils for the purpose of engineering</em> — Here the
focus is put on predicting soil engineering properties and
behaviors i.e. on physical and hydrological soil properties.</p></li>
<li><p><em>Descriptive classification of soil for the purpose of explaining
the soil genesis</em> — Here the focus is put on soil morphology and
pedogenesis i.e. functioning of the soil as part of an ecosystem.
The representative soil types derived through morphological
classification are often visualized as soil profiles or by using
soil-depth functions.</p></li>
<li><p><em>Numerical or statistical classification of soils</em> — This is purely
data-driven soil classification which can result in significant
groupings of soil properties, but that then do not have any
cognitive name and are difficult to visualize.</p></li>
</ol>
<p>Soil classification or soil taxonomy supports the transfer of soil
information from one place, or individual, to another. Classifying soils
can also often be very cost effective — if we identify the soil class
correctly it is highly likely that we will be able to predict multiple
additional soil properties that co-vary by soil type that would
otherwise require significant resources to measure in the lab.</p>
<p>There are two major international soil taxonomic systems of primary
interest for globla soil mapping: The USDA’s <em>Soil Taxonomy</em>
<span class="citation">(U.S. Department of Agriculture <a href="#ref-agriculture2010keys">2014</a>)</span>, and the FAO’s <em>World Reference Base</em>
<span class="citation">(IUSS Working Group WRB <a href="#ref-FAO2006WRB">2006</a>)</span>. Both KST and WRB are hierarchial, key-based morphological
classification systems, but with increasingly more analytical data
required to reach a specific, more refined, class. Mapping soil types,
using WRB or KST or both, has been of interest for global soil mapping
projects since the first development of the global classification
systems. As a matter of interest, the term <em>“World soil map”</em> has been
used exclusively for cartographic presentation of the global
distribution of KST soil orders (12) and/or FAO WRB soil groups (32).</p>

<div class="rmdnote">
USDA’s Soil Taxonomy is probably the most developed soil classification system in the world. Using it for producing soil data is highly recommended also because all documents, databases and guidelines are publicly available.
</div>

<div class="figure" style="text-align: center"><span id="fig:worldmap-suborders"></span>
<img src="figures/Fig_worldmap_suborders.png" alt="The USDA-NRCS map of the Keys to Soil Taxonomy soil suborders of the world at 20 km. The map shows the distribution of 12 soil orders. The original map contains assumed distributions also for suborders e.g. Histels, Udolls, Calcids, and similar. Projected in the Robinson projection commonly used to display world maps." width="100%" />
<p class="caption">
Figure 3.17: The USDA-NRCS map of the Keys to Soil Taxonomy soil suborders of the world at 20 km. The map shows the distribution of 12 soil orders. The original map contains assumed distributions also for suborders e.g. Histels, Udolls, Calcids, and similar. Projected in the Robinson projection commonly used to display world maps.
</p>
</div>

<div class="figure" style="text-align: center"><span id="fig:barplot-suborders"></span>
<img src="figures/Fig_barplot_suborders.png" alt="Distribution of the USDA suborders shown in Fig. 3.17." width="100%" />
<p class="caption">
Figure 3.18: Distribution of the USDA suborders shown in Fig. <a href="soil-variables-chapter.html#fig:worldmap-suborders">3.17</a>.
</p>
</div>
<p>Soil types can be mapped from field observations using statistically
robust methods such as multinomial logistic regression
as implemented in the nnet package for R <span class="citation">(Venables and Ripley <a href="#ref-Venables2002Springer">2002</a>)</span>.
Theoretically, given a sufficient number
and an adequate spatial distribution of field observed classes,
multinomial logistic regression could even be used to map soil taxa at
lower taxonomic levels with hundreds of unique taxonomic entities.</p>
<div class="figure" style="text-align: center"><span id="fig:usda-categories"></span>
<img src="figures/Fig_USDA_categories.png" alt="USDA classification system and approximate minimum required number of observations to fit a global multinomial regression model." width="60%" angle=0 />
<p class="caption">
Figure 3.19: USDA classification system and approximate minimum required number of observations to fit a global multinomial regression model.
</p>
</div>
<p>The map in Fig. <a href="soil-variables-chapter.html#fig:worldmap-suborders">3.17</a> shows the global
distribution of Soil Taxonomy soil suborders according to
<a href="https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/use/worldsoils/?cid=nrcs142p2_054010">USDA-NRCS World Soil Index</a>.
Assuming a rule of thumb that we need at least 5 and, if
possible, 10 observations of a specific soil taxonomic entity per unique
combination of predictor variables and observations,
<span class="citation">(Harrell <a href="#ref-harrell2001regression">2001</a>)</span>, it is possible to estimate that the optimum number of
field observations required to e.g. predict the global distribution of
USDA soil series would be in the order of few millions of soil profiles
(Fig. <a href="soil-variables-chapter.html#fig:usda-categories">3.19</a>).</p>
</div>
<div id="other-factor-type-variables" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Other factor-type variables</h3>
<p>Pedometric / geostatistical methods can be used not only to predict the
spatial distribution of soil types but also any other categorical soil
variables. There are many soil categorical variables for which maps
would be extremely useful for soil management and modelling. We list
here some of the most well known / most widely used soil categorical
variables:</p>
<ul>
<li><p><em>Diagnostic soil horizons</em> — Diagnostic soil horizons (e.g. Mollic
or Gypsic horizon in the WRB system) are soil layers with specific
soil properties commonly developed as a result of soil
formation processes. They are much easier to detect in the field
than soil types but are rarely mapped over entire areas. Diagnostic
soil horizons can theoretically be mapped as 3D soil polygons or
probabilities (rasters) attached to specific depths.</p></li>
<li><p><em>Soil material classes</em> — Soil horizons or whole profiles can be
dominated by minerals or their combinations e.g. organic material in
the soil, calcaric material, tephric material etc.</p></li>
<li><p><em>Munsell colour classes</em> — Soil in dry and/or wet condition can be
described using some 1–2 thousand Munsell colour classes. Each
Munsell colour class carries a lot of information about the soil
<span class="citation">(Fernandez et al. <a href="#ref-fernandez1988color">1988</a>)</span>, so that a map of Munsell soil colour classes
could be very useful for soil management.</p></li>
<li><p><em>Soil management zones</em> — Each unique combination of soil properties
or types and management zones can be further expanded into a mixed
classification system.</p></li>
<li><p><em>Land degradation classes</em> — Land degradation classes contain
information about soil, but also about land cover and land use.</p></li>
</ul>
<p>As with any map, categorical, factor-type soil variables can be mapped
globally (together with the uncertainty) as long as there is sufficient
training field data to properly support application of the prediction
algorithm. The other technical problem is the amount of storage required to save and
share all the produced predictions. Each category of a soil categorical
variable can be mapped separately, which can lead to hundreds of grids.
The global land cover map for example contains only some 35 categories,
so that it is relatively easy to distribute and use that GIS layer.</p>
</div>
</div>
<div id="importing-and-formatting-soil-data-in-r" class="section level2">
<h2><span class="header-section-number">3.7</span> Importing and formatting soil data in R</h2>
<div id="converting-texture-by-hand-classes-to-fractions" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Converting texture-by-hand classes to fractions</h3>
<p>In the following example we look at how to convert texture-by-hand estimated classes to texture fractions i.e. sand, silt and clay content in %. We focus on the USDA texture-by-hand classes. There classes are embedded in the <a href="http://cran.r-project.org/web/packages/soiltexture/">soiltexture package</a> kindly contributed by Julien Moeys. The USDA texture triangle can be accessed by:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(soiltexture)
<span class="co">#&gt; Warning: no DISPLAY variable so Tk is not available</span>
<span class="kw">TT.plot</span>(<span class="dt">class.sys =</span> <span class="st">&quot;USDA.TT&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:plot-tt-triangle"></span>
<img src="03-Soil_variables_files/figure-html/plot-tt-triangle-1.png" alt="Soil texture triangle based on the USDA system. Generated using the soiltexture package (http://cran.r-project.org/web/packages/soiltexture/)." width="70%" />
<p class="caption">
Figure 3.20: Soil texture triangle based on the USDA system. Generated using the soiltexture package (<a href="http://cran.r-project.org/web/packages/soiltexture/" class="uri">http://cran.r-project.org/web/packages/soiltexture/</a>).
</p>
</div>
<p>We can also print out a table with all class names and vertices numbers that defines each class:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TT.classes.tbl</span>(<span class="dt">class.sys=</span><span class="st">&quot;USDA.TT&quot;</span>, <span class="dt">collapse=</span><span class="st">&quot;, &quot;</span>)
<span class="co">#&gt;       abbr     name              points                          </span>
<span class="co">#&gt;  [1,] &quot;Cl&quot;     &quot;clay&quot;            &quot;24, 1, 5, 6, 2&quot;                </span>
<span class="co">#&gt;  [2,] &quot;SiCl&quot;   &quot;silty clay&quot;      &quot;2, 6, 7&quot;                       </span>
<span class="co">#&gt;  [3,] &quot;SaCl&quot;   &quot;sandy clay&quot;      &quot;1, 3, 4, 5&quot;                    </span>
<span class="co">#&gt;  [4,] &quot;ClLo&quot;   &quot;clay loam&quot;       &quot;5, 4, 10, 11, 12, 6&quot;           </span>
<span class="co">#&gt;  [5,] &quot;SiClLo&quot; &quot;silty clay loam&quot; &quot;6, 12, 13, 7&quot;                  </span>
<span class="co">#&gt;  [6,] &quot;SaClLo&quot; &quot;sandy clay loam&quot; &quot;3, 8, 9, 10, 4&quot;                </span>
<span class="co">#&gt;  [7,] &quot;Lo&quot;     &quot;loam&quot;            &quot;10, 9, 16, 17, 11&quot;             </span>
<span class="co">#&gt;  [8,] &quot;SiLo&quot;   &quot;silty loam&quot;      &quot;11, 17, 22, 23, 18, 19, 13, 12&quot;</span>
<span class="co">#&gt;  [9,] &quot;SaLo&quot;   &quot;sandy loam&quot;      &quot;8, 14, 21, 22, 17, 16, 9&quot;      </span>
<span class="co">#&gt; [10,] &quot;Si&quot;     &quot;silt&quot;            &quot;18, 23, 26, 19&quot;                </span>
<span class="co">#&gt; [11,] &quot;LoSa&quot;   &quot;loamy sand&quot;      &quot;14, 15, 20, 21&quot;                </span>
<span class="co">#&gt; [12,] &quot;Sa&quot;     &quot;sand&quot;            &quot;15, 25, 20&quot;</span></code></pre>
<p>So knowing that the soil texture classes are defined geometrically, a logical estimate of the texture fractions from a class is to take the geometric centre of each polygon in the texture triangle. To estimate where the geometric centre is, we can for example use the functionality in the sp package. We start by creating a ‘’SpatialPolygons’’ object, for which we have to calculate coordinates in the xy space and bind polygons one by one:</p>
<pre class="sourceCode r"><code class="sourceCode r">vert &lt;-<span class="st"> </span><span class="kw">TT.vertices.tbl</span>(<span class="dt">class.sys =</span> <span class="st">&quot;USDA.TT&quot;</span>)
vert<span class="op">$</span>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>vert<span class="op">$</span>SAND<span class="op">+</span>(vert<span class="op">$</span>SAND<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>vert<span class="op">$</span>SILT))<span class="op">*</span><span class="fl">0.5</span>
vert<span class="op">$</span>y &lt;-<span class="st"> </span>vert<span class="op">$</span>CLAY<span class="op">*</span><span class="kw">sin</span>(pi<span class="op">/</span><span class="dv">3</span>)
USDA.TT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">TT.classes.tbl</span>(<span class="dt">class.sys =</span> <span class="st">&quot;USDA.TT&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>))
TT.pnt &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(USDA.TT<span class="op">$</span>name)))
poly.lst &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(USDA.TT<span class="op">$</span>name)))</code></pre>
<p>next we strip the vertices and create a list of polygons:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sp)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(USDA.TT<span class="op">$</span>name)){
  TT.pnt[[i]] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">strsplit</span>(<span class="kw">unclass</span>(<span class="kw">paste</span>(USDA.TT[i, <span class="st">&quot;points&quot;</span>])), <span class="st">&quot;, &quot;</span>)[[<span class="dv">1</span>]])
  poly.lst[[i]] &lt;-<span class="st"> </span>vert[TT.pnt[[i]],<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)]
  ## add extra point:
  pp &lt;-<span class="st"> </span><span class="kw">Polygon</span>(<span class="kw">rbind</span>(poly.lst[[i]], poly.lst[[i]][<span class="dv">1</span>,]))
  poly.lst[[i]] &lt;-<span class="st"> </span>sp<span class="op">::</span><span class="kw">Polygons</span>(<span class="kw">list</span>(pp), <span class="dt">ID=</span>i)
}</code></pre>
<p>and convert texture triangle to a spatial object:</p>
<pre class="sourceCode r"><code class="sourceCode r">poly.sp &lt;-<span class="st"> </span><span class="kw">SpatialPolygons</span>(poly.lst, <span class="dt">proj4string=</span><span class="kw">CRS</span>(<span class="kw">as.character</span>(<span class="ot">NA</span>)))
poly.USDA.TT &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(poly.sp, 
                      <span class="kw">data.frame</span>(<span class="dt">ID=</span>USDA.TT<span class="op">$</span>name), <span class="dt">match.ID=</span><span class="ot">FALSE</span>)</code></pre>
<p>The resulting object now contains also slots of type ‘’labpt’‘which is exactly the geometric gravity point of the first polygon automatically derived by the’‘SpatialPolygons’’ function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">slot</span>(<span class="kw">slot</span>(poly.USDA.TT, <span class="st">&quot;polygons&quot;</span>)[[<span class="dv">1</span>]], <span class="st">&quot;labpt&quot;</span>)
<span class="co">#&gt; [1] 0.490 0.545</span></code></pre>
<p>Next we need to create a function that converts the xy coordinates (columns) in a texture triangle to texture fraction values. Let’s call this function <code>get.TF.from.XY</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">get.TF.from.XY &lt;-<span class="st"> </span><span class="cf">function</span>(df, xcoord, ycoord) {
  df<span class="op">$</span>CLAY &lt;-<span class="st"> </span>df[,ycoord]<span class="op">/</span><span class="kw">sin</span>(pi<span class="op">/</span><span class="dv">3</span>)
  df<span class="op">$</span>SAND &lt;-<span class="st"> </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>df<span class="op">$</span>CLAY <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>df[,xcoord]) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>
  df<span class="op">$</span>SILT &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(df<span class="op">$</span>SAND <span class="op">+</span><span class="st"> </span>df<span class="op">$</span>CLAY)
  <span class="kw">return</span>(df)
}</code></pre>
<p>and now everything is ready to estimate the soil fractions based on a system of classes. For the case of the USDA classifications system we get:</p>
<pre class="sourceCode r"><code class="sourceCode r">USDA.TT.cnt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">sapply</span>(<span class="kw">slot</span>(poly.USDA.TT, <span class="st">&quot;polygons&quot;</span>), slot, <span class="st">&quot;labpt&quot;</span>)))
USDA.TT.cnt<span class="op">$</span>name &lt;-<span class="st"> </span>poly.USDA.TT<span class="op">$</span>ID
USDA.TT.cnt &lt;-<span class="st"> </span><span class="kw">get.TF.from.XY</span>(USDA.TT.cnt, <span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>)
USDA.TT.cnt[,<span class="kw">c</span>(<span class="st">&quot;SAND&quot;</span>,<span class="st">&quot;SILT&quot;</span>,<span class="st">&quot;CLAY&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">signif</span>(USDA.TT.cnt[,<span class="kw">c</span>(<span class="st">&quot;SAND&quot;</span>,<span class="st">&quot;SILT&quot;</span>,<span class="st">&quot;CLAY&quot;</span>)], <span class="dv">2</span>)
USDA.TT.cnt[,<span class="kw">c</span>(<span class="st">&quot;name&quot;</span>,<span class="st">&quot;SAND&quot;</span>,<span class="st">&quot;SILT&quot;</span>,<span class="st">&quot;CLAY&quot;</span>)]
<span class="co">#&gt;               name  SAND  SILT  CLAY</span>
<span class="co">#&gt; 1             clay 0.200 0.180 0.630</span>
<span class="co">#&gt; 2       silty clay 0.067 0.470 0.470</span>
<span class="co">#&gt; 3       sandy clay 0.520 0.067 0.420</span>
<span class="co">#&gt; 4        clay loam 0.320 0.340 0.340</span>
<span class="co">#&gt; 5  silty clay loam 0.100 0.560 0.340</span>
<span class="co">#&gt; 6  sandy clay loam 0.600 0.130 0.270</span>
<span class="co">#&gt; 7             loam 0.410 0.400 0.190</span>
<span class="co">#&gt; 8       silty loam 0.210 0.650 0.130</span>
<span class="co">#&gt; 9       sandy loam 0.650 0.250 0.100</span>
<span class="co">#&gt; 10            silt 0.073 0.870 0.053</span>
<span class="co">#&gt; 11      loamy sand 0.820 0.120 0.058</span>
<span class="co">#&gt; 12            sand 0.920 0.050 0.033</span></code></pre>
<p>Now that we have created a function that converts values in the texture triangle to texture fractions, we can go further and even estimate the uncertainty of estimating each texture fraction based on the class. For this we can use simulations i.e. randomly sample 100 points within some texture class and then derive standard deviations for each texture fraction. Note that, although this sounds like a complicated operation, we can run this in two lines of code. For example to estimate uncertainty of converting the class ‘’Cl’‘(clay) to texture fractions we can simulate 100 random points the class polygon using the’‘spsample’’ function from the sp package <span class="citation">(Bivand, Pebesma, and Rubio <a href="#ref-Bivand2013Springer">2013</a>)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">sim.Cl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">spsample</span>(poly.USDA.TT[poly.USDA.TT<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;clay&quot;</span>,], 
                              <span class="dt">type=</span><span class="st">&quot;random&quot;</span>, <span class="dt">n=</span><span class="dv">100</span>))
sim.Cl &lt;-<span class="st"> </span><span class="kw">get.TF.from.XY</span>(sim.Cl, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)
<span class="kw">sd</span>(sim.Cl<span class="op">$</span>SAND); <span class="kw">sd</span>(sim.Cl<span class="op">$</span>SILT); <span class="kw">sd</span>(sim.Cl<span class="op">$</span>CLAY)
<span class="co">#&gt; [1] 0.123</span>
<span class="co">#&gt; [1] 0.113</span>
<span class="co">#&gt; [1] 0.142</span></code></pre>
<p>which means that we should not expect better precision of estimating the clay content based on class <code>Cl</code> than ±15%.</p>
<p>For some real soil profile data set we could also plot all texture fractions in the texture triangle to see how frequently one should expect some soil classes to appear:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(GSIF)
<span class="kw">data</span>(afsp)
tdf &lt;-<span class="st"> </span>afsp<span class="op">$</span>horizons[,<span class="kw">c</span>(<span class="st">&quot;CLYPPT&quot;</span>, <span class="st">&quot;SLTPPT&quot;</span>, <span class="st">&quot;SNDPPT&quot;</span>)]
tdf &lt;-<span class="st"> </span>tdf[<span class="op">!</span><span class="kw">is.na</span>(tdf<span class="op">$</span>SNDPPT)<span class="op">&amp;!</span><span class="kw">is.na</span>(tdf<span class="op">$</span>SLTPPT)<span class="op">&amp;!</span><span class="kw">is.na</span>(tdf<span class="op">$</span>CLYPPT),]
tdf &lt;-<span class="st"> </span>tdf[<span class="kw">runif</span>(<span class="kw">nrow</span>(tdf))<span class="op">&lt;</span>.<span class="dv">15</span>,]
tdf<span class="op">$</span>Sum &lt;-<span class="st"> </span><span class="kw">rowSums</span>(tdf)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;CLYPPT&quot;</span>, <span class="st">&quot;SLTPPT&quot;</span>, <span class="st">&quot;SNDPPT&quot;</span>)) { tdf[,i] &lt;-<span class="st"> </span>tdf[,i]<span class="op">/</span>tdf<span class="op">$</span>Sum <span class="op">*</span><span class="st"> </span><span class="dv">100</span> }
<span class="kw">names</span>(tdf)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CLAY&quot;</span>, <span class="st">&quot;SILT&quot;</span>, <span class="st">&quot;SAND&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TT.plot</span>(<span class="dt">class.sys =</span> <span class="st">&quot;USDA.TT&quot;</span>, <span class="dt">tri.data =</span> tdf, 
        <span class="dt">grid.show =</span> <span class="ot">FALSE</span>, <span class="dt">pch=</span><span class="st">&quot;+&quot;</span>, <span class="dt">cex=</span>.<span class="dv">4</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:plot-tt-afsis"></span>
<img src="03-Soil_variables_files/figure-html/plot-tt-afsis-1.png" alt="Distribution of observed soil textures for the Africa Soil Profiles (http://gsif.r-forge.r-project.org/afsp.html)." width="70%" />
<p class="caption">
Figure 3.21: Distribution of observed soil textures for the Africa Soil Profiles (<a href="http://gsif.r-forge.r-project.org/afsp.html" class="uri">http://gsif.r-forge.r-project.org/afsp.html</a>).
</p>
</div>
<p>This shows that not all positions in the triangle have the same prior probability. So probably a more sensitive way to estimate uncertainty of converting soil texture classes to fractions would be to run simulations using a density image showing the actual distribution of classes and then, by using the <code>rpoint</code> function in the <a href="http://spatstat.org">spatstat package</a>, we could also derive even more realistic conversions from texture-by-hand classes to texture fractions.</p>
</div>
</div>
<div id="converting-munsell-color-codes-to-other-color-systems" class="section level2">
<h2><span class="header-section-number">3.8</span> Converting Munsell color codes to other color systems</h2>
<p>In the next example we look at the Munsell color codes and conversion algorithms from a code to RGB and other color spaces. Munsell color codes can be matched with RGB values via the <a href="http://www.cis.rit.edu/mcsl/online/munsell.php">Munsell color codes conversion table</a>. You can load a table with 2350 entries from the GSIF dokuwiki:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;extdata/munsell_rgb.rdata&quot;</span>)
<span class="kw">library</span>(colorspace)
munsell.rgb[<span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">*</span><span class="dv">2350</span>, <span class="dv">0</span>),]
<span class="co">#&gt;       Munsell  R  G  B</span>
<span class="co">#&gt; 2254 7.5Y_1_2 37 34 17</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as</span>(colorspace<span class="op">::</span><span class="kw">RGB</span>(<span class="dt">R=</span>munsell.rgb[<span class="dv">1007</span>,<span class="st">&quot;R&quot;</span>]<span class="op">/</span><span class="dv">255</span>, 
                   <span class="dt">G=</span>munsell.rgb[<span class="dv">1007</span>,<span class="st">&quot;G&quot;</span>]<span class="op">/</span><span class="dv">255</span>, 
                   <span class="dt">B=</span>munsell.rgb[<span class="dv">1007</span>,<span class="st">&quot;B&quot;</span>]<span class="op">/</span><span class="dv">255</span>), <span class="st">&quot;HSV&quot;</span>)
<span class="co">#&gt;         H      S     V</span>
<span class="co">#&gt; [1,] 3.53 0.0798 0.835</span></code></pre>
<p>This shows that, for any given Munsell color code, it is relatively easy to convert them to any other color system available in R.</p>
<p>Within the R <a href="http://casoilresource.lawr.ucdavis.edu/drupal/node/201">package aqp</a> one can directly transform Munsell color codes to some color classes in R <span class="citation">(Beaudette, Roudier, and O’Geen <a href="#ref-Beaudette2013CompGeo">2013</a>)</span>. For example, to convert the Munsell color code to RGB values from the example above we would run:</p>
<pre class="sourceCode r"><code class="sourceCode r">aqp<span class="op">::</span><span class="kw">munsell2rgb</span>(<span class="dt">the_hue =</span> <span class="st">&quot;10B&quot;</span>, <span class="dt">the_value =</span> <span class="dv">2</span>, <span class="dt">the_chroma =</span> <span class="dv">12</span>)
<span class="co">#&gt; [1] &quot;#003A7CFF&quot;</span></code></pre>
<p>Now the colors are coded in the <a href="http://en.wikipedia.org/wiki/Web_colors#Hex_triplet">hexadecimal format</a>, which is quite abstract but can be easily browsed via some web color table. To get the actual RGB values we would run:</p>
<pre class="sourceCode r"><code class="sourceCode r">grDevices<span class="op">::</span><span class="kw">col2rgb</span>(<span class="st">&quot;#003A7CFF&quot;</span>)
<span class="co">#&gt;       [,1]</span>
<span class="co">#&gt; red      0</span>
<span class="co">#&gt; green   58</span>
<span class="co">#&gt; blue   124</span></code></pre>
<p>The hex triplet format is also very similar to the color format used in the <a href="https://developers.google.com/kml/documentation/kmlreference">KML reference</a>:</p>
<pre class="sourceCode r"><code class="sourceCode r">plotKML<span class="op">::</span><span class="kw">col2kml</span>(<span class="st">&quot;#003A7CFF&quot;</span>)
<span class="co">#&gt; [1] &quot;#ff7c3a00&quot;</span></code></pre>
<p>To plot the actual colors based on an actual soil profile data base we often need to prepare the color codes before we can run the conversion <span class="citation">(Rossel et al. <a href="#ref-VISCARRAROSSEL2006320">2006</a>)</span>. In the case of the <a href="http://gsif.r-forge.r-project.org/afsp.html">Africa Soil Profile Database</a>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(afsp)
<span class="kw">head</span>(afsp<span class="op">$</span>horizons[<span class="op">!</span><span class="kw">is.na</span>(afsp<span class="op">$</span>horizons<span class="op">$</span>MCOMNS),<span class="st">&quot;MCOMNS&quot;</span>])
<span class="co">#&gt; [1] 10YR3/3 10YR3/3 10YR3/3 10YR3/3 10YR3/3 10YR3/3</span>
<span class="co">#&gt; 289 Levels: 10BG4/1 10R2.5/1 10R2/1 10R2/2 10R3/2 10R3/3 10R3/4 ... N7/0</span></code></pre>
<p>the Munsell color codes have been prepared as text. Hence we need to spend some effort to separate hue from saturation and intensity before we can derive and plot actual colors. We start by merging the tables of interest so both coordinates and Munsell color codes are available in the same table:</p>
<pre class="sourceCode r"><code class="sourceCode r">mcol &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join</span>(afsp<span class="op">$</span>horizons[,<span class="kw">c</span>(<span class="st">&quot;SOURCEID&quot;</span>,<span class="st">&quot;MCOMNS&quot;</span>,<span class="st">&quot;UHDICM&quot;</span>,<span class="st">&quot;LHDICM&quot;</span>)],
                   afsp<span class="op">$</span>sites[,<span class="kw">c</span>(<span class="st">&quot;SOURCEID&quot;</span>,<span class="st">&quot;LONWGS84&quot;</span>,<span class="st">&quot;LATWGS84&quot;</span>)])
<span class="co">#&gt; Joining by: SOURCEID</span>
mcol &lt;-<span class="st"> </span>mcol[<span class="op">!</span><span class="kw">is.na</span>(mcol<span class="op">$</span>MCOMNS),]
<span class="kw">str</span>(mcol)
<span class="co">#&gt; &#39;data.frame&#39;:    31502 obs. of  6 variables:</span>
<span class="co">#&gt;  $ SOURCEID: Factor w/ 26270 levels &quot;100902&quot;,&quot;100903&quot;,..: 974 974 974 974 974 974 975 975 975 975 ...</span>
<span class="co">#&gt;  $ MCOMNS  : Factor w/ 289 levels &quot;10BG4/1&quot;,&quot;10R2.5/1&quot;,..: 40 40 40 40 40 40 23 23 23 23 ...</span>
<span class="co">#&gt;  $ UHDICM  : num  0 8 25 50 81 133 0 8 19 30 ...</span>
<span class="co">#&gt;  $ LHDICM  : num  8 25 50 81 133 160 8 19 30 50 ...</span>
<span class="co">#&gt;  $ LONWGS84: num  17.6 17.6 17.6 17.6 17.6 ...</span>
<span class="co">#&gt;  $ LATWGS84: num  -11 -11 -11 -11 -11 ...</span></code></pre>
<p>Next we need to format all Munsell color codes to ‘’Hue_Saturation_Intensity’’ format. We can incrementally replace the existing codes until all codes can be matched with the RGB table:</p>
<pre class="sourceCode r"><code class="sourceCode r">mcol<span class="op">$</span>Munsell &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">sub</span>(<span class="st">&quot;/&quot;</span>, <span class="st">&quot;_&quot;</span>, mcol<span class="op">$</span>MCOMNS))
hue.lst &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="kw">c</span>(<span class="st">&quot;2.5&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;7.5&quot;</span>, <span class="st">&quot;10&quot;</span>),
                       <span class="kw">c</span>(<span class="st">&quot;YR&quot;</span>,<span class="st">&quot;GY&quot;</span>,<span class="st">&quot;BG&quot;</span>,<span class="st">&quot;YE&quot;</span>,<span class="st">&quot;YN&quot;</span>,<span class="st">&quot;YY&quot;</span>,<span class="st">&quot;R&quot;</span>,<span class="st">&quot;Y&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;G&quot;</span>))
hue.lst<span class="op">$</span>mhue &lt;-<span class="st"> </span><span class="kw">paste</span>(hue.lst<span class="op">$</span>Var1, hue.lst<span class="op">$</span>Var2, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
<span class="cf">for</span>(j <span class="cf">in</span> hue.lst<span class="op">$</span>mhue[<span class="dv">1</span><span class="op">:</span><span class="dv">28</span>]){
  mcol<span class="op">$</span>Munsell &lt;-<span class="st"> </span><span class="kw">sub</span>(j, <span class="kw">paste</span>(j, <span class="st">&quot;_&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), mcol<span class="op">$</span>Munsell, <span class="dt">fixed=</span><span class="ot">TRUE</span>)
}
mcol<span class="op">$</span>depth &lt;-<span class="st"> </span>mcol<span class="op">$</span>UHDICM <span class="op">+</span><span class="st"> </span>(mcol<span class="op">$</span>LHDICM<span class="op">-</span>mcol<span class="op">$</span>UHDICM)<span class="op">/</span><span class="dv">2</span>
mcol.RGB &lt;-<span class="st"> </span><span class="kw">merge</span>(mcol, munsell.rgb, <span class="dt">by=</span><span class="st">&quot;Munsell&quot;</span>)
<span class="kw">str</span>(mcol.RGB)
<span class="co">#&gt; &#39;data.frame&#39;:    11806 obs. of  11 variables:</span>
<span class="co">#&gt;  $ Munsell : chr  &quot;10R_2_2&quot; &quot;10R_2_2&quot; &quot;10R_2_2&quot; &quot;10R_2_2&quot; ...</span>
<span class="co">#&gt;  $ SOURCEID: Factor w/ 26270 levels &quot;100902&quot;,&quot;100903&quot;,..: 18724 18724 20331 18724 20331 20331 18724 9089 4859 23688 ...</span>
<span class="co">#&gt;  $ MCOMNS  : Factor w/ 289 levels &quot;10BG4/1&quot;,&quot;10R2.5/1&quot;,..: 4 4 4 4 4 4 4 5 5 5 ...</span>
<span class="co">#&gt;  $ UHDICM  : num  90 35 30 10 53 0 0 18 0 0 ...</span>
<span class="co">#&gt;  $ LHDICM  : num  135 90 53 35 98 30 10 24 15 5 ...</span>
<span class="co">#&gt;  $ LONWGS84: num  32.23 32.23 4.76 32.23 4.76 ...</span>
<span class="co">#&gt;  $ LATWGS84: num  -26.15 -26.15 8.79 -26.15 8.79 ...</span>
<span class="co">#&gt;  $ depth   : num  112.5 62.5 41.5 22.5 75.5 ...</span>
<span class="co">#&gt;  $ R       : int  67 67 67 67 67 67 67 91 91 91 ...</span>
<span class="co">#&gt;  $ G       : int  48 48 48 48 48 48 48 68 68 68 ...</span>
<span class="co">#&gt;  $ B       : int  45 45 45 45 45 45 45 63 63 63 ...</span></code></pre>
<p>Which allows us to plot the actual observed colors of the top soil (0–30 cm) for the whole of Africa:</p>
<pre class="sourceCode r"><code class="sourceCode r">mcol.RGB &lt;-<span class="st"> </span>mcol.RGB[<span class="op">!</span><span class="kw">is.na</span>(mcol.RGB<span class="op">$</span>R),]
mcol.RGB<span class="op">$</span>Rc &lt;-<span class="st"> </span><span class="kw">round</span>(mcol.RGB<span class="op">$</span>R<span class="op">/</span><span class="dv">255</span>, <span class="dv">3</span>)
mcol.RGB<span class="op">$</span>Gc &lt;-<span class="st"> </span><span class="kw">round</span>(mcol.RGB<span class="op">$</span>G<span class="op">/</span><span class="dv">255</span>, <span class="dv">3</span>)
mcol.RGB<span class="op">$</span>Bc &lt;-<span class="st"> </span><span class="kw">round</span>(mcol.RGB<span class="op">$</span>B<span class="op">/</span><span class="dv">255</span>, <span class="dv">3</span>)
mcol.RGB<span class="op">$</span>col &lt;-<span class="st"> </span><span class="kw">rgb</span>(mcol.RGB<span class="op">$</span>Rc, mcol.RGB<span class="op">$</span>Gc, mcol.RGB<span class="op">$</span>Bc)
mcol.RGB &lt;-<span class="st"> </span>mcol.RGB[mcol.RGB<span class="op">$</span>depth<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>mcol.RGB<span class="op">$</span>depth<span class="op">&lt;</span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(mcol.RGB<span class="op">$</span>col),]
<span class="kw">coordinates</span>(mcol.RGB) &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>LONWGS84<span class="op">+</span>LATWGS84</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;extdata/admin.af.rda&quot;</span>)
<span class="kw">proj4string</span>(admin.af) &lt;-<span class="st"> &quot;+proj=longlat +datum=WGS84&quot;</span>
<span class="co">#&gt; Warning in ReplProj4string(obj, CRS(value)): A new CRS was assigned to an object with an existing CRS:</span>
<span class="co">#&gt; +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0</span>
<span class="co">#&gt; without reprojecting.</span>
<span class="co">#&gt; For reprojection, use function spTransform</span>
country &lt;-<span class="st"> </span><span class="kw">as</span>(admin.af, <span class="st">&quot;SpatialLines&quot;</span>)
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(.<span class="dv">0</span>,.<span class="dv">0</span>,.<span class="dv">0</span>,.<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(.<span class="dv">0</span>,.<span class="dv">0</span>,.<span class="dv">0</span>,.<span class="dv">0</span>))
<span class="kw">plot</span>(country, <span class="dt">col=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="dt">asp=</span><span class="dv">1</span>)
<span class="kw">points</span>(mcol.RGB, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>mcol.RGB<span class="op">$</span>col, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:plot-af-soil-cols"></span>
<img src="03-Soil_variables_files/figure-html/plot-af-soil-cols-1.png" alt="Actual observed soil colors (moist) for the top soil based on the Africa Soil Profiles Database (http://gsif.r-forge.r-project.org/afsp.html)." width="100%" />
<p class="caption">
Figure 3.22: Actual observed soil colors (moist) for the top soil based on the Africa Soil Profiles Database (<a href="http://gsif.r-forge.r-project.org/afsp.html" class="uri">http://gsif.r-forge.r-project.org/afsp.html</a>).
</p>
</div>
<p>Finally, via the plotKML package you can also plot the actual colors of horizons by converting tables to SoilProfileCollection class in the <a href="http://cran.r-project.org/web/packages/aqp/">aqp package</a>. Consider this soil profile from Nigeria:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plyr)
<span class="kw">library</span>(aqp)
<span class="co">#&gt; This is aqp 1.16-3</span>
lon =<span class="st"> </span><span class="fl">3.90</span>; lat =<span class="st"> </span><span class="fl">7.50</span>; id =<span class="st"> &quot;ISRIC:NG0017&quot;</span>; FAO1988 =<span class="st"> &quot;LXp&quot;</span>
top =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">36</span>, <span class="dv">65</span>, <span class="dv">87</span>, <span class="dv">127</span>)
bottom =<span class="st"> </span><span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">36</span>, <span class="dv">65</span>, <span class="dv">87</span>, <span class="dv">127</span>, <span class="dv">181</span>)
ORCDRC =<span class="st"> </span><span class="kw">c</span>(<span class="fl">18.4</span>, <span class="fl">4.4</span>, <span class="fl">3.6</span>, <span class="fl">3.6</span>, <span class="fl">3.2</span>, <span class="fl">1.2</span>)
hue =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;7.5YR&quot;</span>, <span class="st">&quot;7.5YR&quot;</span>, <span class="st">&quot;2.5YR&quot;</span>, <span class="st">&quot;5YR&quot;</span>, <span class="st">&quot;5YR&quot;</span>, <span class="st">&quot;10YR&quot;</span>)
value =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">7</span>); chroma =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>)
## prepare a SoilProfileCollection:
prof1 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join</span>(<span class="kw">data.frame</span>(id, top, bottom, ORCDRC, hue, value, chroma),  
              <span class="kw">data.frame</span>(id, lon, lat, FAO1988), <span class="dt">type=</span><span class="st">&#39;inner&#39;</span>)
<span class="co">#&gt; Joining by: id</span>
prof1<span class="op">$</span>soil_color &lt;-<span class="st"> </span><span class="kw">with</span>(prof1, aqp<span class="op">::</span><span class="kw">munsell2rgb</span>(hue, value, chroma))
<span class="co">#&gt; Notice: converting hue to character</span>
<span class="kw">depths</span>(prof1) &lt;-<span class="st"> </span>id <span class="op">~</span><span class="st"> </span>top <span class="op">+</span><span class="st"> </span>bottom
<span class="co">#&gt; Warning: converting IDs from factor to character</span>
<span class="kw">site</span>(prof1) &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>lon <span class="op">+</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>FAO1988
<span class="kw">coordinates</span>(prof1) &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>lon <span class="op">+</span><span class="st"> </span>lat
<span class="kw">proj4string</span>(prof1) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)
prof1
<span class="co">#&gt; Object of class SoilProfileCollection</span>
<span class="co">#&gt; Number of profiles: 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Horizon attributes:</span>
<span class="co">#&gt;             id top bottom ORCDRC   hue value chroma soil_color</span>
<span class="co">#&gt; 1 ISRIC:NG0017   0     18   18.4 7.5YR     3      2  #584537FF</span>
<span class="co">#&gt; 2 ISRIC:NG0017  18     36    4.4 7.5YR     4      4  #7E5A3BFF</span>
<span class="co">#&gt; 3 ISRIC:NG0017  36     65    3.6 2.5YR     5      6  #A96C4FFF</span>
<span class="co">#&gt; 4 ISRIC:NG0017  65     87    3.6   5YR     5      8  #B06A32FF</span>
<span class="co">#&gt; 5 ISRIC:NG0017  87    127    3.2   5YR     5      4  #9A7359FF</span>
<span class="co">#&gt; 6 ISRIC:NG0017 127    181    1.2  10YR     7      3  #C4AC8CFF</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling site attributes:</span>
<span class="co">#&gt;             id FAO1988</span>
<span class="co">#&gt; 1 ISRIC:NG0017     LXp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Spatial Data:</span>
<span class="co">#&gt;     min max</span>
<span class="co">#&gt; lon 3.9 3.9</span>
<span class="co">#&gt; lat 7.5 7.5</span>
<span class="co">#&gt; [1] &quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;</span></code></pre>
<p>Once an object is in the format of ‘’SoilProfileCollection’’ it can be directly plotted in Google Earth via the generic plotKML command:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotKML</span>(prof1, <span class="dt">var.name=</span><span class="st">&quot;ORCDRC&quot;</span>, <span class="dt">color.name=</span><span class="st">&quot;soil_color&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:soil-profile-plot"></span>
<img src="figures/soil_profile_plot.png" alt="Soil profile from Nigeria plotted in Google Earth with actual observed colors." width="70%" />
<p class="caption">
Figure 3.23: Soil profile from Nigeria plotted in Google Earth with actual observed colors.
</p>
</div>
</div>
<div id="mla-ptfs" class="section level2">
<h2><span class="header-section-number">3.9</span> Using Machine Learning to build Pedo-Transfer-Functions</h2>
<div id="ptf-for-bulk-density" class="section level3">
<h3><span class="header-section-number">3.9.1</span> PTF for Bulk Density</h3>
<p>In the following examples we look at possibilities of using <a href="wiki/soilmapping_using_mla">Machine Learning</a> to predict soil properties and classes from other soil properties and classes. In the first example, we try to build a Pedo-Transfer-Function (PTF) to predict bulk density using soil properties such as organic carbon content, soil texture and coarse fragments. Bulk density is often available only for a part of soil profiles, so if we could use a PTF to fill in all gaps in bulk density, then most likely we would not need to omit BD from further analysis. For testing PTFs to predict bulk density from other soil properties we will use a subset of the ISRIC WISE soil profile data set <span class="citation">(Batjes <a href="#ref-Batjes2009SUM">2009</a>)</span>, which can be loaded from:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(randomForestSRC)
<span class="co">#&gt; </span>
<span class="co">#&gt;  randomForestSRC 2.7.0 </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  Type rfsrc.news() to see new features, changes, and bug fixes. </span>
<span class="co">#&gt; </span>
<span class="kw">library</span>(ggRandomForests)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: &#39;ggRandomForests&#39;</span>
<span class="co">#&gt; The following object is masked from &#39;package:randomForestSRC&#39;:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     partial.rfsrc</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(scales)
<span class="kw">load</span>(<span class="st">&quot;extdata/sprops.wise.rda&quot;</span>)
<span class="kw">str</span>(SPROPS.WISE)
<span class="co">#&gt; &#39;data.frame&#39;:    47833 obs. of  17 variables:</span>
<span class="co">#&gt;  $ SOURCEID: Factor w/ 10253 levels &quot;AF0001&quot;,&quot;AF0002&quot;,..: 1 1 1 2 2 2 2 3 3 3 ...</span>
<span class="co">#&gt;  $ SAMPLEID: chr  &quot;AF0001_1&quot; &quot;AF0001_2&quot; &quot;AF0001_3&quot; &quot;AF0002_1&quot; ...</span>
<span class="co">#&gt;  $ UHDICM  : int  0 15 60 0 20 60 110 0 20 50 ...</span>
<span class="co">#&gt;  $ LHDICM  : int  15 60 150 20 60 110 170 20 50 110 ...</span>
<span class="co">#&gt;  $ DEPTH   : num  7.5 37.5 105 10 40 85 140 10 35 80 ...</span>
<span class="co">#&gt;  $ CRFVOL  : int  20 NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ CECSUM  : num  NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ SNDPPT  : int  40 10 10 40 15 10 40 40 65 60 ...</span>
<span class="co">#&gt;  $ CLYPPT  : int  20 35 35 20 20 35 20 20 10 25 ...</span>
<span class="co">#&gt;  $ BLD     : num  NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ SLTPPT  : int  40 55 55 40 65 55 40 40 25 15 ...</span>
<span class="co">#&gt;  $ PHIHOX  : num  7.9 7.9 7.9 8.5 8.6 8.5 8.8 8.8 9.2 8.9 ...</span>
<span class="co">#&gt;  $ PHIKCL  : num  NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ ORCDRC  : num  7.6 2.3 0.9 12.8 6 3.9 2.7 5.9 2.4 NA ...</span>
<span class="co">#&gt;  $ LONWGS84: num  69.2 69.2 69.2 69.2 69.2 ...</span>
<span class="co">#&gt;  $ LATWGS84: num  34.5 34.5 34.5 34.5 34.5 34.5 34.5 34.5 34.5 34.5 ...</span>
<span class="co">#&gt;  $ SOURCEDB: chr  &quot;WISE&quot; &quot;WISE&quot; &quot;WISE&quot; &quot;WISE&quot; ...</span></code></pre>
<p>For model fitting we will use the <a href="https://cran.r-project.org/package=randomForestSRC">randomForestSRC</a> package, which is a robust implementation of random forest algorithm with options for parallelization and visualization of model outputs:</p>
<pre class="sourceCode r"><code class="sourceCode r">bd.fm =<span class="st"> </span><span class="kw">as.formula</span>(<span class="st">&quot;BLD ~ ORCDRC + PHIHOX + SNDPPT + CLYPPT + CRFVOL + DEPTH&quot;</span>)
rfsrc_BD &lt;-<span class="st"> </span><span class="kw">rfsrc</span>(bd.fm, <span class="dt">data=</span>SPROPS.WISE)
rfsrc_BD
<span class="co">#&gt;                          Sample size: 3330</span>
<span class="co">#&gt;                      Number of trees: 1000</span>
<span class="co">#&gt;            Forest terminal node size: 5</span>
<span class="co">#&gt;        Average no. of terminal nodes: 685</span>
<span class="co">#&gt; No. of variables tried at each split: 2</span>
<span class="co">#&gt;               Total no. of variables: 6</span>
<span class="co">#&gt;        Resampling used to grow trees: swr</span>
<span class="co">#&gt;     Resample size used to grow trees: 3330</span>
<span class="co">#&gt;                             Analysis: RF-R</span>
<span class="co">#&gt;                               Family: regr</span>
<span class="co">#&gt;                       Splitting rule: mse *random*</span>
<span class="co">#&gt;        Number of random split points: 10</span>
<span class="co">#&gt;                 % variance explained: 39.6</span>
<span class="co">#&gt;                           Error rate: 46370</span></code></pre>
<p>which shows that the model explains about 40% with an RMSE of ±200 kg/m<span class="math inline">\(^3\)</span>. Although the MSE is relatively high, it least can be used to fill in the missing values for BD which can be significant. We can plot the partial plots between the target variable and all covariates by using:</p>
<div class="figure" style="text-align: center"><span id="fig:bulk-density-ptf"></span>
<img src="figures/bulk_density_ptf_plots.png" alt="Bulk density as a function of organic carbon, pH, sand and clay content coarse fragments and depth." width="100%" />
<p class="caption">
Figure 3.24: Bulk density as a function of organic carbon, pH, sand and clay content coarse fragments and depth.
</p>
</div>
<p>Obviously the key to explaining bulk density is soil organic carbon, while depth and pH are the 2nd and 3rd most important covariates. Using this MLA-based model we can predict bulk density for various combinations of soil properties:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(rfsrc_BD, <span class="kw">data.frame</span>(<span class="dt">ORCDRC=</span><span class="fl">1.2</span>, <span class="dt">PHIHOX=</span><span class="fl">7.6</span>, 
                  <span class="dt">SNDPPT=</span><span class="dv">45</span>, <span class="dt">CLYPPT=</span><span class="dv">12</span>, <span class="dt">CRFVOL=</span><span class="dv">0</span>, <span class="dt">DEPTH=</span><span class="dv">20</span>))<span class="op">$</span>predicted
<span class="co">#&gt; [1] 1548</span></code></pre>
<p>and a soil with higher organic carbon content:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(rfsrc_BD, <span class="kw">data.frame</span>(<span class="dt">ORCDRC=</span><span class="dv">150</span>, <span class="dt">PHIHOX=</span><span class="fl">4.6</span>, 
                  <span class="dt">SNDPPT=</span><span class="dv">25</span>, <span class="dt">CLYPPT=</span><span class="dv">35</span>, <span class="dt">CRFVOL=</span><span class="dv">0</span>, <span class="dt">DEPTH=</span><span class="dv">20</span>))<span class="op">$</span>predicted
<span class="co">#&gt; [1] 906</span></code></pre>
</div>
<div id="ptf-for-correlating-classification-systems" class="section level3">
<h3><span class="header-section-number">3.9.2</span> PTF for correlating classification systems</h3>
<p>In the second example we use ISRIC WISE to to build a correlation function to translate soil classes from one classification system to the other. The training data can be loaded from:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;extdata/wise_tax.rda&quot;</span>)
<span class="kw">str</span>(WISE_tax)
<span class="co">#&gt; &#39;data.frame&#39;:    8189 obs. of  7 variables:</span>
<span class="co">#&gt;  $ SOURCEID: Factor w/ 8189 levels &quot;AF0001&quot;,&quot;AF0002&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ LATWGS84: num  34.5 34.5 34.5 34.3 32.4 ...</span>
<span class="co">#&gt;  $ LONWGS84: num  69.2 69.2 69.2 61.4 62.1 ...</span>
<span class="co">#&gt;  $ TAXNWRB : Factor w/ 146 levels &quot;#N/A&quot;,&quot;Albic Arenosol&quot;,..: 104 9 9 72 17 16 122 49 8 9 ...</span>
<span class="co">#&gt;  $ TAXOUSDA: Factor w/ 1728 levels &quot;&quot;,&quot; Calciorthid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ LFORM   : chr  &quot;LV&quot; &quot;LV&quot; &quot;LV&quot; &quot;LV&quot; ...</span>
<span class="co">#&gt;  $ LANDUS  : chr  &quot;AA4&quot; &quot;AA6&quot; &quot;AA6&quot; &quot;AA4&quot; ...</span></code></pre>
<p>we also need to get the <em>cleaned</em> legend for USDA classification:</p>
<pre class="sourceCode r"><code class="sourceCode r">leg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;extdata/taxousda_greatgroups.csv&quot;</span>)
<span class="kw">str</span>(leg)
<span class="co">#&gt; &#39;data.frame&#39;:    434 obs. of  4 variables:</span>
<span class="co">#&gt;  $ Great_Group: Factor w/ 434 levels &quot;Acraquox&quot;,&quot;Acrohumox&quot;,..: 9 57 77 112 121 145 170 259 286 301 ...</span>
<span class="co">#&gt;  $ Suborder   : Factor w/ 79 levels &quot;Albolls&quot;,&quot;Andepts&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="co">#&gt;  $ Order      : Factor w/ 12 levels &quot;Alfisols&quot;,&quot;Andisols&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ TAX        : Factor w/ 434 levels &quot;Alfisols_Aqualfs_Albaqualfs&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</span></code></pre>
<p>Our objective is to develop a function to translate WRB classes into USDA classes with help of some soil properties. We can try to add soil pH and clay content to increase the accuracy of the model:</p>
<pre class="sourceCode r"><code class="sourceCode r">x.PHIHOX &lt;-<span class="st"> </span><span class="kw">aggregate</span>(SPROPS.WISE<span class="op">$</span>PHIHOX, 
                      <span class="dt">by=</span><span class="kw">list</span>(SPROPS.WISE<span class="op">$</span>SOURCEID), 
                      <span class="dt">FUN=</span>mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>); <span class="kw">names</span>(x.PHIHOX)[<span class="dv">1</span>] =<span class="st"> &quot;SOURCEID&quot;</span>
x.CLYPPT &lt;-<span class="st"> </span><span class="kw">aggregate</span>(SPROPS.WISE<span class="op">$</span>CLYPPT, 
                      <span class="dt">by=</span><span class="kw">list</span>(SPROPS.WISE<span class="op">$</span>SOURCEID), 
                      <span class="dt">FUN=</span>mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>); <span class="kw">names</span>(x.CLYPPT)[<span class="dv">1</span>] =<span class="st"> &quot;SOURCEID&quot;</span>
WISE_tax<span class="op">$</span>PHIHOX &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join</span>(WISE_tax, x.PHIHOX, <span class="dt">type=</span><span class="st">&quot;left&quot;</span>)<span class="op">$</span>x
<span class="co">#&gt; Joining by: SOURCEID</span>
WISE_tax<span class="op">$</span>CLYPPT &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join</span>(WISE_tax, x.CLYPPT, <span class="dt">type=</span><span class="st">&quot;left&quot;</span>)<span class="op">$</span>x
<span class="co">#&gt; Joining by: SOURCEID</span></code></pre>
<p>After that we need to cleanup the classes so that we can focus on USDA suborders only:</p>
<pre class="sourceCode r"><code class="sourceCode r">sel.tax =<span class="st"> </span><span class="kw">complete.cases</span>(WISE_tax[,<span class="kw">c</span>(<span class="st">&quot;TAXNWRB&quot;</span>,<span class="st">&quot;PHIHOX&quot;</span>,<span class="st">&quot;CLYPPT&quot;</span>,<span class="st">&quot;TAXOUSDA&quot;</span>)])
WISE_tax.sites &lt;-<span class="st"> </span>WISE_tax[sel.tax,]
WISE_tax.sites<span class="op">$</span>TAXOUSDA.f &lt;-<span class="st"> </span><span class="ot">NA</span>
<span class="cf">for</span>(j <span class="cf">in</span> leg<span class="op">$</span>Suborder){
  sel &lt;-<span class="st"> </span><span class="kw">grep</span>(j, WISE_tax.sites<span class="op">$</span>TAXOUSDA, <span class="dt">ignore.case=</span><span class="ot">TRUE</span>)
  WISE_tax.sites<span class="op">$</span>TAXOUSDA.f[sel] =<span class="st"> </span>j
}
WISE_tax.sites<span class="op">$</span>TAXOUSDA.f &lt;-<span class="st"> </span><span class="kw">as.factor</span>(WISE_tax.sites<span class="op">$</span>TAXOUSDA.f)
WISE_tax.sites<span class="op">$</span>TAXNWRB &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">paste</span>(WISE_tax.sites<span class="op">$</span>TAXNWRB))</code></pre>
<p>and finally we can fit a model to translate WRB profiles to USDA suborders:</p>
<pre class="sourceCode r"><code class="sourceCode r">TAXNUSDA.rf &lt;-<span class="st"> </span><span class="kw">rfsrc</span>(TAXOUSDA.f <span class="op">~</span><span class="st"> </span>TAXNWRB <span class="op">+</span><span class="st"> </span>PHIHOX <span class="op">+</span><span class="st"> </span>CLYPPT, <span class="dt">data=</span>WISE_tax.sites)
<span class="co">#TAXNUSDA.rf</span></code></pre>
<p>which shows that the average accuracy is about 45%. We can test converting some classes with the help of additional soil properties:</p>
<pre class="sourceCode r"><code class="sourceCode r">newdata =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">TAXNWRB=</span><span class="kw">factor</span>(<span class="st">&quot;Calcaric Cambisol&quot;</span>, 
                  <span class="dt">levels=</span><span class="kw">levels</span>(WISE_tax.sites<span class="op">$</span>TAXNWRB)), 
                  <span class="dt">PHIHOX=</span><span class="fl">7.8</span>, <span class="dt">CLYPPT=</span><span class="dv">12</span>)
x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">predict</span>(TAXNUSDA.rf, newdata, <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>)<span class="op">$</span>predicted)
x[,<span class="kw">order</span>(<span class="dv">1</span><span class="op">/</span>x)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]]
<span class="co">#&gt;   Ochrepts Orthids</span>
<span class="co">#&gt; 1    0.288   0.154</span></code></pre>
<p>so for example, the two most likely classes to equate to Calcaric Cambisols seem to be Ochrepts and Orthids, which is not that much different from correlation classes reported in <span class="citation">Krasilnikov et al. (<a href="#ref-Krasilnikov2009handbook">2009</a>)</span> in fact.</p>
</div>
</div>
<div id="summary-points" class="section level2">
<h2><span class="header-section-number">3.10</span> Summary points</h2>
<p>In this chapter, we have endeavoured to provide precise and explicit
descriptions of the soil properties and soil classes of interest to current PSM activities.
For each soil property (or class) we have provided an explanation for
why that property (or class) is of interest to users and why it has been
selected to be mapped. In many cases, the most
obvious reason is that the soil property is widely recorded and reported
in legacy soil profile data bases and is therefore available. But these
soil properties are widely reported for good reasons, mainly because
they have been found to be important to consider when managing land or
making decisions about land capability or use. We have defined the
spatial attributes of the soil properties mapped at various scales,
defined a standard reference (analysis) method for each soil property,
provided information on the units, precision and range of values used to
describe each mapped soil property and reviewed problems and
opportunities related to harmonization of soil property values contained
in legacy soil profile databases that have been analysed using different
methods of analysis.</p>
<p>It should be noted that, in this chapter, we have emphasized the use of
existing, or legacy, soil profile data to provide the evidence used to
construct predicton models for PSM. This emphasis reflects the reality
that, for most of the world, legacy soil profile data is all that we
have to work with, at the present time, and all that we can reasonably
expect to obtain for the foreseeable future. Many of the issues and
challenges related to use and harmonization of legacy soil profile data
discussed in this chapter will hopefully be of less importance as newer,
contemporary data are collected in the field and analysed in the laboratory
using more robust, statistically valid and reproduceable methods (e.g. spectroscopy).
In the meantime, standardization and harmonization of legacy soil profile
data will continue to present a challenge for global to regional PSM.</p>
<p>One attractive option for harmonizing soil analytical data following the
SINFER concept would be to create and maintain a Global Soil Reference
Library (GSRL). This concept is further discussed in the final chapter.
Such a library would need to include data for a significant number of
soils from each continent or region. Each soil would be analysed for all
properties of interest using all commonly used methods of analysis.
Values for a soil property for any soil analysed by a given method could
be converted into equivalent values in any other analytical method (as
long as data analysed by both methods were included in the GSRL) by
developing pedo-transfer (or conversion) functions using the fully
analysed samples in the conversion library. In particular, some
variation of the similarity approach described by <span class="citation">Jagtap et al. (<a href="#ref-Jagtap2004TASAE">2004</a>)</span> for
avaialble water capacity and <span class="citation">Nemes et al. (<a href="#ref-Nemes1999G">1999</a>)</span> for harmonization
of particle size data could be implemented to harmonize all types of
soil property values anywhere in the world. The value of the soil
property in the desired reference method could be estimated by finding
the soil or soils in the reference library that were most similar to the
soil for which harmonization was required and then using the value of
the soil (or soils) in the desired reference method as the predicted
harmonized value. If several similar soils were identified, as is done
by <span class="citation">Nemes et al. (<a href="#ref-Nemes1999G">1999</a>)</span>, then the predicted harmonized value would
be computed as the weighted mean, in the appropriate reference method,
of all similar soils; with weights selected according to the similarity
of the soils in the conversion library to the soil being harmonized.</p>
<p>What a GSRL would do, in effect, is to provide a single, centralized
framework for harmonization and conversion of soil property values. It
would do this using a database of reference soils analysed for all soil
properties of interest by all major analytical methods. These fully
analysed reference soils would provide a framework for computing
individualized, locally relevant conversion or pedo-transfer functions
in a consistent and standardized manner. Consequently, global soil
mapping would benefit from having the best of both worlds, namely
locally-specific harmonization functions (which are known to be most
effective) and also ones that were computed everywhere in a single
standardized manner using data in a single comprehensive reference
database (which is desirable in terms of simplifying harmonization and
maintaining a record of how any value was harmonized).</p>
<p>Over time, we expect to see progress made in developing, applying and
documenting harmonization methods so that the values for any given soil
property used to create predictive models for global soil property
mapping are fully harmonized and roughly equivalent for all input data
sets. In the shorter term, it is likely that the accuracy of global
predictions will be reduced because of weak, inconsistent or completely
absent efforts to harmonize soil property values produced using
different analytical methods. In the longer term, we hope, and expect,
that data collected in the future, as we move forward, will benefit from
adoption of methods of data collection and analysis that are more
systematic, more reproduceable, more accurate and more interchangeable.
These improvements should reduce the need for harmonization and
standardization and should make use of soil observation and measurement
data easier and more consistent.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ShepherdWalsh2007JNIS">
<p>Shepherd, K.D., and M.G. Walsh. 2007. “Infrared Spectroscopy — Enabling an Evidence Based Diagnostic Survellance Approach to Agricultural and Environmental Management in Developing Countries.” <em>Journal of Near Infrared Spectroscopy</em> 15:1–19.</p>
</div>
<div id="ref-ViscarraRossel2010DSS">
<p>Viscarra Rossel, Raphael A., Alex B. McBratney, and Budiman Minasny, eds. 2010. <em>Proximal Soil Sensing</em>. Progress in Soil Science. Springer.</p>
</div>
<div id="ref-Burt2004SSIR">
<p>Natural Resources Conservation Service. 2004. <em>Soil Survey Laboratory Methods Manual Version 4.0.</em> Edited by Rebecca Burt. Soil Survey Investigations Report No. 42. United States Department of Agriculture.</p>
</div>
<div id="ref-carter2007soil">
<p>Carter, M.R., and E.G. Gregorich. 2007. <em>Soil Sampling and Methods of Analysis</em>. CRC PRESS.</p>
</div>
<div id="ref-food2006guidelines">
<p>Food, and Agriculture Organization of the United Nations. 2006. <em>Guidelines for Soil Description</em>. Food; Agriculture Organization of the United Nations.</p>
</div>
<div id="ref-VanReeuwijk2002">
<p>Van Reeuwijk, L.P., ed. 2002. <em>Procedures for Soil Analysis</em>. Technical Paper 9. Wageningen, the Netherlands: ISRIC - World Soil Information.</p>
</div>
<div id="ref-Burrough1971">
<p>Burrough, P. A., P.H. T. Beckett, and M.G. Jarvis. 1971. “The Relation Between Cost and Utility in Soil Survey (I–Iii).” <em>Journal of Soil Science</em> 22 (3). Blackwell Publishing Ltd:359–94. <a href="https://doi.org/10.1111/j.1365-2389.1971.tb01624.x" class="uri">https://doi.org/10.1111/j.1365-2389.1971.tb01624.x</a>.</p>
</div>
<div id="ref-GehlRice2005">
<p>Gehl, RonaldJ., and CharlesW. Rice. 2007. “Emerging Technologies for in Situ Measurement of Soil Carbon.” <em>Climatic Change</em> 80 (1-2). Kluwer Academic Publishers:43–54. <a href="https://doi.org/10.1007/s10584-006-9150-2" class="uri">https://doi.org/10.1007/s10584-006-9150-2</a>.</p>
</div>
<div id="ref-Kempen2011PhDthesis">
<p>Kempen, B. 2011. “Updating Soil Information with Digital Soil Mapping.” PhD thesis, Wageningen: Wageningen University. <a href="http://edepot.wur.nl/187198" class="uri">http://edepot.wur.nl/187198</a>.</p>
</div>
<div id="ref-bouma1998exploring">
<p>Bouma, J., N. H. Batjes, and J. J. R. Groot. 1998. “Exploring Land Quality Effects on World Food Supply.” <em>Geoderma</em> 86 (1). Elsevier:43–59.</p>
</div>
<div id="ref-FAO1990">
<p>FAO. 1990. <em>Guidelines for Soil Profile Description</em>. 3rd ed. Rome: Food; Agriculture Organization of the United Nations.</p>
</div>
<div id="ref-SSDS1993">
<p>Soil survey Division staff. 1993. <em>Soil Survey Manual</em>. Vol. Handbook 18. Washington: United States Department of Agriculture.</p>
</div>
<div id="ref-harpstead2001soil">
<p>Harpstead, M.I., T.J. Sauer, and W.F. Bennett. 2001. <em>Soil Science Simplified</em>. Wiley.</p>
</div>
<div id="ref-Burrough1989JSS">
<p>Burrough, P. A. 1989. “Fuzzy Mathematical Methods for Soil Survey and Land Evaluation.” <em>Journal of Soil Science</em> 40 (3):477–92. <a href="https://doi.org/10.1111/j.1365-2389.1989.tb01290.x" class="uri">https://doi.org/10.1111/j.1365-2389.1989.tb01290.x</a>.</p>
</div>
<div id="ref-DeGruijter1997Geoderma">
<p>de Gruijter, J. J., D. J. J. Walvoort, and P. F. M. van Gaans. 1997. “Continuous Soil Maps — a Fuzzy Set Approach to Bridge the Gap Between Aggregation Levels of Process and Distribution Models.” <em>Geoderma</em> 77 (2-4):169–95.</p>
</div>
<div id="ref-VanEngelen2012">
<p>Van Engelen, V.W.P., and J.A. Dijkshoorn, eds. 2012. <em>Global and National Soils and Terrain Digital Databases (SOTER), Procedures Manual, version 2.0</em>. ISRIC Report 2012/04. Wageningen, the Netherlands: ISRIC - World Soil Information.</p>
</div>
<div id="ref-FAO2012HWSD">
<p>FAO/IIASA/ISRIC/ISS-CAS/JRC. 2012. <em>Harmonized World Soil Database (Version 1.2)</em>. Rome: FAO.</p>
</div>
<div id="ref-Arrouays201493">
<p>Arrouays, Dominique, Michael G. Grundy, Alfred E. Hartemink, Jonathan W. Hempel, Gerard B.M. Heuvelink, S. Young Hong, Philippe Lagacherie, et al. 2014. “Chapter Three — GlobalSoilMap: Toward a Fine-Resolution Global Grid of Soil Properties.” In <em>Soil Carbon</em>, edited by Donald L. Sparks, 125:93–134. Advances in Agronomy. Academic Press. <a href="https://doi.org/10.1016/B978-0-12-800137-0.00003-0" class="uri">https://doi.org/10.1016/B978-0-12-800137-0.00003-0</a>.</p>
</div>
<div id="ref-Sleutel2007CSSPA">
<p>Sleutel, S., S. De Neve, B. Singier, and G. Hofman. 2007. “Quantification of Organic Carbon in Soils: A Comparison of Methodologies and Assessment of the Carbon Content of Organic Matter.” <em>Communications in Soil Science and Plant Analysis</em> 38:2647–57.</p>
</div>
<div id="ref-Richter1995">
<p>Richter, Daniel D., and Daniel Markewitz. 1995. “How Deep Is Soil?” <em>BioScience</em> 45 (9). University of California Press on behalf of the American Institute of Biological Sciences:600–609. <a href="http://www.jstor.org/stable/1312764" class="uri">http://www.jstor.org/stable/1312764</a>.</p>
</div>
<div id="ref-OGCKML2008">
<p>Wilson, Tim. 2008. “OGC KML.” OGC Standard OGC 07-147r2. Open Geospatial Consortium Inc.</p>
</div>
<div id="ref-FAO2006">
<p>FAO. 2006. <em>Guidelines for Soil Profile Description</em>. 4th ed. Rome: Food; Agriculture Organization of the United Nations.</p>
</div>
<div id="ref-rijsberman1985effect">
<p>Rijsberman, Frank R, and M Gordon Wolman. 1985. “Effect of Erosion on Soil Productivity: An International Comparison.” <em>Journal of Soil and Water Conservation</em> 40 (4). Soil; Water Conservation Society:349–54.</p>
</div>
<div id="ref-driessen1992land">
<p>Driessen, Paul M, and Nicolaas T Konijn. 1992. <em>Land-Use Systems Analysis</em>. Wageningen Agricultural University.</p>
</div>
<div id="ref-Leenaars2012">
<p>Leenaars, Johan G.B. 2014. <em>Africa Soil Profiles Database, Version 1.2. A Compilation of Geo-Referenced and Standardized Legacy Soil Profile Data for Sub Saharan Africa (with Dataset)</em>. Wageningen, the Netherlands: Africa Soil Information Service (AfSIS) project; ISRIC — World Soil Information.</p>
</div>
<div id="ref-Smith2004SUM">
<p>Smith, P., P. Falloon, and L. Kutsch. 2004. “Soils as Carbon Sinks: The Global Context.” <em>Soil Use and Management</em> 20 (2). Blackwell Publishing Ltd:212–18. <a href="https://doi.org/10.1111/j.1475-2743.2004.tb00361.x" class="uri">https://doi.org/10.1111/j.1475-2743.2004.tb00361.x</a>.</p>
</div>
<div id="ref-Smith2010CUP">
<p>Pete Smith, Pete Falloon, and Werner L. Kutsch. 2010. “The role of soils in the Kyoto Protocol.” In <em>Soil Carbon Dynamics</em>, edited by M. Bahn, 245–56. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511711794.014" class="uri">https://doi.org/10.1017/CBO9780511711794.014</a>.</p>
</div>
<div id="ref-Panagos2013439">
<p>Panagos, Panos, Roland Hiederer, Marc Van Liedekerke, and Francesca Bampa. 2013. “Estimating soil organic carbon in Europe based on data collected through an European network.” <em>Ecological Indicators</em> 24 (0):439–50. <a href="https://doi.org/10.1016/j.ecolind.2012.07.020" class="uri">https://doi.org/10.1016/j.ecolind.2012.07.020</a>.</p>
</div>
<div id="ref-Conant2010">
<p>Conant, Richard T, Stephen M Ogle, Eldor A Paul, and Keith Paustian. 2010. “Measuring and Monitoring Soil Organic Carbon Stocks in Agricultural Lands for Climate Mitigation.” <em>Frontiers in Ecology and the Environment</em> 9 (3). Ecological Society of America:169–73. <a href="http://dx.doi.org/10.1890/090153" class="uri">http://dx.doi.org/10.1890/090153</a>.</p>
</div>
<div id="ref-Scharlemann2014CM">
<p>Scharlemann, Jörn P. W., Edmund V. J. Tanner, Roland Hiederer, and Valerie Kapos. 2014. “Global Soil Carbon: Understanding and Managing the Largest Terrestrial Carbon Pool.” <em>Carbon Management</em> 5 (1). Future Science:81–91. <a href="https://doi.org/10.4155/cmt.13.77" class="uri">https://doi.org/10.4155/cmt.13.77</a>.</p>
</div>
<div id="ref-Grewal1991JSS">
<p>Grewal, K.S., G.D. Buchan, and R.R. Sherlock. 1991. “A comparison of three methods of organic carbon determination in some New Zealand soils.” <em>Journal of Soil Science</em> 42:251–57.</p>
</div>
<div id="ref-Meersmans2009SUM">
<p>Meersmans, J., B. Van Wesemael, and M. Van Molle. 2009. “Determining soil organic carbon for a agricultural soils: A comparison between the Walkley &amp; Black and the dry combustion methods (north Belgium).” <em>Soil Use and Management</em> 25:346–53.</p>
</div>
<div id="ref-Bisutti2004TAC">
<p>Bisutti, I., I. Hilke, and M. Raessler. 2004. “Determination of total organic carbon — an overview of current methods.” <em>Trends in Analytical Chemistry</em> 23 (10-11):716–26.</p>
</div>
<div id="ref-Kalembasa1973JSFA">
<p>Kalembasa, S.J., and D.S. Jenkinson. 1973. “A Comparative Study of Titrimetric and Gravimetric Methods for the Determination of Organic Carbon in Soil.” <em>Journal of the Science of Food and Agriculture</em> 24:1085–90.</p>
</div>
<div id="ref-Soon1991CSSPA">
<p>Soon, Y.K., and S. Abboud. 1991. “A comparison of some methods for soil organic carbon determination.” <em>Communications in Soil Science and Plant Analysis</em> 22:943–54.</p>
</div>
<div id="ref-Wang1996AJSR">
<p>Wang, X.J., P.J. Smethurst, and A.M. Herbed. 1996. “Relationships between three measures of organic matter or carbon in soils of eucalypt plantations in Tasmania.” <em>Australian Journal of Soil Research</em> 34:545–53.</p>
</div>
<div id="ref-Konen2002SSSAJ">
<p>Konen, M.E., P.M. Jacobs, C.L. Burras, B.J. Talaga, and J.A. Mason. 2002. “Equations for Predicting Soil Organic Carbon Using Loss-on-Ignitionfor North Central U.S. Soils.” <em>Soil Science Society of America Journal</em> 66:1878–81.</p>
</div>
<div id="ref-Brye2003CSSPA">
<p>Brye, K.R., and N.A. Slaton. 2003. “Carbon and Nitrogen Storage in a Typic Albaqualf as Affected by Assessment Method.” <em>Communications in Soil Science and Plant Analysis</em> 34:1637–55.</p>
</div>
<div id="ref-Mikhailova2003CSSPA">
<p>Mikhailova, E.A., R.R.P. Noble, and C.J. Post. 2003. “Comparison of Soil Organic Carbon Recovery by Walkley-Black andDry Combustion Methods in the Russian Chernozem.” <em>Communications in Soil Science and Plant Analysis</em> 34:1853–60.</p>
</div>
<div id="ref-Jankauskas2006CSSPA">
<p>Jankauskas, B., G. Jankauskiene, A. Slepetiene, M.A. Fullen, and C.A. Booth. 2006. “International Comparison of Analytical Methods of Determining the Soil Organic Matter Content of Lithuanian Eutric Albeluvisols.” <em>Communications in Soil Science and Plant Analysis</em> 37:707–20.</p>
</div>
<div id="ref-DeVos2007SUM">
<p>De Vos, B., S. Lettens, B. Muys, and J.A. Deckers. 2007. “Walkley-Black analysis of forest soil organic carbon: Recovery,limitations and uncertainty.” <em>Soil Use and Management</em> 23:221–29.</p>
</div>
<div id="ref-Miller2010SSSAJ">
<p>Miller, R.O., and D.E. Kissel. 2010. “Comparison of Soil pH Methods on Soils of North America.” <em>Soil Science Society of America Journal</em> 74:310–16.</p>
</div>
<div id="ref-Davis1943SS">
<p>Davis, L.E. 1943. “Measurements of pH with the Glass Electrode as Affected by Soil Moisture.” <em>Soil Science</em> 56 (6):405–22.</p>
</div>
<div id="ref-Aitken1991AJSR">
<p>Aitken, R.L., and P.W. Moody. 1991. “Interrelations between Soil pH Measurements in Various Electrolytes and Soil Solution pH in Acidic Soils.” <em>Australian Journal of Soil Research</em> 29:483–91.</p>
</div>
<div id="ref-Brennan1998">
<p>Brennan, R.F., and M.D.A. Bolland. 1998. “Relationship Between Ph Measured in Water and Calcium Chloride for Soils of Southwestern Australia.” <em>Communications in Soil Science and Plant Analysis</em> 29 (17-18). Taylor &amp; Francis:2683–9. <a href="https://doi.org/10.1080/00103629809370143" class="uri">https://doi.org/10.1080/00103629809370143</a>.</p>
</div>
<div id="ref-hengl2017soil">
<p>Hengl, T., J.G.B. Leenaars, K.D. Shepherd, M.G. Walsh, G.B.M. Heuvelink, T. Mamo, H. Tilahun, E. Berkhout, M. Cooper, and E. Fegraus. 2017. “Soil nutrient maps of Sub-Saharan Africa: assessment of soil nutrient content at 250 m spatial resolution using machine learning.” <em>Nutrient Cycling in Agroecosystems</em> 109 (1). Springer:77–102.</p>
</div>
<div id="ref-Markus2001399">
<p>Markus, Julie, and Alex B. McBratney. 2001. “A Review of the Contamination of Soil with Lead: II. Spatial Distribution and Risk Assessment of Soil Lead.” <em>Environment International</em> 27 (5):399–411. <a href="https://doi.org/10.1016/S0160-4120(01)00049-6" class="uri">https://doi.org/10.1016/S0160-4120(01)00049-6</a>.</p>
</div>
<div id="ref-reimann2011statistical">
<p>Reimann, C., P. Filzmoser, R. Garrett, and R. Dutter. 2011. <em>Statistical Data Analysis Explained: Applied Environmental Statistics with R</em>. Wiley.</p>
</div>
<div id="ref-Morel2005202">
<p>Morel, J. L., C. Schwartz, L. Florentin, and C. de Kimpe. 2005. “Urban Soils.” In <em>Encyclopedia of Soils in the Environment</em>, edited by Daniel Hillel, 202–8. Oxford: Elsevier. <a href="https://doi.org/10.1016/B0-12-348530-4/00305-2" class="uri">https://doi.org/10.1016/B0-12-348530-4/00305-2</a>.</p>
</div>
<div id="ref-Rodriguez-Lado23082013">
<p>Rodríguez-Lado, Luis, Guifan Sun, Michael Berg, Qiang Zhang, Hanbin Xue, Quanmei Zheng, and C. Annette Johnson. 2013. “Groundwater Arsenic Contamination Throughout China.” <em>Science</em> 341 (6148):866–68. <a href="https://doi.org/10.1126/science.1237484" class="uri">https://doi.org/10.1126/science.1237484</a>.</p>
</div>
<div id="ref-Shirazi2001SSSAJ">
<p>Shirazi, M.A., L. Boersma, and C.B. Johnson. 2001. “Particle size distributions: comparing texture systems, adding rock, and predicting soil properties.” <em>Soil Science Society of America Journal</em> 65:300–310.</p>
</div>
<div id="ref-Minasny2001AJSR">
<p>Minasny, B., and A. B. McBratney. 2001. “The Australian soil texture boomerang: A comparison of the Australian and USDA/FAO soil particle-size classification systems.” <em>Australian Journal of Soil Research</em> 39:1443–51.</p>
</div>
<div id="ref-Nachtergaele2010press">
<p>Nachtergaele, F. O., V.W.P. Van Engelen, and N. H. Batjes. 2010. “Qualitative and quantitative aspects of world and regional soildatabases and maps.” In <em>Handbook of Soil Science</em>, edited by Yuncong Li and M. Sumner, 2nd ed., in press. CRC Press, Taylor; Francis Group.</p>
</div>
<div id="ref-Nemes1999G">
<p>Nemes, A., J.H.M. Wösten, A. Lilly, and J.H. Oude Voshaar. 1999. “Evaluation of different procedures to interpolate particle-size distributions to achieve compatibility within soil databases.” <em>Geoderma</em> 90:187–202.</p>
</div>
<div id="ref-Nemes1999">
<p>Nemes, A., M.G. Schaap, and F.J. Leij. 1999. <em>The UNSODA unsaturated soil hydraulic database Version 2.0.</em> Riverside, CA: US Salinity Laboratory.</p>
</div>
<div id="ref-Curtis1964SSSAP">
<p>Curtis, R.O., and B.W. Post. 1964. “Estimating bulk density from organic matter content in some Vermont forest soils.” <em>Soil Science Society of America Proceedings</em> 28:285–86.</p>
</div>
<div id="ref-Adams1973JSS">
<p>Adams, W. A. 1973. “The effect of organic matter on the bulk and true density of some uncultivated podzolic soils.” <em>Journal of Soil Science</em> 24:10–17.</p>
</div>
<div id="ref-Alexander1980SSSAJ">
<p>Alexander, E.B. 1980. “Bulk density of Californian soils in relation to other soil properties.” <em>Soil Science Society of America Journal</em> 44:689–92.</p>
</div>
<div id="ref-Federer1993CJFR">
<p>Federer, C.A., D.E. Turcotte, and C.T. Smith. 1993. “The organic- bulk-density relationship and the expression of nutrient content in forest soils.” <em>Canadian Journal of Forest Research</em> 23:1026–32.</p>
</div>
<div id="ref-Rawls1983SS">
<p>Rawls, W.J. 1983. “Estimating soil bulk-density from particle-size analysis and organic matter content.” <em>Soil Science</em> 135:123–25.</p>
</div>
<div id="ref-Manrique1991SSSAJ">
<p>Manrique, L.A., and C.A. Jones. 1991. “Bulk-density of soils in relation to soil physical and chemical properties.” <em>Soil Science Society of America Journal</em> 55:476–81.</p>
</div>
<div id="ref-Bernoux1998SSSAJ">
<p>Bernoux, M., D. Arrouays, C. Cerri, B. Valkoff, and C. Jolivet. 1998. “Bulk densities of Brazilian Amazon soils related to other soil properties.” <em>Soil Science Society of America Journal</em> 62:743–49.</p>
</div>
<div id="ref-Heuscher2005SSSAJ">
<p>Heuscher, S.A., C.C. Brandt, and P.M. Jardine. 2005. “Using Soil Physical and Chemical Properties to Estimate Bulk Density.” <em>Soil Science Society of America Journal</em> 69:1–7.</p>
</div>
<div id="ref-Tranter2007SUM">
<p>Tranter, G., B. Minasny, A. B. McBratney, B. Murphy, N.J. McKenzie, M. Grundy, and D. Brough. 2007. “Building and testing conceptual and empirical models for predicting soil bulk density.” <em>Soil Use and Management</em>, 1–6.</p>
</div>
<div id="ref-Torri1994C">
<p>Torri, D., J. Poesen, F. Monaci, and E. Busoni. 1994. “Rock fragment content and fine soil bulk density.” <em>Catena</em> 23:65–71.</p>
</div>
<div id="ref-Saini1966N">
<p>Saini, G.R. 1966. “Organic matter as a measure of bulk density of soil.” <em>Nature</em> 210:1295.</p>
</div>
<div id="ref-Jeffrey1970JE">
<p>Jeffrey, D. W. 1970. “A note on the use of ignition loss as a means for the approximate estimation of soil bulk density.” <em>Journal of Ecology</em> 58:297–99.</p>
</div>
<div id="ref-Nelson1982">
<p>Nelson, D. W., and L.E. Sommers. 1982. “Total Carbon, Organic Carbon, and Organic Matter.” In <em>Methods of Soil Analysis, Part 2</em>, edited by A.L. Page, R.H. Miller, and D.R. Keeney, 2nd ed., 539–79. Agron. Monogr. 9. Madison, WI: ASA; SSSA.</p>
</div>
<div id="ref-sanderman2018soil">
<p>Sanderman, Jonathan, Tomislav Hengl, and Gregory J Fiske. 2018. “Soil Carbon Debt of 12,000 Years of Human Land Use.” <em>PROCEEDINGS OF THE NATIONAL ACADEMY OF SCIENCES OF THE UNITED STATES OF AMERICA</em> 115 (7). NATL ACAD SCIENCES 2101 CONSTITUTION AVE NW, WASHINGTON, DC 20418 USA:E1700–E1700.</p>
</div>
<div id="ref-Heuvelink1998a">
<p>Heuvelink, G.B.M. 1998. <em>Error Propagation in Environmental Modelling with Gis</em>. London, UK: Taylor &amp; Francis.</p>
</div>
<div id="ref-food1977framework">
<p>Food, Development Agriculture Organization of the United Nations. Soil Resources, and Conservation Service. 1977. <em>A Framework for Land Evaluation</em>. Publication (International Institute for Land Reclamation and Improvement). International Institute for Land Reclamation; Improvement.</p>
</div>
<div id="ref-Minasny2007JITL">
<p>Minasny, B. 2007. “Predicting soil properties.” <em>Jurnal Ilmu Tanah Dan Lingkungan</em> 7 (1):54–67.</p>
</div>
<div id="ref-Rawls1991AA">
<p>Rawls, W.J., T.J. Gish, and D.L. Brakensiek. 1991. “Estimating soil water retention from soil physical properties and characteristics.” <em>Advances in Agronomy</em> 16:213–34.</p>
</div>
<div id="ref-Wosten1995G">
<p>Wösten, J.H.M., P. A. Fi, and M.J.W. Jansen. 1995. “Comparison of class and continuous pedotransfer functions to generate soil hydraulic characteristics.” <em>Geoderma</em> 66:227–37.</p>
</div>
<div id="ref-Gijsman2007CEA">
<p>Gijsman, A.J., P.K. Thornton, and G. Hoogenboom. 2007. “Using the WISE database to parameterize soil inputs for crop simulation models.” <em>Computers and Electronics in Agriculture</em> 56:85–100.</p>
</div>
<div id="ref-Timlin1996AS">
<p>Timlin, D.J., Y.A. Pachepsky, B. Acock, and F. Whisler. 1996. “Indirect estimation of soil hydraulic properties to predict soybeanyield using GLYCIM.” <em>Agricultural Systems</em> 52:331–53.</p>
</div>
<div id="ref-Wosten2001JH">
<p>Wösten, J.H.M., Y.A. Pachepsky, and W.J. Rawls. 2001. “Pedotransfer functions: Bridging the gap between available basic soil data and missing soil hydraulic functions.” <em>Journal of Hydrology</em> 251:123–50.</p>
</div>
<div id="ref-Saxton1986SSSAJ">
<p>Saxton, K.E., W.J. Rawls, J.S. Romberger, and R.I. Papendick. 1986. “Estimating generalized soil-water characteristics from texture.” <em>Soil Science Society of America Journal</em> 50:1031–6.</p>
</div>
<div id="ref-Rawls1982JIDDASCE">
<p>Rawls, W.J., and D.L. Brakensiek. 1982. “Estimating soil water retention from soil properties.” <em>J. Irrig. Drainage Div. Am. Soc. Civ. Eng.</em> 108:166–71.</p>
</div>
<div id="ref-hodnett2002marked">
<p>Hodnett, M.G., and J. Tomasella. 2002. “Marked differences between van Genuchten soil water-retention parameters for temperate and tropical soils: a new water-retention pedo-transfer functions developed for tropical soils.” <em>Geoderma</em> 108 (3). Elsevier:155–80.</p>
</div>
<div id="ref-wosten2013soil">
<p>Wösten, J.H.M., S.J.E. Verzandvoort, J.G.B. Leenaars, T. Hoogland, and J.G. Wesseling. 2013. “Soil Hydraulic Information for River Basin Studies in Semi-Arid Regions.” <em>Geoderma</em> 195. Elsevier:79–86. <a href="https://doi.org/10.1016/j.geoderma.2012.11.021" class="uri">https://doi.org/10.1016/j.geoderma.2012.11.021</a>.</p>
</div>
<div id="ref-Jagtap2004TASAE">
<p>Jagtap, S.S., U. Lal, J.W. Jones, A.J. Gijsman, and J.T. Ritchie. 2004. “A dynamic nearest-neighbor method for estimating soil water parameters.” <em>Trans. ASAE</em> 47:1437–44.</p>
</div>
<div id="ref-Zacharias2007SSSAJ">
<p>Zacharias, S., and G. Wessolek. 2007. “Excluding Organic Matter Content from Pedotransfer Predictors of Soil Water Retention.” <em>Soil Science Society of America Journal</em> 71:43–50.</p>
</div>
<div id="ref-Arya1981SSSAJ">
<p>Arya, L.M., and J.F. Paris. 1981. “A physico-empirical approach to predict the soil water moisture characteristic from particle size distribution and bulk density data.” <em>Soil Science Society of America Journal</em> 45:1023–30.</p>
</div>
<div id="ref-van1980closed">
<p>Van Genuchten, M. Th. 1980. “A Closed-Form Equation for Predicting the Hydraulic Conductivity of Unsaturated Soils.” <em>Soil Science Society of America Journal</em> 44 (5). Soil Science Society of America:892–98.</p>
</div>
<div id="ref-Wosten1999G">
<p>Wösten, J.H.M., A. Lilly, A. Nemes, and C. Le Bas. 1999. “Development and use of a database of hydraulic properties of European soils.” <em>Geoderma</em> 90:169–85.</p>
</div>
<div id="ref-Hall1977">
<p>Hall, D.G., M.J. Reeve, A.J. Thomasson, and V.F. Wright. 1977. <em>Water Retention, Porosity and Density of Field Soils</em>. Soil Survey of England and Wales. Harpenden: Transport; Road Research Laboratory.</p>
</div>
<div id="ref-Oosterveld1980CAE">
<p>Oosterveld, M., and C. Chang. 1980. “Empirical relationship between laboratory determinations of soil texture and moisture retention.” <em>Can. Agric. Eng.</em> 22:149–51.</p>
</div>
<div id="ref-Campbell1989">
<p>Campbell, G.S., and S. Shiozawa. 1989. “Prediction of hydraulic properties of soils using particle-size distribution and bulk density data.” In <em>Proc. Int. Worksh. On Indirect Methods for Estimating the Hydraulic Properties of Unsaturated Soils</em>, edited by van Genuchten, M.Th. et al., 317–28. Riverside, CA: Univ. of California, Riverside.</p>
</div>
<div id="ref-Williams1992">
<p>Williams, J., P.J. Ross, and K.L. Bristow. 1992. “Prediction of the Campbell water retention function from texture, structure and organic matter.” In <em>Proceedings of the International Workshop on Indirect Methods for Estimating the Hydraulic Properties of Unsaturated Soils</em>, edited by M.Th. van Genuchten, F.J. Leij, and L.J. Lund, 427–41. Riverside, CA: University of California, Riverside.</p>
</div>
<div id="ref-Rawls1989">
<p>Rawls, W.J., and D.L. Brakensiek. 1982. “Estimating soil water retention from soil properties.” <em>J. Irrig. Drainage Div. Am. Soc. Civ. Eng.</em> 108:166–71.</p> 1989. “Estimation of soil water retention and hydraulic properties.” In <em>Unsaturated flow in hydrologic modeling; theory and practice</em>, edited by H.J. Morel-Seytoux, 275–300. Proc. NATO Adv. Res. Worksh. Hydrology. Dordrecht, the Netherlands: Kluwer Acad. Publ.</p>
</div>
<div id="ref-Canarache1993ST">
<p>Canarache, A. 1993. “Physical-technological soil maps — A possible product of soil survey for direct use in agriculture.” <em>Soil Technology</em> 6:3–15.</p>
</div>
<div id="ref-Nemes2003SSSAJ">
<p>Nemes, A., M.G. Schaap, and J.H.M. Wösten. 2003. “Functional evaluation of pedotransfer functions derived from different scales of data collection.” <em>Soil Science Society of America Journal</em> 67:1093–1102.</p>
</div>
<div id="ref-Vereecken1989SS">
<p>Vereecken, H.J., J. Maes, and P.D. Feyen. 1989. “Estimating the Soil Moisture Retention Characteristic from Texture,Bulk Density, and Carbon Content.” <em>Soil Science</em> 148 (6):389–403.</p>
</div>
<div id="ref-peverill1999soil">
<p>Peverill, K.I., L.A. Sparrow, and D.J. Reuter. 1999. <em>Soil analysis: an interpretation manual</em>. CSIRO Publishing.</p>
</div>
<div id="ref-Cresswell2006SUM">
<p>Cresswell, H.P., Y. Coquet, A. Bruand, and N.J. McKenzie. 2006. “The transferability of Australian pedotransfer functions for predicting water retention characteristics of French soils.” <em>Soil Use and Management</em> 22:62–70.</p>
</div>
<div id="ref-Bouma1989S">
<p>Bouma, J. 1989. “Land qualities in space and time.” In <em>Proceedings of a symposium organized by the International Society of Soil Science</em>, edited by J. Bouma and A.K. Bregt, 3–13. Wageningen: Wageningen University.</p>
</div>
<div id="ref-Wosten1985SSSAJ">
<p>Wösten, J.H.M., J. Bouma, and G.H. Stoffelsen. 1985. “Use of soil survey data for regional soil water simulation models.” <em>Soil Science Society of America Journal</em> 49:1238–44.</p>
</div>
<div id="ref-Wosten1992">
<p>Wösten, J.H.M., and J. Bouma. 1992. “Applicability of soil survey data to estimate hydraulic properties of unsaturated soils.” In <em>Proceedings of an International Workshop on Indirect Methods for Estimating the Hydraulic Properties of Unsaturated Soils</em>, edited by M.Th. van Genuchten, F.J. Leij, and L.J. Lund, 463–72. University of California, Riverside.</p>
</div>
<div id="ref-Jolivet1998CSSPA">
<p>Jolivet, C., D. Arrouays, and M. Bernoux. 1998. “Comparison between analytical methods for organic carbon and organic matter determination in sandy Spodosols of France.” <em>Communications in Soil Science and Plant Analysis</em> 29:2227–33.</p>
</div>
<div id="ref-McBratney2002Geoderma">
<p>McBratney, A. B., B. Minasny, S.R. Cattle, and R.W. Vervoort. 2002. “From Pedotransfer Functions to Soil Inference Systems.” <em>Geoderma</em> 109:41–73.</p>
</div>
<div id="ref-eswaran2010soil">
<p>Eswaran, H., R. Ahrens, T.J. Rice, and B.A. Stewart. 2010. <em>Soil Classification: A Global Desk Reference</em>. Taylor &amp; Francis.</p>
</div>
<div id="ref-buol2011soil">
<p>Buol, S.W., R.J. Southard, R.C. Graham, and P. A. McDaniel. 2011. <em>Soil Genesis and Classification</em>. Wiley.</p>
</div>
<div id="ref-agriculture2010keys">
<p>U.S. Department of Agriculture. 2014. <em>Keys to Soil Taxonomy</em>. 12th ed. U.S. Government Printing Office.</p>
</div>
<div id="ref-FAO2006WRB">
<p>IUSS Working Group WRB. 2006. <em>World reference base for soil resources 2006: a framework for international classification, correlation and communication</em>. World Soil Resources Reports No. 103. Rome: Food; Agriculture Organization of the United Nations.</p>
</div>
<div id="ref-Venables2002Springer">
<p>Venables, W. N., and B. D. Ripley. 2002. <em>Modern applied statistics with S</em>. 4th ed. New York: Springer-Verlag.</p>
</div>
<div id="ref-harrell2001regression">
<p>Harrell, F.E. 2001. <em>Regression Modeling Strategies: With Applications to Linear Models, Logistic Regression, and Survival Analysis</em>. Graduate Texts in Mathematics. Springer.</p>
</div>
<div id="ref-fernandez1988color">
<p>Fernandez, R.N., D.G. Schulze, D.L. Coffin, and G.E. Van Scoyoc. 1988. “Color, Organic Matter, and Pesticide Adsorption Relationships in a Soil Landscape.” <em>Soil Science Society of America Journal</em> 52 (4). Soil Science Society of America:1023–6.</p>
</div>
<div id="ref-Bivand2013Springer">
<p>Bivand, R., E. Pebesma, and V. Rubio. 2008. <em>Applied Spatial Data Analysis with R</em>. Use R Series. Heidelberg: Springer.</p> 2013. <em>Applied Spatial Data Analysis with R</em>. 2nd ed. Use R Series. Heidelberg: Springer.</p>
</div>
<div id="ref-Beaudette2013CompGeo">
<p>Beaudette, D.E., P. Roudier, and A.T. O’Geen. 2013. “Algorithms for Quantitative Pedology: A Toolkit for Soil Scientists.” <em>Computers &amp; Geosciences</em> 52 (0):258–68. <a href="https://doi.org/10.1016/j.cageo.2012.10.020" class="uri">https://doi.org/10.1016/j.cageo.2012.10.020</a>.</p>
</div>
<div id="ref-VISCARRAROSSEL2006320">
<p>Rossel, R.A. Viscarra, B. Minasny, P. Roudier, and A.B. McBratney. 2006. “Colour Space Models for Soil Science.” <em>Geoderma</em> 133 (3):320–37. <a href="https://doi.org/https://doi.org/10.1016/j.geoderma.2005.07.017" class="uri">https://doi.org/https://doi.org/10.1016/j.geoderma.2005.07.017</a>.</p>
</div>
<div id="ref-Batjes2009SUM">
<p>Batjes, N. H. 2009. “Harmonized soil profile data for applications at global and continental scales: Updates to the WISE database.” <em>Soil Use and Management</em> 25 (2):124–27. <a href="https://doi.org/10.1111/j.1475-2743.2009.00202.x" class="uri">https://doi.org/10.1111/j.1475-2743.2009.00202.x</a>.</p>
</div>
<div id="ref-Krasilnikov2009handbook">
<p>Krasilnikov, P., J.J.I. Marti, R. Arnold, and S. Shoba, eds. 2009. <em>A Handbook of Soil Terminology, Correlation and Classification</em>. Earthscan LLC.</p>
</div>
</div>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-envirometrix-github-io-predictivesoilmapping.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="software.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="soil-covs-chapter.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/envirometrix/PredictiveSoilMapping/edit/master/03-Soil_variables.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["PSMwR_UStrade.pdf", "PSMwR_UStrade.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
